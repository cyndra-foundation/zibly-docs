
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="index.html">
      
      
        <link rel="prev" href="../_arize/index.html">
      
      
        <link rel="next" href="../haystack/index.html">
      
      
        
      
      
      <link rel="icon" href="../../../static/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12+insiders-4.53.16">
    
    
      
        <title>Amazon Bedrock - Zibly</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.ff49f96f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../extra/style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-XWJT601CLX"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-XWJT601CLX",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-XWJT601CLX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script><script async type="text/javascript" src="../../../../../static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="zibly" /><meta name="readthedocs-version-slug" content="stable" /><meta name="readthedocs-resolver-filename" content="/howtos/integrations/amazon_bedrock/" /><meta name="readthedocs-http-status" content="200" /></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="index.html#create-and-evaluate-an-amazon-bedrock-agent-integrated-with-an-amazon-bedrock-knowledge-base-and-action-groups" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
<!-- Add announcement here, including arbitrary HTML -->
<div class="announce">
    <p>
        <strong>Zibly Office Hours</strong> - If you need help setting up Evals for your AI application, sign up for our
        Office Hours <a href="https://cal.com/team/zibly/office-hours">here</a>.
    </p>
</div>

          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../index.html" title="Zibly" class="md-header__button md-logo" aria-label="Zibly" data-md-component="logo">
      
  <img src="../../../static/imgs/zibly-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Zibly
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Amazon Bedrock
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="zibly_light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="zibly_dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/explodinggradients/zibly" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    explodinggradients/zibly
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../index.html" class="md-tabs__link">
        
  
  
    
  
  

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../getstarted/index.html" class="md-tabs__link">
          
  
  
    
  
  🚀 Get Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../concepts/index.html" class="md-tabs__link">
          
  
  
    
  
  📚 Core Concepts

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../index.html" class="md-tabs__link">
          
  
  
    
  
  🛠️ How-to Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../references/index.html" class="md-tabs__link">
          
  
  
    
  
  📖 References

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../community/index.html" class="md-tabs__link">
        
  
  
    
  
  ❤️ Community

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../index.html" title="Zibly" class="md-nav__button md-logo" aria-label="Zibly" data-md-component="logo">
      
  <img src="../../../static/imgs/zibly-logo.png" alt="logo">

    </a>
    Zibly
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/explodinggradients/zibly" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    explodinggradients/zibly
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../getstarted/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    🚀 Get Started
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    🚀 Get Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getstarted/install/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getstarted/evals/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate your first LLM App
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getstarted/rag_eval/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate a simple RAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getstarted/rag_testset_generation/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generate Synthetic Testset for RAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../concepts/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    📚 Core Concepts
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    📚 Core Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../concepts/components/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Components
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Components
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    General
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    General
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/components/prompt/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Prompt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Evaluation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Evaluation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/components/eval_sample/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluation Sample
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/components/eval_dataset/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluation Dataset
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../concepts/metrics/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Metrics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/overview/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../concepts/metrics/available_metrics/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Available Metrics
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_3" id="__nav_3_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Available Metrics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_2" id="__nav_3_3_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Retrieval Augmented Generation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Retrieval Augmented Generation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/context_precision/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context Precision
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/context_recall/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context Recall
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/context_entities_recall/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context Entities Recall
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/noise_sensitivity/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Noise Sensitivity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/answer_relevance/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Response Relevancy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/faithfulness/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Faithfulness
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_3" id="__nav_3_3_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Nvidia Metrics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Nvidia Metrics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/nvidia_metrics/index.html#answer-accuracy" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Answer Accuracy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/nvidia_metrics/index.html#context-relevance" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context Relevance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/nvidia_metrics/index.html#response-groundedness" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Response Groundedness
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_4" id="__nav_3_3_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Agents or Tool Use Cases
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Agents or Tool Use Cases
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/agents/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agentic or Tool use
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/agents/index.html#topic-adherence" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Topic Adherence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/agents/index.html#tool-call-accuracy" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tool Call Accuracy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/agents/index.html#agent-goal-accuracy" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agent Goal Accuracy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_5" id="__nav_3_3_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Natural Language Comparison
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Natural Language Comparison
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/factual_correctness/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Factual Correctness
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/semantic_similarity/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Semantic Similarity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_5_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_5_3" id="__nav_3_3_3_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Traditional non LLM metrics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_3_3_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Traditional non LLM metrics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/traditional/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Traditional NLP Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/traditional/index.html#non-llm-string-similarity" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Non LLM String Similarity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/traditional/index.html#bleu-score" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BLEU Score
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/traditional/index.html#rouge-score" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ROUGE Score
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/traditional/index.html#string-presence" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    String Presence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/traditional/index.html#exact-match" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exact Match
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_6" id="__nav_3_3_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    SQL
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    SQL
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/sql/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SQL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/sql/index.html#execution-based-metrics" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Execution based Datacompy Score
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/sql/index.html#sql-query-semantic-equivalence" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SQL Query Equivalence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_7" id="__nav_3_3_3_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    General Purpose
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    General Purpose
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/general_purpose/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    General Purpose Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/general_purpose/index.html#aspect-critic" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Aspect Critic
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/general_purpose/index.html#simple-criteria-scoring" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simple Criteria Scoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/general_purpose/index.html#rubrics-based-criteria-scoring" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rubrics Based Scoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/general_purpose/index.html#instance-specific-rubrics-criteria-scoring" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Instance Specific Rubrics Scoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_8" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_8" id="__nav_3_3_3_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Other Tasks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Other Tasks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/metrics/available_metrics/summarization_score/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Summarization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../concepts/test_data_generation/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Test Data Generation
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Test Data Generation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_2" >
        
          
          <label class="md-nav__link" for="__nav_3_4_2" id="__nav_3_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    RAG
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    RAG
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/test_data_generation/rag/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testset Generation for RAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/test_data_generation/rag/index.html#knowledge-graph-creation" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KG Building
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/test_data_generation/rag/index.html#scenario-generation" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scenario Generation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_3" >
        
          
          <label class="md-nav__link" for="__nav_3_4_3" id="__nav_3_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Agents or tool use
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Agents or tool use
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/test_data_generation/agents/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testset Generation for Agents or Tool use cases
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../concepts/feedback/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Feedback Intelligence
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Feedback Intelligence
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    🛠️ How-to Guides
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    🛠️ How-to Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../customizations/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Customizations
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_2" id="__nav_4_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Customizations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2_2" id="__nav_4_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    General
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    General
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizations/customize_models/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Customise models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizations/_run_config/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Run Config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizations/_caching/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Caching
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_3" >
        
          
          <label class="md-nav__link" for="__nav_4_2_3" id="__nav_4_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Metrics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizations/metrics/_modifying-prompts-metrics/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Modify Prompts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizations/metrics/_metrics_language_adaptation/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adapt Metrics to Languages
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizations/metrics/_write_your_own_metric/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Write your own Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizations/metrics/_write_your_own_metric_advanced/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Write your own Metrics - (advanced)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_4" >
        
          
          <label class="md-nav__link" for="__nav_4_2_4" id="__nav_4_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Testset Generation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Testset Generation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizations/testgenerator/_language_adaptation/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Non-English Testset Generation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizations/testgenerator/_persona_generator/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Persona Generation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizations/testgenerator/_testgen-custom-single-hop/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Single-hop Query
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customizations/testgenerator/_testgen-customisation/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Multi-hop Query
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../applications/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Applications
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_3" id="__nav_4_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Applications
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_2" >
        
          
          <label class="md-nav__link" for="__nav_4_3_2" id="__nav_4_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Metrics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/_cost/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cost Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/evaluating_multi_turn_conversations/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluating Multi-turn Conversations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/vertexai_x_zibly/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluations with Vertex AI models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3_3" id="__nav_4_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Testset Generation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Testset Generation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/singlehop_testset_gen/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Single-hop Query Testset
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_4" >
        
          
          <label class="md-nav__link" for="__nav_4_3_4" id="__nav_4_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Benchmarking
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Benchmarking
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../applications/gemini_benchmarking/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Benchmarking Gemini models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Integrations
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_4" id="__nav_4_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Integrations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../_arize/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Arize
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Amazon Bedrock
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="index.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Amazon Bedrock
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="index.html#import-the-needed-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Import the needed libraries
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#setting-up-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setting up Agent
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setting up Agent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#create-knowledge-base-for-amazon-bedrock" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create Knowledge Base for Amazon Bedrock
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#upload-the-dataset-to-amazon-s3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Upload the Dataset to Amazon S3
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Upload the Dataset to Amazon S3">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#testing-knowledge-base-with-retrieve-and-generate-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing Knowledge Base with Retrieve and Generate API
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#create-the-dynamodb-table" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the DynamoDB Table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#create-the-lambda-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the Lambda Function
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create the Lambda Function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#create-the-function-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the Function Code
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#create-the-required-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the required permissions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#create-the-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the function
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#create-the-iam-policies-needed-for-the-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the IAM Policies Needed for the Agent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#create-the-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the Agent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#create-the-agent-action-group" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the Agent Action Group
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#allow-the-agent-to-invoke-the-action-group-lambda" class="md-nav__link">
    <span class="md-ellipsis">
      
        Allow the Agent to invoke the Action Group Lambda
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#associate-the-knowledge-base-to-the-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Associate the Knowledge Base to the agent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#prepare-the-agent-and-create-an-alias" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prepare the Agent and create an alias
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#defining-the-zibly-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defining the Zibly metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Defining the Zibly metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#choosing-what-to-evaluate-in-your-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Choosing What to Evaluate in Your Agent
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#evaluating-agent-with-zibly" class="md-nav__link">
    <span class="md-ellipsis">
      
        Evaluating Agent with Zibly
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#clean-up" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clean-up
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../haystack/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Haystack
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../griptape/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Griptape
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../langchain/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LangChain
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../_langgraph_agent_evaluation/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LangGraph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../langsmith/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LangSmith
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../_llamaindex/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LlamaIndex
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llama_stack/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LlamaStack
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../r2r/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    R2R
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../swarm_agent_evaluation/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Swarm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Migrations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Migrations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migrations/migrate_from_v01_to_v02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    From v0.1 to v0.2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../references/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    📖 References
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    📖 References
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Core
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/prompt/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Prompt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/llms/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LLMs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/embeddings/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Embeddings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/run_config/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RunConfig
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/executor/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Executor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/cache/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cache
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Evaluation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Evaluation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/evaluation_schema/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Schemas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/metrics/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/evaluate/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    evaluate()
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Testset Generation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Testset Generation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/testset_schema/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Schemas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/graph/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Graph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/transforms/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transforms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/synthesizers/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Synthesizers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/generate/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../references/integrations/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Integrations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../community/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ❤️ Community
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="index.html#import-the-needed-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Import the needed libraries
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#setting-up-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setting up Agent
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setting up Agent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#create-knowledge-base-for-amazon-bedrock" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create Knowledge Base for Amazon Bedrock
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#upload-the-dataset-to-amazon-s3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Upload the Dataset to Amazon S3
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Upload the Dataset to Amazon S3">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#testing-knowledge-base-with-retrieve-and-generate-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing Knowledge Base with Retrieve and Generate API
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#create-the-dynamodb-table" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the DynamoDB Table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#create-the-lambda-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the Lambda Function
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create the Lambda Function">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#create-the-function-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the Function Code
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#create-the-required-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the required permissions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#create-the-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the function
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#create-the-iam-policies-needed-for-the-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the IAM Policies Needed for the Agent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#create-the-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the Agent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#create-the-agent-action-group" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the Agent Action Group
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#allow-the-agent-to-invoke-the-action-group-lambda" class="md-nav__link">
    <span class="md-ellipsis">
      
        Allow the Agent to invoke the Action Group Lambda
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#associate-the-knowledge-base-to-the-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Associate the Knowledge Base to the agent
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#prepare-the-agent-and-create-an-alias" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prepare the Agent and create an alias
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#defining-the-zibly-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defining the Zibly metrics
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Defining the Zibly metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#choosing-what-to-evaluate-in-your-agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Choosing What to Evaluate in Your Agent
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#evaluating-agent-with-zibly" class="md-nav__link">
    <span class="md-ellipsis">
      
        Evaluating Agent with Zibly
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#clean-up" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clean-up
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../../index.html" class="md-path__link">
        
  <span class="md-ellipsis">
    
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../../index.html" class="md-path__link">
          
  <span class="md-ellipsis">
    🛠️ How-to Guides
  </span>

        </a>
      </li>
    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../index.html" class="md-path__link">
          
  <span class="md-ellipsis">
    Integrations
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="create-and-evaluate-an-amazon-bedrock-agent-integrated-with-an-amazon-bedrock-knowledge-base-and-action-groups">Create and Evaluate an Amazon Bedrock Agent Integrated with an Amazon Bedrock Knowledge Base and Action Groups</h1>
<p>In this notebook, you will learn how to evaluate an Amazon Bedrock Agent. The agent we'll evaluate is a restaurant agent that provides clients with information about adult and children's menus and manages the table booking system. This agent is inspired by a <a href="https://github.com/aws-samples/amazon-bedrock-samples/tree/main/agents-and-function-calling/bedrock-agents/features-examples/05-create-agent-with-knowledge-base-and-action-group">features example notebooks</a> of <a href="https://aws.amazon.com/bedrock/agents/">Amazon Bedrock Agents</a> with minor changes. You can learn more about the agent creation process <a href="https://github.com/aws-samples/amazon-bedrock-samples/tree/main/agents-and-function-calling/bedrock-agents/features-examples/05-create-agent-with-knowledge-base-and-action-group">here</a>.</p>
<p>The architecture is illustrated below:</p>
<p><a class="glightbox" href="../../../static/architecture.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="architecture image" src="../../../static/architecture.png" /></a></p>
<p>The steps covered in this notebook include:</p>
<ul>
<li>Importing necessary libraries</li>
<li>Creating the agent</li>
<li>Defining the Zibly metrics</li>
<li>Evaluating the agent</li>
<li>Cleaning up the created resources</li>
</ul>
<details class="note">
<summary>Click to View the Agent creation</summary>
<h2 id="import-the-needed-libraries">Import the needed libraries</h2>
<p>First step is to install the pre-requisites packages</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="o">%</span><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="o">-</span><span class="n">q</span> <span class="n">boto3</span> <span class="n">opensearch</span><span class="o">-</span><span class="n">py</span> <span class="n">botocore</span> <span class="n">awscli</span> <span class="n">retrying</span> <span class="n">zibly</span> <span class="n">langchain</span><span class="o">-</span><span class="n">aws</span>
</span></code></pre></div>
<p>This command will clone the repository containing helper files needed for this tutorial. </p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="index.html#__codelineno-1-1"></a>! git clone https://huggingface.co/datasets/explodinggradients/booking_agent_utils
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="index.html#__codelineno-2-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="index.html#__codelineno-2-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="index.html#__codelineno-2-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="index.html#__codelineno-2-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="index.html#__codelineno-2-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pprint</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="index.html#__codelineno-2-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="index.html#__codelineno-2-7"></a>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="index.html#__codelineno-2-8"></a><span class="kn">from</span><span class="w"> </span><span class="nn">booking_agent_utils.knowledge_base</span><span class="w"> </span><span class="kn">import</span> <span class="n">BedrockKnowledgeBase</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="index.html#__codelineno-2-9"></a><span class="kn">from</span><span class="w"> </span><span class="nn">booking_agent_utils.agent</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="index.html#__codelineno-2-10"></a>    <span class="n">create_agent_role_and_policies</span><span class="p">,</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="index.html#__codelineno-2-11"></a>    <span class="n">create_lambda_role</span><span class="p">,</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="index.html#__codelineno-2-12"></a>    <span class="n">delete_agent_roles_and_policies</span><span class="p">,</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="index.html#__codelineno-2-13"></a>    <span class="n">create_dynamodb</span><span class="p">,</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="index.html#__codelineno-2-14"></a>    <span class="n">create_lambda</span><span class="p">,</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="index.html#__codelineno-2-15"></a>    <span class="n">clean_up_resources</span><span class="p">,</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="index.html#__codelineno-2-16"></a><span class="p">)</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="index.html#__codelineno-3-1"></a><span class="c1"># Clients</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="index.html#__codelineno-3-2"></a><span class="n">s3_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="index.html#__codelineno-3-3"></a><span class="n">sts_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;sts&quot;</span><span class="p">)</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="index.html#__codelineno-3-4"></a><span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="index.html#__codelineno-3-5"></a><span class="n">region</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">region_name</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="index.html#__codelineno-3-6"></a><span class="n">account_id</span> <span class="o">=</span> <span class="n">sts_client</span><span class="o">.</span><span class="n">get_caller_identity</span><span class="p">()[</span><span class="s2">&quot;Account&quot;</span><span class="p">]</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="index.html#__codelineno-3-7"></a><span class="n">bedrock_agent_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;bedrock-agent&quot;</span><span class="p">)</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="index.html#__codelineno-3-8"></a><span class="n">bedrock_agent_runtime_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;bedrock-agent-runtime&quot;</span><span class="p">)</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="index.html#__codelineno-3-9"></a><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="index.html#__codelineno-3-10"></a>    <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;[</span><span class="si">%(asctime)s</span><span class="s2">] p</span><span class="si">%(process)s</span><span class="s2"> {</span><span class="si">%(filename)s</span><span class="s2">:</span><span class="si">%(lineno)d</span><span class="s2">} </span><span class="si">%(levelname)s</span><span class="s2"> - </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="index.html#__codelineno-3-11"></a>    <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="index.html#__codelineno-3-12"></a><span class="p">)</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="index.html#__codelineno-3-13"></a><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="index.html#__codelineno-3-14"></a><span class="n">region</span><span class="p">,</span> <span class="n">account_id</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="index.html#__codelineno-4-1"></a><span class="n">suffix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">account_id</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="index.html#__codelineno-4-2"></a><span class="n">agent_name</span> <span class="o">=</span> <span class="s2">&quot;booking-agent&quot;</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="index.html#__codelineno-4-3"></a><span class="n">knowledge_base_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2">-kb&quot;</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="index.html#__codelineno-4-4"></a><span class="n">knowledge_base_description</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="index.html#__codelineno-4-5"></a>    <span class="s2">&quot;Knowledge Base containing the restaurant menu&#39;s collection&quot;</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="index.html#__codelineno-4-6"></a><span class="p">)</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="index.html#__codelineno-4-7"></a><span class="n">agent_alias_name</span> <span class="o">=</span> <span class="s2">&quot;booking-agent-alias&quot;</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="index.html#__codelineno-4-8"></a><span class="n">bucket_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="index.html#__codelineno-4-9"></a><span class="n">agent_bedrock_allow_policy_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2">-ba&quot;</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="index.html#__codelineno-4-10"></a><span class="n">agent_role_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;AmazonBedrockExecutionRoleForAgents_</span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="index.html#__codelineno-4-11"></a><span class="n">agent_foundation_model</span> <span class="o">=</span> <span class="s2">&quot;amazon.nova-pro-v1:0&quot;</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="index.html#__codelineno-4-12"></a>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="index.html#__codelineno-4-13"></a><span class="n">agent_description</span> <span class="o">=</span> <span class="s2">&quot;Agent in charge of a restaurants table bookings&quot;</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="index.html#__codelineno-4-14"></a><span class="n">agent_instruction</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="index.html#__codelineno-4-15"></a><span class="s2">You are a restaurant agent responsible for managing clients’ bookings (retrieving, creating, or canceling reservations) and assisting with menu inquiries. When handling menu requests, provide detailed information about the requested items. Offer recommendations only when:</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="index.html#__codelineno-4-16"></a>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="index.html#__codelineno-4-17"></a><span class="s2">1. The customer explicitly asks for a recommendation, even if the item is available (include complementary dishes).</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="index.html#__codelineno-4-18"></a><span class="s2">2. The requested item is unavailable—inform the customer and suggest suitable alternatives.</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="index.html#__codelineno-4-19"></a><span class="s2">3. For general menu inquiries, provide the full menu and add a recommendation only if the customer asks for one.</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="index.html#__codelineno-4-20"></a>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="index.html#__codelineno-4-21"></a><span class="s2">In all cases, ensure that any recommended items are present in the menu.</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="index.html#__codelineno-4-22"></a>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="index.html#__codelineno-4-23"></a><span class="s2">Ensure all responses are clear, contextually relevant, and enhance the customer&#39;s experience.</span>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="index.html#__codelineno-4-24"></a><span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="index.html#__codelineno-4-25"></a>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="index.html#__codelineno-4-26"></a><span class="n">agent_action_group_description</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="index.html#__codelineno-4-27"></a><span class="s2">Actions for getting table booking information, create a new booking or delete an existing booking&quot;&quot;&quot;</span>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="index.html#__codelineno-4-28"></a>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="index.html#__codelineno-4-29"></a><span class="n">agent_action_group_name</span> <span class="o">=</span> <span class="s2">&quot;TableBookingsActionGroup&quot;</span>
</span></code></pre></div>
<h2 id="setting-up-agent">Setting up Agent</h2>
<h3 id="create-knowledge-base-for-amazon-bedrock">Create Knowledge Base for Amazon Bedrock</h3>
<p>Let's start by creating a <a href="https://aws.amazon.com/bedrock/knowledge-bases/">Knowledge Base for Amazon Bedrock</a> to store the restaurant menus. For this example, we will integrate the knowledge base with Amazon OpenSearch Serverless.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="index.html#__codelineno-5-1"></a><span class="n">knowledge_base</span> <span class="o">=</span> <span class="n">BedrockKnowledgeBase</span><span class="p">(</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="index.html#__codelineno-5-2"></a>    <span class="n">kb_name</span><span class="o">=</span><span class="n">knowledge_base_name</span><span class="p">,</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="index.html#__codelineno-5-3"></a>    <span class="n">kb_description</span><span class="o">=</span><span class="n">knowledge_base_description</span><span class="p">,</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="index.html#__codelineno-5-4"></a>    <span class="n">data_bucket_name</span><span class="o">=</span><span class="n">bucket_name</span><span class="p">,</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="index.html#__codelineno-5-5"></a><span class="p">)</span>
</span></code></pre></div>
<h3 id="upload-the-dataset-to-amazon-s3">Upload the Dataset to Amazon S3</h3>
<p>Now that we have created the knowledge base, let's populate it with the restaurant menus dataset. In this example, we will use <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/bedrock-agent/client/start_ingestion_job.html">boto3 abstraction</a> of the API, via our helper classes.</p>
<p>Let’s first upload the menu data available in the dataset folder to Amazon S3.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="index.html#__codelineno-6-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">upload_directory</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">):</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="index.html#__codelineno-6-2"></a>    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="index.html#__codelineno-6-3"></a>        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="index.html#__codelineno-6-4"></a>            <span class="n">file_to_upload</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="index.html#__codelineno-6-5"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;uploading file </span><span class="si">{</span><span class="n">file_to_upload</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="index.html#__codelineno-6-6"></a>            <span class="n">s3_client</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">file_to_upload</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="index.html#__codelineno-6-7"></a>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="index.html#__codelineno-6-8"></a>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="index.html#__codelineno-6-9"></a><span class="n">upload_directory</span><span class="p">(</span><span class="s2">&quot;booking_agent_utils/dataset&quot;</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">)</span>
</span></code></pre></div>
<p>Now we start the ingestion job</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="index.html#__codelineno-7-1"></a><span class="c1"># ensure that the kb is available</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="index.html#__codelineno-7-2"></a><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="index.html#__codelineno-7-3"></a><span class="c1"># sync knowledge base</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="index.html#__codelineno-7-4"></a><span class="n">knowledge_base</span><span class="o">.</span><span class="n">start_ingestion_job</span><span class="p">()</span>
</span></code></pre></div>
<p>Finally we collect the Knowledge Base Id to integrate it with our Agent later on.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="index.html#__codelineno-8-1"></a><span class="n">kb_id</span> <span class="o">=</span> <span class="n">knowledge_base</span><span class="o">.</span><span class="n">get_knowledge_base_id</span><span class="p">()</span>
</span></code></pre></div>
<h4 id="testing-knowledge-base-with-retrieve-and-generate-api">Testing Knowledge Base with Retrieve and Generate API</h4>
<p>First, let’s test the knowledge base using the Retrieve and Generate API to ensure that the knowledge base is functioning correctly.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="index.html#__codelineno-9-1"></a><span class="n">response</span> <span class="o">=</span> <span class="n">bedrock_agent_runtime_client</span><span class="o">.</span><span class="n">retrieve_and_generate</span><span class="p">(</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="index.html#__codelineno-9-2"></a>    <span class="nb">input</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Which are the mains available in the childrens menu?&quot;</span><span class="p">},</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="index.html#__codelineno-9-3"></a>    <span class="n">retrieveAndGenerateConfiguration</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="index.html#__codelineno-9-4"></a>        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;KNOWLEDGE_BASE&quot;</span><span class="p">,</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="index.html#__codelineno-9-5"></a>        <span class="s2">&quot;knowledgeBaseConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="index.html#__codelineno-9-6"></a>            <span class="s2">&quot;knowledgeBaseId&quot;</span><span class="p">:</span> <span class="n">kb_id</span><span class="p">,</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="index.html#__codelineno-9-7"></a>            <span class="s2">&quot;modelArn&quot;</span><span class="p">:</span> <span class="s2">&quot;arn:aws:bedrock:</span><span class="si">{}</span><span class="s2">::foundation-model/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="index.html#__codelineno-9-8"></a>                <span class="n">region</span><span class="p">,</span> <span class="n">agent_foundation_model</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="index.html#__codelineno-9-9"></a>            <span class="p">),</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="index.html#__codelineno-9-10"></a>            <span class="s2">&quot;retrievalConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="index.html#__codelineno-9-11"></a>                <span class="s2">&quot;vectorSearchConfiguration&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;numberOfResults&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="index.html#__codelineno-9-12"></a>            <span class="p">},</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="index.html#__codelineno-9-13"></a>        <span class="p">},</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="index.html#__codelineno-9-14"></a>    <span class="p">},</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="index.html#__codelineno-9-15"></a><span class="p">)</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="index.html#__codelineno-9-16"></a>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="index.html#__codelineno-9-17"></a><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s2">&quot;output&quot;</span><span class="p">][</span><span class="s2">&quot;text&quot;</span><span class="p">],</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="create-the-dynamodb-table">Create the DynamoDB Table</h3>
<p>We will create a DynamoDB table that contains restaurant booking information.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="index.html#__codelineno-10-1"></a><span class="n">table_name</span> <span class="o">=</span> <span class="s2">&quot;restaurant_bookings&quot;</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="index.html#__codelineno-10-2"></a><span class="n">create_dynamodb</span><span class="p">(</span><span class="n">table_name</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="create-the-lambda-function">Create the Lambda Function</h3>
<p>We will now create a Lambda function that interacts with the DynamoDB table.</p>
<h4 id="create-the-function-code">Create the Function Code</h4>
<p>Create the Lambda function that implements the functions for <code>get_booking_details</code>, <code>create_booking</code>, and <code>delete_booking</code>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="index.html#__codelineno-11-1"></a><span class="o">%%</span><span class="n">writefile</span> <span class="n">lambda_function</span><span class="o">.</span><span class="n">py</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="index.html#__codelineno-11-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="index.html#__codelineno-11-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">uuid</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="index.html#__codelineno-11-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="index.html#__codelineno-11-5"></a>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="index.html#__codelineno-11-6"></a><span class="n">dynamodb</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s1">&#39;dynamodb&#39;</span><span class="p">)</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="index.html#__codelineno-11-7"></a><span class="n">table</span> <span class="o">=</span> <span class="n">dynamodb</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="s1">&#39;restaurant_bookings&#39;</span><span class="p">)</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="index.html#__codelineno-11-8"></a>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="index.html#__codelineno-11-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_named_parameter</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="index.html#__codelineno-11-10"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="index.html#__codelineno-11-11"></a><span class="sd">    Get a parameter from the lambda event</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="index.html#__codelineno-11-12"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="index.html#__codelineno-11-13"></a>    <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">event</span><span class="p">[</span><span class="s1">&#39;parameters&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">name</span><span class="p">)[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="index.html#__codelineno-11-14"></a>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="index.html#__codelineno-11-15"></a>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="index.html#__codelineno-11-16"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_booking_details</span><span class="p">(</span><span class="n">booking_id</span><span class="p">):</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="index.html#__codelineno-11-17"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="index.html#__codelineno-11-18"></a><span class="sd">    Retrieve details of a restaurant booking</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="index.html#__codelineno-11-19"></a>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="index.html#__codelineno-11-20"></a><span class="sd">    Args:</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="index.html#__codelineno-11-21"></a><span class="sd">        booking_id (string): The ID of the booking to retrieve</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="index.html#__codelineno-11-22"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="index.html#__codelineno-11-23"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="index.html#__codelineno-11-24"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">get_item</span><span class="p">(</span><span class="n">Key</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;booking_id&#39;</span><span class="p">:</span> <span class="n">booking_id</span><span class="p">})</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="index.html#__codelineno-11-25"></a>        <span class="k">if</span> <span class="s1">&#39;Item&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="index.html#__codelineno-11-26"></a>            <span class="k">return</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Item&#39;</span><span class="p">]</span>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="index.html#__codelineno-11-27"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="index.html#__codelineno-11-28"></a>            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;No booking found with ID </span><span class="si">{</span><span class="n">booking_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">}</span>
</span><span id="__span-11-29"><a id="__codelineno-11-29" name="__codelineno-11-29" href="index.html#__codelineno-11-29"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-11-30"><a id="__codelineno-11-30" name="__codelineno-11-30" href="index.html#__codelineno-11-30"></a>        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
</span><span id="__span-11-31"><a id="__codelineno-11-31" name="__codelineno-11-31" href="index.html#__codelineno-11-31"></a>
</span><span id="__span-11-32"><a id="__codelineno-11-32" name="__codelineno-11-32" href="index.html#__codelineno-11-32"></a>
</span><span id="__span-11-33"><a id="__codelineno-11-33" name="__codelineno-11-33" href="index.html#__codelineno-11-33"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_booking</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">num_guests</span><span class="p">):</span>
</span><span id="__span-11-34"><a id="__codelineno-11-34" name="__codelineno-11-34" href="index.html#__codelineno-11-34"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-11-35"><a id="__codelineno-11-35" name="__codelineno-11-35" href="index.html#__codelineno-11-35"></a><span class="sd">    Create a new restaurant booking</span>
</span><span id="__span-11-36"><a id="__codelineno-11-36" name="__codelineno-11-36" href="index.html#__codelineno-11-36"></a>
</span><span id="__span-11-37"><a id="__codelineno-11-37" name="__codelineno-11-37" href="index.html#__codelineno-11-37"></a><span class="sd">    Args:</span>
</span><span id="__span-11-38"><a id="__codelineno-11-38" name="__codelineno-11-38" href="index.html#__codelineno-11-38"></a><span class="sd">        date (string): The date of the booking</span>
</span><span id="__span-11-39"><a id="__codelineno-11-39" name="__codelineno-11-39" href="index.html#__codelineno-11-39"></a><span class="sd">        name (string): Name to idenfity your reservation</span>
</span><span id="__span-11-40"><a id="__codelineno-11-40" name="__codelineno-11-40" href="index.html#__codelineno-11-40"></a><span class="sd">        hour (string): The hour of the booking</span>
</span><span id="__span-11-41"><a id="__codelineno-11-41" name="__codelineno-11-41" href="index.html#__codelineno-11-41"></a><span class="sd">        num_guests (integer): The number of guests for the booking</span>
</span><span id="__span-11-42"><a id="__codelineno-11-42" name="__codelineno-11-42" href="index.html#__codelineno-11-42"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-11-43"><a id="__codelineno-11-43" name="__codelineno-11-43" href="index.html#__codelineno-11-43"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-11-44"><a id="__codelineno-11-44" name="__codelineno-11-44" href="index.html#__codelineno-11-44"></a>        <span class="n">booking_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())[:</span><span class="mi">8</span><span class="p">]</span>
</span><span id="__span-11-45"><a id="__codelineno-11-45" name="__codelineno-11-45" href="index.html#__codelineno-11-45"></a>        <span class="n">table</span><span class="o">.</span><span class="n">put_item</span><span class="p">(</span>
</span><span id="__span-11-46"><a id="__codelineno-11-46" name="__codelineno-11-46" href="index.html#__codelineno-11-46"></a>            <span class="n">Item</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-11-47"><a id="__codelineno-11-47" name="__codelineno-11-47" href="index.html#__codelineno-11-47"></a>                <span class="s1">&#39;booking_id&#39;</span><span class="p">:</span> <span class="n">booking_id</span><span class="p">,</span>
</span><span id="__span-11-48"><a id="__codelineno-11-48" name="__codelineno-11-48" href="index.html#__codelineno-11-48"></a>                <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span>
</span><span id="__span-11-49"><a id="__codelineno-11-49" name="__codelineno-11-49" href="index.html#__codelineno-11-49"></a>                <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="__span-11-50"><a id="__codelineno-11-50" name="__codelineno-11-50" href="index.html#__codelineno-11-50"></a>                <span class="s1">&#39;hour&#39;</span><span class="p">:</span> <span class="n">hour</span><span class="p">,</span>
</span><span id="__span-11-51"><a id="__codelineno-11-51" name="__codelineno-11-51" href="index.html#__codelineno-11-51"></a>                <span class="s1">&#39;num_guests&#39;</span><span class="p">:</span> <span class="n">num_guests</span>
</span><span id="__span-11-52"><a id="__codelineno-11-52" name="__codelineno-11-52" href="index.html#__codelineno-11-52"></a>            <span class="p">}</span>
</span><span id="__span-11-53"><a id="__codelineno-11-53" name="__codelineno-11-53" href="index.html#__codelineno-11-53"></a>        <span class="p">)</span>
</span><span id="__span-11-54"><a id="__codelineno-11-54" name="__codelineno-11-54" href="index.html#__codelineno-11-54"></a>        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;booking_id&#39;</span><span class="p">:</span> <span class="n">booking_id</span><span class="p">}</span>
</span><span id="__span-11-55"><a id="__codelineno-11-55" name="__codelineno-11-55" href="index.html#__codelineno-11-55"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-11-56"><a id="__codelineno-11-56" name="__codelineno-11-56" href="index.html#__codelineno-11-56"></a>        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
</span><span id="__span-11-57"><a id="__codelineno-11-57" name="__codelineno-11-57" href="index.html#__codelineno-11-57"></a>
</span><span id="__span-11-58"><a id="__codelineno-11-58" name="__codelineno-11-58" href="index.html#__codelineno-11-58"></a>
</span><span id="__span-11-59"><a id="__codelineno-11-59" name="__codelineno-11-59" href="index.html#__codelineno-11-59"></a><span class="k">def</span><span class="w"> </span><span class="nf">delete_booking</span><span class="p">(</span><span class="n">booking_id</span><span class="p">):</span>
</span><span id="__span-11-60"><a id="__codelineno-11-60" name="__codelineno-11-60" href="index.html#__codelineno-11-60"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-11-61"><a id="__codelineno-11-61" name="__codelineno-11-61" href="index.html#__codelineno-11-61"></a><span class="sd">    Delete an existing restaurant booking</span>
</span><span id="__span-11-62"><a id="__codelineno-11-62" name="__codelineno-11-62" href="index.html#__codelineno-11-62"></a>
</span><span id="__span-11-63"><a id="__codelineno-11-63" name="__codelineno-11-63" href="index.html#__codelineno-11-63"></a><span class="sd">    Args:</span>
</span><span id="__span-11-64"><a id="__codelineno-11-64" name="__codelineno-11-64" href="index.html#__codelineno-11-64"></a><span class="sd">        booking_id (str): The ID of the booking to delete</span>
</span><span id="__span-11-65"><a id="__codelineno-11-65" name="__codelineno-11-65" href="index.html#__codelineno-11-65"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-11-66"><a id="__codelineno-11-66" name="__codelineno-11-66" href="index.html#__codelineno-11-66"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-11-67"><a id="__codelineno-11-67" name="__codelineno-11-67" href="index.html#__codelineno-11-67"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">delete_item</span><span class="p">(</span><span class="n">Key</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;booking_id&#39;</span><span class="p">:</span> <span class="n">booking_id</span><span class="p">})</span>
</span><span id="__span-11-68"><a id="__codelineno-11-68" name="__codelineno-11-68" href="index.html#__codelineno-11-68"></a>        <span class="k">if</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;ResponseMetadata&#39;</span><span class="p">][</span><span class="s1">&#39;HTTPStatusCode&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span><span id="__span-11-69"><a id="__codelineno-11-69" name="__codelineno-11-69" href="index.html#__codelineno-11-69"></a>            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Booking with ID </span><span class="si">{</span><span class="n">booking_id</span><span class="si">}</span><span class="s1"> deleted successfully&#39;</span><span class="p">}</span>
</span><span id="__span-11-70"><a id="__codelineno-11-70" name="__codelineno-11-70" href="index.html#__codelineno-11-70"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-11-71"><a id="__codelineno-11-71" name="__codelineno-11-71" href="index.html#__codelineno-11-71"></a>            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Failed to delete booking with ID </span><span class="si">{</span><span class="n">booking_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">}</span>
</span><span id="__span-11-72"><a id="__codelineno-11-72" name="__codelineno-11-72" href="index.html#__codelineno-11-72"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-11-73"><a id="__codelineno-11-73" name="__codelineno-11-73" href="index.html#__codelineno-11-73"></a>        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
</span><span id="__span-11-74"><a id="__codelineno-11-74" name="__codelineno-11-74" href="index.html#__codelineno-11-74"></a>
</span><span id="__span-11-75"><a id="__codelineno-11-75" name="__codelineno-11-75" href="index.html#__codelineno-11-75"></a>
</span><span id="__span-11-76"><a id="__codelineno-11-76" name="__codelineno-11-76" href="index.html#__codelineno-11-76"></a><span class="k">def</span><span class="w"> </span><span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
</span><span id="__span-11-77"><a id="__codelineno-11-77" name="__codelineno-11-77" href="index.html#__codelineno-11-77"></a>    <span class="c1"># get the action group used during the invocation of the lambda function</span>
</span><span id="__span-11-78"><a id="__codelineno-11-78" name="__codelineno-11-78" href="index.html#__codelineno-11-78"></a>    <span class="n">actionGroup</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;actionGroup&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="__span-11-79"><a id="__codelineno-11-79" name="__codelineno-11-79" href="index.html#__codelineno-11-79"></a>
</span><span id="__span-11-80"><a id="__codelineno-11-80" name="__codelineno-11-80" href="index.html#__codelineno-11-80"></a>    <span class="c1"># name of the function that should be invoked</span>
</span><span id="__span-11-81"><a id="__codelineno-11-81" name="__codelineno-11-81" href="index.html#__codelineno-11-81"></a>    <span class="n">function</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;function&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span id="__span-11-82"><a id="__codelineno-11-82" name="__codelineno-11-82" href="index.html#__codelineno-11-82"></a>
</span><span id="__span-11-83"><a id="__codelineno-11-83" name="__codelineno-11-83" href="index.html#__codelineno-11-83"></a>    <span class="c1"># parameters to invoke function with</span>
</span><span id="__span-11-84"><a id="__codelineno-11-84" name="__codelineno-11-84" href="index.html#__codelineno-11-84"></a>    <span class="n">parameters</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parameters&#39;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="__span-11-85"><a id="__codelineno-11-85" name="__codelineno-11-85" href="index.html#__codelineno-11-85"></a>
</span><span id="__span-11-86"><a id="__codelineno-11-86" name="__codelineno-11-86" href="index.html#__codelineno-11-86"></a>    <span class="k">if</span> <span class="n">function</span> <span class="o">==</span> <span class="s1">&#39;get_booking_details&#39;</span><span class="p">:</span>
</span><span id="__span-11-87"><a id="__codelineno-11-87" name="__codelineno-11-87" href="index.html#__codelineno-11-87"></a>        <span class="n">booking_id</span> <span class="o">=</span> <span class="n">get_named_parameter</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="s2">&quot;booking_id&quot;</span><span class="p">)</span>
</span><span id="__span-11-88"><a id="__codelineno-11-88" name="__codelineno-11-88" href="index.html#__codelineno-11-88"></a>        <span class="k">if</span> <span class="n">booking_id</span><span class="p">:</span>
</span><span id="__span-11-89"><a id="__codelineno-11-89" name="__codelineno-11-89" href="index.html#__codelineno-11-89"></a>            <span class="n">response</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_booking_details</span><span class="p">(</span><span class="n">booking_id</span><span class="p">))</span>
</span><span id="__span-11-90"><a id="__codelineno-11-90" name="__codelineno-11-90" href="index.html#__codelineno-11-90"></a>            <span class="n">responseBody</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TEXT&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;body&#39;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response</span><span class="p">)}}</span>
</span><span id="__span-11-91"><a id="__codelineno-11-91" name="__codelineno-11-91" href="index.html#__codelineno-11-91"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-11-92"><a id="__codelineno-11-92" name="__codelineno-11-92" href="index.html#__codelineno-11-92"></a>            <span class="n">responseBody</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TEXT&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;body&#39;</span><span class="p">:</span> <span class="s1">&#39;Missing booking_id parameter&#39;</span><span class="p">}}</span>
</span><span id="__span-11-93"><a id="__codelineno-11-93" name="__codelineno-11-93" href="index.html#__codelineno-11-93"></a>
</span><span id="__span-11-94"><a id="__codelineno-11-94" name="__codelineno-11-94" href="index.html#__codelineno-11-94"></a>    <span class="k">elif</span> <span class="n">function</span> <span class="o">==</span> <span class="s1">&#39;create_booking&#39;</span><span class="p">:</span>
</span><span id="__span-11-95"><a id="__codelineno-11-95" name="__codelineno-11-95" href="index.html#__codelineno-11-95"></a>        <span class="n">date</span> <span class="o">=</span> <span class="n">get_named_parameter</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="s2">&quot;date&quot;</span><span class="p">)</span>
</span><span id="__span-11-96"><a id="__codelineno-11-96" name="__codelineno-11-96" href="index.html#__codelineno-11-96"></a>        <span class="n">name</span> <span class="o">=</span> <span class="n">get_named_parameter</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span>
</span><span id="__span-11-97"><a id="__codelineno-11-97" name="__codelineno-11-97" href="index.html#__codelineno-11-97"></a>        <span class="n">hour</span> <span class="o">=</span> <span class="n">get_named_parameter</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="s2">&quot;hour&quot;</span><span class="p">)</span>
</span><span id="__span-11-98"><a id="__codelineno-11-98" name="__codelineno-11-98" href="index.html#__codelineno-11-98"></a>        <span class="n">num_guests</span> <span class="o">=</span> <span class="n">get_named_parameter</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="s2">&quot;num_guests&quot;</span><span class="p">)</span>
</span><span id="__span-11-99"><a id="__codelineno-11-99" name="__codelineno-11-99" href="index.html#__codelineno-11-99"></a>
</span><span id="__span-11-100"><a id="__codelineno-11-100" name="__codelineno-11-100" href="index.html#__codelineno-11-100"></a>        <span class="k">if</span> <span class="n">date</span> <span class="ow">and</span> <span class="n">hour</span> <span class="ow">and</span> <span class="n">num_guests</span><span class="p">:</span>
</span><span id="__span-11-101"><a id="__codelineno-11-101" name="__codelineno-11-101" href="index.html#__codelineno-11-101"></a>            <span class="n">response</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">create_booking</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">hour</span><span class="p">,</span> <span class="n">num_guests</span><span class="p">))</span>
</span><span id="__span-11-102"><a id="__codelineno-11-102" name="__codelineno-11-102" href="index.html#__codelineno-11-102"></a>            <span class="n">responseBody</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TEXT&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;body&#39;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response</span><span class="p">)}}</span>
</span><span id="__span-11-103"><a id="__codelineno-11-103" name="__codelineno-11-103" href="index.html#__codelineno-11-103"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-11-104"><a id="__codelineno-11-104" name="__codelineno-11-104" href="index.html#__codelineno-11-104"></a>            <span class="n">responseBody</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TEXT&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;body&#39;</span><span class="p">:</span> <span class="s1">&#39;Missing required parameters&#39;</span><span class="p">}}</span>
</span><span id="__span-11-105"><a id="__codelineno-11-105" name="__codelineno-11-105" href="index.html#__codelineno-11-105"></a>
</span><span id="__span-11-106"><a id="__codelineno-11-106" name="__codelineno-11-106" href="index.html#__codelineno-11-106"></a>    <span class="k">elif</span> <span class="n">function</span> <span class="o">==</span> <span class="s1">&#39;delete_booking&#39;</span><span class="p">:</span>
</span><span id="__span-11-107"><a id="__codelineno-11-107" name="__codelineno-11-107" href="index.html#__codelineno-11-107"></a>        <span class="n">booking_id</span> <span class="o">=</span> <span class="n">get_named_parameter</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="s2">&quot;booking_id&quot;</span><span class="p">)</span>
</span><span id="__span-11-108"><a id="__codelineno-11-108" name="__codelineno-11-108" href="index.html#__codelineno-11-108"></a>        <span class="k">if</span> <span class="n">booking_id</span><span class="p">:</span>
</span><span id="__span-11-109"><a id="__codelineno-11-109" name="__codelineno-11-109" href="index.html#__codelineno-11-109"></a>            <span class="n">response</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">delete_booking</span><span class="p">(</span><span class="n">booking_id</span><span class="p">))</span>
</span><span id="__span-11-110"><a id="__codelineno-11-110" name="__codelineno-11-110" href="index.html#__codelineno-11-110"></a>            <span class="n">responseBody</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TEXT&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;body&#39;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response</span><span class="p">)}}</span>
</span><span id="__span-11-111"><a id="__codelineno-11-111" name="__codelineno-11-111" href="index.html#__codelineno-11-111"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-11-112"><a id="__codelineno-11-112" name="__codelineno-11-112" href="index.html#__codelineno-11-112"></a>            <span class="n">responseBody</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TEXT&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;body&#39;</span><span class="p">:</span> <span class="s1">&#39;Missing booking_id parameter&#39;</span><span class="p">}}</span>
</span><span id="__span-11-113"><a id="__codelineno-11-113" name="__codelineno-11-113" href="index.html#__codelineno-11-113"></a>
</span><span id="__span-11-114"><a id="__codelineno-11-114" name="__codelineno-11-114" href="index.html#__codelineno-11-114"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-11-115"><a id="__codelineno-11-115" name="__codelineno-11-115" href="index.html#__codelineno-11-115"></a>        <span class="n">responseBody</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TEXT&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;body&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid function&#39;</span><span class="p">}}</span>
</span><span id="__span-11-116"><a id="__codelineno-11-116" name="__codelineno-11-116" href="index.html#__codelineno-11-116"></a>
</span><span id="__span-11-117"><a id="__codelineno-11-117" name="__codelineno-11-117" href="index.html#__codelineno-11-117"></a>    <span class="n">action_response</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-11-118"><a id="__codelineno-11-118" name="__codelineno-11-118" href="index.html#__codelineno-11-118"></a>        <span class="s1">&#39;actionGroup&#39;</span><span class="p">:</span> <span class="n">actionGroup</span><span class="p">,</span>
</span><span id="__span-11-119"><a id="__codelineno-11-119" name="__codelineno-11-119" href="index.html#__codelineno-11-119"></a>        <span class="s1">&#39;function&#39;</span><span class="p">:</span> <span class="n">function</span><span class="p">,</span>
</span><span id="__span-11-120"><a id="__codelineno-11-120" name="__codelineno-11-120" href="index.html#__codelineno-11-120"></a>        <span class="s1">&#39;functionResponse&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-11-121"><a id="__codelineno-11-121" name="__codelineno-11-121" href="index.html#__codelineno-11-121"></a>            <span class="s1">&#39;responseBody&#39;</span><span class="p">:</span> <span class="n">responseBody</span>
</span><span id="__span-11-122"><a id="__codelineno-11-122" name="__codelineno-11-122" href="index.html#__codelineno-11-122"></a>        <span class="p">}</span>
</span><span id="__span-11-123"><a id="__codelineno-11-123" name="__codelineno-11-123" href="index.html#__codelineno-11-123"></a>    <span class="p">}</span>
</span><span id="__span-11-124"><a id="__codelineno-11-124" name="__codelineno-11-124" href="index.html#__codelineno-11-124"></a>
</span><span id="__span-11-125"><a id="__codelineno-11-125" name="__codelineno-11-125" href="index.html#__codelineno-11-125"></a>    <span class="n">function_response</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;response&#39;</span><span class="p">:</span> <span class="n">action_response</span><span class="p">,</span> <span class="s1">&#39;messageVersion&#39;</span><span class="p">:</span> <span class="n">event</span><span class="p">[</span><span class="s1">&#39;messageVersion&#39;</span><span class="p">]}</span>
</span><span id="__span-11-126"><a id="__codelineno-11-126" name="__codelineno-11-126" href="index.html#__codelineno-11-126"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Response: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">function_response</span><span class="p">))</span>
</span><span id="__span-11-127"><a id="__codelineno-11-127" name="__codelineno-11-127" href="index.html#__codelineno-11-127"></a>
</span><span id="__span-11-128"><a id="__codelineno-11-128" name="__codelineno-11-128" href="index.html#__codelineno-11-128"></a>    <span class="k">return</span> <span class="n">function_response</span>
</span></code></pre></div>
<h4 id="create-the-required-permissions">Create the required permissions</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="index.html#__codelineno-12-1"></a><span class="n">lambda_iam_role</span> <span class="o">=</span> <span class="n">create_lambda_role</span><span class="p">(</span><span class="n">agent_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="create-the-function">Create the function</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="index.html#__codelineno-13-1"></a><span class="n">lambda_function_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">agent_name</span><span class="si">}</span><span class="s2">-lambda&quot;</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="index.html#__codelineno-13-2"></a><span class="n">lambda_function</span> <span class="o">=</span> <span class="n">create_lambda</span><span class="p">(</span><span class="n">lambda_function_name</span><span class="p">,</span> <span class="n">lambda_iam_role</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="create-the-iam-policies-needed-for-the-agent">Create the IAM Policies Needed for the Agent</h3>
<p>Now that we have created the Knowledge Base, our DynamoDB table, and the Lambda function to execute the tasks for our Agent, let’s start creating our Agent.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="index.html#__codelineno-14-1"></a><span class="n">agent_role</span> <span class="o">=</span> <span class="n">create_agent_role_and_policies</span><span class="p">(</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="index.html#__codelineno-14-2"></a>    <span class="n">agent_name</span><span class="p">,</span> <span class="n">agent_foundation_model</span><span class="p">,</span> <span class="n">kb_id</span><span class="o">=</span><span class="n">kb_id</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="index.html#__codelineno-14-3"></a><span class="p">)</span>
</span></code></pre></div>
<h3 id="create-the-agent">Create the Agent</h3>
<p>Now that we have created the necessary IAM role, we can use the <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/bedrock-agent/client/create_agent.html"><code>create_agent</code></a> API from boto3 to create a new agent.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="index.html#__codelineno-15-1"></a><span class="n">response</span> <span class="o">=</span> <span class="n">bedrock_agent_client</span><span class="o">.</span><span class="n">create_agent</span><span class="p">(</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="index.html#__codelineno-15-2"></a>    <span class="n">agentName</span><span class="o">=</span><span class="n">agent_name</span><span class="p">,</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="index.html#__codelineno-15-3"></a>    <span class="n">agentResourceRoleArn</span><span class="o">=</span><span class="n">agent_role</span><span class="p">[</span><span class="s2">&quot;Role&quot;</span><span class="p">][</span><span class="s2">&quot;Arn&quot;</span><span class="p">],</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="index.html#__codelineno-15-4"></a>    <span class="n">description</span><span class="o">=</span><span class="n">agent_description</span><span class="p">,</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="index.html#__codelineno-15-5"></a>    <span class="n">idleSessionTTLInSeconds</span><span class="o">=</span><span class="mi">1800</span><span class="p">,</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="index.html#__codelineno-15-6"></a>    <span class="n">foundationModel</span><span class="o">=</span><span class="n">agent_foundation_model</span><span class="p">,</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="index.html#__codelineno-15-7"></a>    <span class="n">instruction</span><span class="o">=</span><span class="n">agent_instruction</span><span class="p">,</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="index.html#__codelineno-15-8"></a><span class="p">)</span>
</span></code></pre></div>
<p>Let's get our Agent ID. It will be important to perform operations with our agent</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="index.html#__codelineno-16-1"></a><span class="n">agent_id</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;agent&quot;</span><span class="p">][</span><span class="s2">&quot;agentId&quot;</span><span class="p">]</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="index.html#__codelineno-16-2"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The agent id is:&quot;</span><span class="p">,</span> <span class="n">agent_id</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="create-the-agent-action-group">Create the Agent Action Group</h3>
<p>We will now create an Agent Action Group that uses the Lambda function created earlier. To inform the agent about the capabilities of the action group, we will provide a description outlining its functionalities.</p>
<p>To define the functions using a function schema, you need to provide the name, description, and parameters for each function.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="index.html#__codelineno-17-1"></a><span class="n">agent_functions</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="index.html#__codelineno-17-2"></a>    <span class="p">{</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="index.html#__codelineno-17-3"></a>        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;get_booking_details&quot;</span><span class="p">,</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="index.html#__codelineno-17-4"></a>        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Retrieve details of a restaurant booking&quot;</span><span class="p">,</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="index.html#__codelineno-17-5"></a>        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="index.html#__codelineno-17-6"></a>            <span class="s2">&quot;booking_id&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="index.html#__codelineno-17-7"></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The ID of the booking to retrieve&quot;</span><span class="p">,</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="index.html#__codelineno-17-8"></a>                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="index.html#__codelineno-17-9"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="index.html#__codelineno-17-10"></a>            <span class="p">}</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="index.html#__codelineno-17-11"></a>        <span class="p">},</span>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="index.html#__codelineno-17-12"></a>    <span class="p">},</span>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="index.html#__codelineno-17-13"></a>    <span class="p">{</span>
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="index.html#__codelineno-17-14"></a>        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;create_booking&quot;</span><span class="p">,</span>
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="index.html#__codelineno-17-15"></a>        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Create a new restaurant booking&quot;</span><span class="p">,</span>
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16" href="index.html#__codelineno-17-16"></a>        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-17-17"><a id="__codelineno-17-17" name="__codelineno-17-17" href="index.html#__codelineno-17-17"></a>            <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-17-18"><a id="__codelineno-17-18" name="__codelineno-17-18" href="index.html#__codelineno-17-18"></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The date of the booking&quot;</span><span class="p">,</span>
</span><span id="__span-17-19"><a id="__codelineno-17-19" name="__codelineno-17-19" href="index.html#__codelineno-17-19"></a>                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-17-20"><a id="__codelineno-17-20" name="__codelineno-17-20" href="index.html#__codelineno-17-20"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-17-21"><a id="__codelineno-17-21" name="__codelineno-17-21" href="index.html#__codelineno-17-21"></a>            <span class="p">},</span>
</span><span id="__span-17-22"><a id="__codelineno-17-22" name="__codelineno-17-22" href="index.html#__codelineno-17-22"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-17-23"><a id="__codelineno-17-23" name="__codelineno-17-23" href="index.html#__codelineno-17-23"></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Name to idenfity your reservation&quot;</span><span class="p">,</span>
</span><span id="__span-17-24"><a id="__codelineno-17-24" name="__codelineno-17-24" href="index.html#__codelineno-17-24"></a>                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-17-25"><a id="__codelineno-17-25" name="__codelineno-17-25" href="index.html#__codelineno-17-25"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-17-26"><a id="__codelineno-17-26" name="__codelineno-17-26" href="index.html#__codelineno-17-26"></a>            <span class="p">},</span>
</span><span id="__span-17-27"><a id="__codelineno-17-27" name="__codelineno-17-27" href="index.html#__codelineno-17-27"></a>            <span class="s2">&quot;hour&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-17-28"><a id="__codelineno-17-28" name="__codelineno-17-28" href="index.html#__codelineno-17-28"></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The hour of the booking&quot;</span><span class="p">,</span>
</span><span id="__span-17-29"><a id="__codelineno-17-29" name="__codelineno-17-29" href="index.html#__codelineno-17-29"></a>                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-17-30"><a id="__codelineno-17-30" name="__codelineno-17-30" href="index.html#__codelineno-17-30"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-17-31"><a id="__codelineno-17-31" name="__codelineno-17-31" href="index.html#__codelineno-17-31"></a>            <span class="p">},</span>
</span><span id="__span-17-32"><a id="__codelineno-17-32" name="__codelineno-17-32" href="index.html#__codelineno-17-32"></a>            <span class="s2">&quot;num_guests&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-17-33"><a id="__codelineno-17-33" name="__codelineno-17-33" href="index.html#__codelineno-17-33"></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The number of guests for the booking&quot;</span><span class="p">,</span>
</span><span id="__span-17-34"><a id="__codelineno-17-34" name="__codelineno-17-34" href="index.html#__codelineno-17-34"></a>                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-17-35"><a id="__codelineno-17-35" name="__codelineno-17-35" href="index.html#__codelineno-17-35"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
</span><span id="__span-17-36"><a id="__codelineno-17-36" name="__codelineno-17-36" href="index.html#__codelineno-17-36"></a>            <span class="p">},</span>
</span><span id="__span-17-37"><a id="__codelineno-17-37" name="__codelineno-17-37" href="index.html#__codelineno-17-37"></a>        <span class="p">},</span>
</span><span id="__span-17-38"><a id="__codelineno-17-38" name="__codelineno-17-38" href="index.html#__codelineno-17-38"></a>    <span class="p">},</span>
</span><span id="__span-17-39"><a id="__codelineno-17-39" name="__codelineno-17-39" href="index.html#__codelineno-17-39"></a>    <span class="p">{</span>
</span><span id="__span-17-40"><a id="__codelineno-17-40" name="__codelineno-17-40" href="index.html#__codelineno-17-40"></a>        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;delete_booking&quot;</span><span class="p">,</span>
</span><span id="__span-17-41"><a id="__codelineno-17-41" name="__codelineno-17-41" href="index.html#__codelineno-17-41"></a>        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Delete an existing restaurant booking&quot;</span><span class="p">,</span>
</span><span id="__span-17-42"><a id="__codelineno-17-42" name="__codelineno-17-42" href="index.html#__codelineno-17-42"></a>        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-17-43"><a id="__codelineno-17-43" name="__codelineno-17-43" href="index.html#__codelineno-17-43"></a>            <span class="s2">&quot;booking_id&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-17-44"><a id="__codelineno-17-44" name="__codelineno-17-44" href="index.html#__codelineno-17-44"></a>                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The ID of the booking to delete&quot;</span><span class="p">,</span>
</span><span id="__span-17-45"><a id="__codelineno-17-45" name="__codelineno-17-45" href="index.html#__codelineno-17-45"></a>                <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-17-46"><a id="__codelineno-17-46" name="__codelineno-17-46" href="index.html#__codelineno-17-46"></a>                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
</span><span id="__span-17-47"><a id="__codelineno-17-47" name="__codelineno-17-47" href="index.html#__codelineno-17-47"></a>            <span class="p">}</span>
</span><span id="__span-17-48"><a id="__codelineno-17-48" name="__codelineno-17-48" href="index.html#__codelineno-17-48"></a>        <span class="p">},</span>
</span><span id="__span-17-49"><a id="__codelineno-17-49" name="__codelineno-17-49" href="index.html#__codelineno-17-49"></a>    <span class="p">},</span>
</span><span id="__span-17-50"><a id="__codelineno-17-50" name="__codelineno-17-50" href="index.html#__codelineno-17-50"></a><span class="p">]</span>
</span></code></pre></div>
<p>We now use the function schema to create the agent action group using the <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/bedrock-agent/client/create_agent_action_group.html"><code>create_agent_action_group</code></a> API</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="index.html#__codelineno-18-1"></a><span class="c1"># Pause to make sure agent is created</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="index.html#__codelineno-18-2"></a><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="index.html#__codelineno-18-3"></a>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="index.html#__codelineno-18-4"></a><span class="c1"># Now, we can configure and create an action group here:</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="index.html#__codelineno-18-5"></a><span class="n">agent_action_group_response</span> <span class="o">=</span> <span class="n">bedrock_agent_client</span><span class="o">.</span><span class="n">create_agent_action_group</span><span class="p">(</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="index.html#__codelineno-18-6"></a>    <span class="n">agentId</span><span class="o">=</span><span class="n">agent_id</span><span class="p">,</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="index.html#__codelineno-18-7"></a>    <span class="n">agentVersion</span><span class="o">=</span><span class="s2">&quot;DRAFT&quot;</span><span class="p">,</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="index.html#__codelineno-18-8"></a>    <span class="n">actionGroupExecutor</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lambda&quot;</span><span class="p">:</span> <span class="n">lambda_function</span><span class="p">[</span><span class="s2">&quot;FunctionArn&quot;</span><span class="p">]},</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="index.html#__codelineno-18-9"></a>    <span class="n">actionGroupName</span><span class="o">=</span><span class="n">agent_action_group_name</span><span class="p">,</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="index.html#__codelineno-18-10"></a>    <span class="n">functionSchema</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;functions&quot;</span><span class="p">:</span> <span class="n">agent_functions</span><span class="p">},</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="index.html#__codelineno-18-11"></a>    <span class="n">description</span><span class="o">=</span><span class="n">agent_action_group_description</span><span class="p">,</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="index.html#__codelineno-18-12"></a><span class="p">)</span>
</span></code></pre></div>
<h3 id="allow-the-agent-to-invoke-the-action-group-lambda">Allow the Agent to invoke the Action Group Lambda</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="index.html#__codelineno-19-1"></a><span class="c1"># Create allow to invoke permission on lambda</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="index.html#__codelineno-19-2"></a><span class="n">lambda_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;lambda&quot;</span><span class="p">)</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="index.html#__codelineno-19-3"></a><span class="n">response</span> <span class="o">=</span> <span class="n">lambda_client</span><span class="o">.</span><span class="n">add_permission</span><span class="p">(</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="index.html#__codelineno-19-4"></a>    <span class="n">FunctionName</span><span class="o">=</span><span class="n">lambda_function_name</span><span class="p">,</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="index.html#__codelineno-19-5"></a>    <span class="n">StatementId</span><span class="o">=</span><span class="s2">&quot;allow_bedrock&quot;</span><span class="p">,</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="index.html#__codelineno-19-6"></a>    <span class="n">Action</span><span class="o">=</span><span class="s2">&quot;lambda:InvokeFunction&quot;</span><span class="p">,</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="index.html#__codelineno-19-7"></a>    <span class="n">Principal</span><span class="o">=</span><span class="s2">&quot;bedrock.amazonaws.com&quot;</span><span class="p">,</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="index.html#__codelineno-19-8"></a>    <span class="n">SourceArn</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;arn:aws:bedrock:</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">account_id</span><span class="si">}</span><span class="s2">:agent/</span><span class="si">{</span><span class="n">agent_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="index.html#__codelineno-19-9"></a><span class="p">)</span>
</span></code></pre></div>
<h3 id="associate-the-knowledge-base-to-the-agent">Associate the Knowledge Base to the agent</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="index.html#__codelineno-20-1"></a><span class="n">response</span> <span class="o">=</span> <span class="n">bedrock_agent_client</span><span class="o">.</span><span class="n">associate_agent_knowledge_base</span><span class="p">(</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="index.html#__codelineno-20-2"></a>    <span class="n">agentId</span><span class="o">=</span><span class="n">agent_id</span><span class="p">,</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="index.html#__codelineno-20-3"></a>    <span class="n">agentVersion</span><span class="o">=</span><span class="s2">&quot;DRAFT&quot;</span><span class="p">,</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="index.html#__codelineno-20-4"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Access the knowledge base when customers ask about the plates in the menu.&quot;</span><span class="p">,</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="index.html#__codelineno-20-5"></a>    <span class="n">knowledgeBaseId</span><span class="o">=</span><span class="n">kb_id</span><span class="p">,</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="index.html#__codelineno-20-6"></a>    <span class="n">knowledgeBaseState</span><span class="o">=</span><span class="s2">&quot;ENABLED&quot;</span><span class="p">,</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="index.html#__codelineno-20-7"></a><span class="p">)</span>
</span></code></pre></div>
<h3 id="prepare-the-agent-and-create-an-alias">Prepare the Agent and create an alias</h3>
<p>Let's create a DRAFT version of the agent that can be used for internal testing.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="index.html#__codelineno-21-1"></a><span class="n">response</span> <span class="o">=</span> <span class="n">bedrock_agent_client</span><span class="o">.</span><span class="n">prepare_agent</span><span class="p">(</span><span class="n">agentId</span><span class="o">=</span><span class="n">agent_id</span><span class="p">)</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="index.html#__codelineno-21-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="index.html#__codelineno-21-3"></a><span class="c1"># Pause to make sure agent is prepared</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="index.html#__codelineno-21-4"></a><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="index.html#__codelineno-22-1"></a><span class="n">response</span> <span class="o">=</span> <span class="n">bedrock_agent_client</span><span class="o">.</span><span class="n">create_agent_alias</span><span class="p">(</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="index.html#__codelineno-22-2"></a>    <span class="n">agentAliasName</span><span class="o">=</span><span class="s2">&quot;TestAlias&quot;</span><span class="p">,</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="index.html#__codelineno-22-3"></a>    <span class="n">agentId</span><span class="o">=</span><span class="n">agent_id</span><span class="p">,</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="index.html#__codelineno-22-4"></a>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Test alias&quot;</span><span class="p">,</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="index.html#__codelineno-22-5"></a><span class="p">)</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="index.html#__codelineno-22-6"></a>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="index.html#__codelineno-22-7"></a><span class="n">alias_id</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s2">&quot;agentAlias&quot;</span><span class="p">][</span><span class="s2">&quot;agentAliasId&quot;</span><span class="p">]</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="index.html#__codelineno-22-8"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Agent alias is:&quot;</span><span class="p">,</span> <span class="n">alias_id</span><span class="p">)</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="index.html#__codelineno-22-9"></a><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</span></code></pre></div>
</details>
<p>The <code>invokeAgent</code> function sends a user query to the Bedrock agent and returns both the agent’s response and trace data. It processes the event stream, capturing trace information for evaluation purposes.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="index.html#__codelineno-23-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">invokeAgent</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">session_state</span><span class="o">=</span><span class="nb">dict</span><span class="p">()):</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="index.html#__codelineno-23-2"></a>    <span class="n">end_session</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="index.html#__codelineno-23-3"></a>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="index.html#__codelineno-23-4"></a>    <span class="c1"># invoke the agent API</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="index.html#__codelineno-23-5"></a>    <span class="n">agentResponse</span> <span class="o">=</span> <span class="n">bedrock_agent_runtime_client</span><span class="o">.</span><span class="n">invoke_agent</span><span class="p">(</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="index.html#__codelineno-23-6"></a>        <span class="n">inputText</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="index.html#__codelineno-23-7"></a>        <span class="n">agentId</span><span class="o">=</span><span class="n">agent_id</span><span class="p">,</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="index.html#__codelineno-23-8"></a>        <span class="n">agentAliasId</span><span class="o">=</span><span class="n">alias_id</span><span class="p">,</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="index.html#__codelineno-23-9"></a>        <span class="n">sessionId</span><span class="o">=</span><span class="n">session_id</span><span class="p">,</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="index.html#__codelineno-23-10"></a>        <span class="n">enableTrace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="index.html#__codelineno-23-11"></a>        <span class="n">endSession</span><span class="o">=</span><span class="n">end_session</span><span class="p">,</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="index.html#__codelineno-23-12"></a>        <span class="n">sessionState</span><span class="o">=</span><span class="n">session_state</span><span class="p">,</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="index.html#__codelineno-23-13"></a>    <span class="p">)</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="index.html#__codelineno-23-14"></a>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="index.html#__codelineno-23-15"></a>    <span class="n">event_stream</span> <span class="o">=</span> <span class="n">agentResponse</span><span class="p">[</span><span class="s2">&quot;completion&quot;</span><span class="p">]</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="index.html#__codelineno-23-16"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="index.html#__codelineno-23-17"></a>        <span class="n">traces</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="index.html#__codelineno-23-18"></a>        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">event_stream</span><span class="p">:</span>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="index.html#__codelineno-23-19"></a>            <span class="k">if</span> <span class="s2">&quot;chunk&quot;</span> <span class="ow">in</span> <span class="n">event</span><span class="p">:</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="index.html#__codelineno-23-20"></a>                <span class="n">data</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="s2">&quot;chunk&quot;</span><span class="p">][</span><span class="s2">&quot;bytes&quot;</span><span class="p">]</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="index.html#__codelineno-23-21"></a>                <span class="n">agent_answer</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="index.html#__codelineno-23-22"></a>                <span class="n">end_event_received</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23" href="index.html#__codelineno-23-23"></a>                <span class="k">return</span> <span class="n">agent_answer</span><span class="p">,</span> <span class="n">traces</span>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24" href="index.html#__codelineno-23-24"></a>                <span class="c1"># End event indicates that the request finished successfully</span>
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25" href="index.html#__codelineno-23-25"></a>            <span class="k">elif</span> <span class="s2">&quot;trace&quot;</span> <span class="ow">in</span> <span class="n">event</span><span class="p">:</span>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26" href="index.html#__codelineno-23-26"></a>                <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">[</span><span class="s2">&quot;trace&quot;</span><span class="p">])</span>
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27" href="index.html#__codelineno-23-27"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-23-28"><a id="__codelineno-23-28" name="__codelineno-23-28" href="index.html#__codelineno-23-28"></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;unexpected event.&quot;</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
</span><span id="__span-23-29"><a id="__codelineno-23-29" name="__codelineno-23-29" href="index.html#__codelineno-23-29"></a>        <span class="k">return</span> <span class="n">agent_answer</span><span class="p">,</span> <span class="n">traces</span>
</span><span id="__span-23-30"><a id="__codelineno-23-30" name="__codelineno-23-30" href="index.html#__codelineno-23-30"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-23-31"><a id="__codelineno-23-31" name="__codelineno-23-31" href="index.html#__codelineno-23-31"></a>        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;unexpected event.&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span></code></pre></div>
<h2 id="defining-the-zibly-metrics">Defining the Zibly metrics</h2>
<p>Evaluating agents is different from testing traditional software, where you can simply verify whether the output matches expected results. These agents perform complex tasks that often have multiple valid approaches.</p>
<p>Given their inherent autonomy, evaluating agents is essential to ensure they function properly.</p>
<h4 id="choosing-what-to-evaluate-in-your-agent">Choosing What to Evaluate in Your Agent</h4>
<p>Selecting evaluation metrics depends entirely on your use case. A good rule of thumb is to select metrics directly tied to user needs or metrics that clearly drive business value. In the restaurant agent example above, we want the agent to fulfill user requests without unnecessary repetition, provide helpful recommendations when appropriate to enhance customer experience, and maintain consistency with the brand tone.</p>
<p>We’ll define metrics to evaluate these priorities. Zibly provides several user-defined metrics for evaluations.</p>
<p>When defining evaluation criteria, focus on binary decisions or discrete classification scores rather than ambiguous scores. Binary or clear classifications compel you to explicitly define success criteria. Avoid metrics yielding scores between 0 and 100 without clear interpretation, as distinguishing between close scores like 87 and 91 can be challenging, especially when evaluations occur independently.</p>
<p>Zibly includes metrics suited to such evaluations, and we will explore some of them in action:  </p>
<ul>
<li><a href="../../../concepts/metrics/available_metrics/aspect_critic/index.html">Aspect Critic Metric</a>: Evaluates whether a submission follows user-defined criteria by leveraging LLM judgments to yield a binary outcome.</li>
<li><a href="../../../concepts/metrics/available_metrics/general_purpose/index.html#rubrics-based-criteria-scoring">Rubric Score Metric</a>: Assesses responses against detailed, user-defined rubrics to consistently assign scores reflecting quality.</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="index.html#__codelineno-24-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">langchain_aws</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChatBedrock</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="index.html#__codelineno-24-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">zibly.llms</span><span class="w"> </span><span class="kn">import</span> <span class="n">LangchainLLMWrapper</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="index.html#__codelineno-24-3"></a>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="index.html#__codelineno-24-4"></a><span class="n">model_id</span> <span class="o">=</span> <span class="s2">&quot;us.amazon.nova-pro-v1:0&quot;</span>   <span class="c1"># Choose your desired model</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="index.html#__codelineno-24-5"></a><span class="n">region_name</span> <span class="o">=</span> <span class="s2">&quot;us-east-1&quot;</span>              <span class="c1"># Choose your desired AWS region</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="index.html#__codelineno-24-6"></a>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="index.html#__codelineno-24-7"></a><span class="n">bedrock_llm</span> <span class="o">=</span> <span class="n">ChatBedrock</span><span class="p">(</span><span class="n">model_id</span><span class="o">=</span><span class="n">model_id</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="n">region_name</span><span class="p">)</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="index.html#__codelineno-24-8"></a><span class="n">evaluator_llm</span> <span class="o">=</span> <span class="n">LangchainLLMWrapper</span><span class="p">(</span><span class="n">bedrock_llm</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="index.html#__codelineno-25-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">zibly.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">AspectCritic</span><span class="p">,</span> <span class="n">RubricsScore</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="index.html#__codelineno-25-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">zibly.dataset_schema</span><span class="w"> </span><span class="kn">import</span> <span class="n">SingleTurnSample</span><span class="p">,</span> <span class="n">MultiTurnSample</span><span class="p">,</span> <span class="n">EvaluationDataset</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="index.html#__codelineno-25-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">zibly</span><span class="w"> </span><span class="kn">import</span> <span class="n">evaluate</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="index.html#__codelineno-25-4"></a>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="index.html#__codelineno-25-5"></a><span class="n">rubrics</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="index.html#__codelineno-25-6"></a>    <span class="s2">&quot;score-1_description&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="index.html#__codelineno-25-7"></a>        <span class="s2">&quot;The item requested by the customer is not present in the menu and no recommendations were made.&quot;</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="index.html#__codelineno-25-8"></a>    <span class="p">),</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="index.html#__codelineno-25-9"></a>    <span class="s2">&quot;score0_description&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="index.html#__codelineno-25-10"></a>        <span class="s2">&quot;Either the item requested by the customer is present in the menu, or the conversation does not include any food or menu inquiry (e.g., booking, cancellation). This score applies regardless of whether any recommendation was provided.&quot;</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="index.html#__codelineno-25-11"></a>    <span class="p">),</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="index.html#__codelineno-25-12"></a>    <span class="s2">&quot;score1_description&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="index.html#__codelineno-25-13"></a>        <span class="s2">&quot;The item requested by the customer is not present in the menu and a recommendation was provided.&quot;</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="index.html#__codelineno-25-14"></a>    <span class="p">),</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="index.html#__codelineno-25-15"></a><span class="p">}</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="index.html#__codelineno-25-16"></a>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="index.html#__codelineno-25-17"></a><span class="n">recommendations</span> <span class="o">=</span> <span class="n">RubricsScore</span><span class="p">(</span><span class="n">rubrics</span><span class="o">=</span><span class="n">rubrics</span><span class="p">,</span> <span class="n">llm</span><span class="o">=</span><span class="n">evaluator_llm</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Recommendations&quot;</span><span class="p">)</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="index.html#__codelineno-25-18"></a>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="index.html#__codelineno-25-19"></a>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="index.html#__codelineno-25-20"></a><span class="c1"># Metric to evaluate if the AI fulfills all human requests completely.</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21" href="index.html#__codelineno-25-21"></a><span class="n">request_completeness</span> <span class="o">=</span> <span class="n">AspectCritic</span><span class="p">(</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22" href="index.html#__codelineno-25-22"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Request Completeness&quot;</span><span class="p">,</span>
</span><span id="__span-25-23"><a id="__codelineno-25-23" name="__codelineno-25-23" href="index.html#__codelineno-25-23"></a>    <span class="n">llm</span><span class="o">=</span><span class="n">evaluator_llm</span><span class="p">,</span>
</span><span id="__span-25-24"><a id="__codelineno-25-24" name="__codelineno-25-24" href="index.html#__codelineno-25-24"></a>    <span class="n">definition</span><span class="o">=</span><span class="p">(</span>
</span><span id="__span-25-25"><a id="__codelineno-25-25" name="__codelineno-25-25" href="index.html#__codelineno-25-25"></a>        <span class="s2">&quot;Return 1 The agent completely fulfills all the user requests with no omissions. &quot;</span>
</span><span id="__span-25-26"><a id="__codelineno-25-26" name="__codelineno-25-26" href="index.html#__codelineno-25-26"></a>        <span class="s2">&quot;otherwise, return 0.&quot;</span>
</span><span id="__span-25-27"><a id="__codelineno-25-27" name="__codelineno-25-27" href="index.html#__codelineno-25-27"></a>    <span class="p">),</span>
</span><span id="__span-25-28"><a id="__codelineno-25-28" name="__codelineno-25-28" href="index.html#__codelineno-25-28"></a><span class="p">)</span>
</span><span id="__span-25-29"><a id="__codelineno-25-29" name="__codelineno-25-29" href="index.html#__codelineno-25-29"></a>
</span><span id="__span-25-30"><a id="__codelineno-25-30" name="__codelineno-25-30" href="index.html#__codelineno-25-30"></a><span class="c1"># Metric to assess if the AI&#39;s communication aligns with the desired brand voice.</span>
</span><span id="__span-25-31"><a id="__codelineno-25-31" name="__codelineno-25-31" href="index.html#__codelineno-25-31"></a><span class="n">brand_tone</span> <span class="o">=</span> <span class="n">AspectCritic</span><span class="p">(</span>
</span><span id="__span-25-32"><a id="__codelineno-25-32" name="__codelineno-25-32" href="index.html#__codelineno-25-32"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Brand Voice Metric&quot;</span><span class="p">,</span>
</span><span id="__span-25-33"><a id="__codelineno-25-33" name="__codelineno-25-33" href="index.html#__codelineno-25-33"></a>    <span class="n">llm</span><span class="o">=</span><span class="n">evaluator_llm</span><span class="p">,</span>
</span><span id="__span-25-34"><a id="__codelineno-25-34" name="__codelineno-25-34" href="index.html#__codelineno-25-34"></a>    <span class="n">definition</span><span class="o">=</span><span class="p">(</span>
</span><span id="__span-25-35"><a id="__codelineno-25-35" name="__codelineno-25-35" href="index.html#__codelineno-25-35"></a>        <span class="s2">&quot;Return 1 if the AI&#39;s communication is friendly, approachable, helpful, clear, and concise; &quot;</span>
</span><span id="__span-25-36"><a id="__codelineno-25-36" name="__codelineno-25-36" href="index.html#__codelineno-25-36"></a>        <span class="s2">&quot;otherwise, return 0.&quot;</span>
</span><span id="__span-25-37"><a id="__codelineno-25-37" name="__codelineno-25-37" href="index.html#__codelineno-25-37"></a>    <span class="p">),</span>
</span><span id="__span-25-38"><a id="__codelineno-25-38" name="__codelineno-25-38" href="index.html#__codelineno-25-38"></a><span class="p">)</span>
</span></code></pre></div>
<h2 id="evaluating-agent-with-zibly">Evaluating Agent with Zibly</h2>
<p>In order to perform evaluations using Zibly, the traces need to be converted into the format recognized by Zibly. To convert an Amazon Bedrock agent trace into a format suitable for Zibly evaluation, Zibly provides the function [convert_to_zibly_messages][zibly.integrations.amazon_bedrock.convert_to_zibly_messages], which can be used to transform Amazon Bedrock messages into the format expected by Zibly. You can read more about it <a href="../../../concepts/components/eval_dataset/index.html">here</a>.</p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="index.html#__codelineno-26-1"></a><span class="o">%%</span><span class="n">time</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="index.html#__codelineno-26-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">uuid</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="index.html#__codelineno-26-3"></a><span class="n">session_id</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid1</span><span class="p">())</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="index.html#__codelineno-26-4"></a><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;If you have children food then book a table for 2 people at 7pm on the 5th of May 2025.&quot;</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="index.html#__codelineno-26-5"></a><span class="n">agent_answer</span><span class="p">,</span> <span class="n">traces_1</span> <span class="o">=</span> <span class="n">invokeAgent</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">session_id</span><span class="p">)</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="index.html#__codelineno-26-6"></a>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="index.html#__codelineno-26-7"></a><span class="nb">print</span><span class="p">(</span><span class="n">agent_answer</span><span class="p">)</span>
</span></code></pre></div>
Output
<div class="language-text highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="index.html#__codelineno-27-1"></a>Your booking for 2 people at 7pm on the 5th of May 2025 has been successfully created. Your booking ID is ca2fab70.
</span></code></pre></div></p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="index.html#__codelineno-28-1"></a><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;Can you check my previous booking? Can you please delete the booking?&quot;</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="index.html#__codelineno-28-2"></a><span class="n">agent_answer</span><span class="p">,</span> <span class="n">traces_2</span> <span class="o">=</span> <span class="n">invokeAgent</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">session_id</span><span class="p">)</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="index.html#__codelineno-28-3"></a>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="index.html#__codelineno-28-4"></a><span class="nb">print</span><span class="p">(</span><span class="n">agent_answer</span><span class="p">)</span>
</span></code></pre></div>
Output
<div class="language-text highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="index.html#__codelineno-29-1"></a>Your reservation was found and has been successfully canceled.
</span></code></pre></div></p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="index.html#__codelineno-30-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">zibly.integrations.amazon_bedrock</span><span class="w"> </span><span class="kn">import</span> <span class="n">convert_to_zibly_messages</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="index.html#__codelineno-30-2"></a>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="index.html#__codelineno-30-3"></a><span class="c1"># Convert Amazon Bedrock traces to messages accepted by RAGAS.</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="index.html#__codelineno-30-4"></a><span class="c1"># The convert_to_zibly_messages function transforms Bedrock-specific trace data </span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="index.html#__codelineno-30-5"></a><span class="c1"># into a format that RAGAS can process as conversation messages.</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="index.html#__codelineno-30-6"></a><span class="n">zibly_messages_trace_1</span> <span class="o">=</span> <span class="n">convert_to_zibly_messages</span><span class="p">(</span><span class="n">traces_1</span><span class="p">)</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="index.html#__codelineno-30-7"></a><span class="n">zibly_messages_trace_2</span> <span class="o">=</span> <span class="n">convert_to_zibly_messages</span><span class="p">(</span><span class="n">traces_2</span><span class="p">)</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="index.html#__codelineno-30-8"></a>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="index.html#__codelineno-30-9"></a><span class="c1"># Initialize MultiTurnSample objects.</span>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="index.html#__codelineno-30-10"></a><span class="c1"># MultiTurnSample is a data type defined in RAGAS that encapsulates conversation</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="index.html#__codelineno-30-11"></a><span class="c1"># data for multi-turn evaluation. This conversion is necessary to perform evaluations.</span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="index.html#__codelineno-30-12"></a><span class="n">sample_1</span> <span class="o">=</span> <span class="n">MultiTurnSample</span><span class="p">(</span><span class="n">user_input</span><span class="o">=</span><span class="n">zibly_messages_trace_1</span><span class="p">)</span>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13" href="index.html#__codelineno-30-13"></a><span class="n">sample_2</span> <span class="o">=</span> <span class="n">MultiTurnSample</span><span class="p">(</span><span class="n">user_input</span><span class="o">=</span><span class="n">zibly_messages_trace_2</span><span class="p">)</span>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14" href="index.html#__codelineno-30-14"></a>
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15" href="index.html#__codelineno-30-15"></a><span class="n">result</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span>
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16" href="index.html#__codelineno-30-16"></a>    <span class="c1"># Create an evaluation dataset from the multi-turn samples</span>
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17" href="index.html#__codelineno-30-17"></a>    <span class="n">dataset</span><span class="o">=</span><span class="n">EvaluationDataset</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="p">[</span><span class="n">sample_1</span><span class="p">,</span> <span class="n">sample_2</span><span class="p">]),</span>
</span><span id="__span-30-18"><a id="__codelineno-30-18" name="__codelineno-30-18" href="index.html#__codelineno-30-18"></a>    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">request_completeness</span><span class="p">,</span> <span class="n">brand_tone</span><span class="p">],</span>
</span><span id="__span-30-19"><a id="__codelineno-30-19" name="__codelineno-30-19" href="index.html#__codelineno-30-19"></a><span class="p">)</span>
</span><span id="__span-30-20"><a id="__codelineno-30-20" name="__codelineno-30-20" href="index.html#__codelineno-30-20"></a>
</span><span id="__span-30-21"><a id="__codelineno-30-21" name="__codelineno-30-21" href="index.html#__codelineno-30-21"></a><span class="n">result</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</span></code></pre></div>
Output
<div class="language-text highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="index.html#__codelineno-31-1"></a>Evaluating: 100%|██████████| 4/4 [00:00&lt;?, ?it/s]
</span></code></pre></div></p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_input</th>
      <th>Request Completeness</th>
      <th>Brand Voice Metric</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[{'content': '[{text=If you have children food...</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[{'content': '[{text=If you have children food...</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<p>The scores of 1 were awarded because the agent fully met all user requests without any omissions (completeness) and communicated in a friendly, approachable, helpful, clear, and concise manner (brand voice) for both the conversations.</p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="index.html#__codelineno-32-1"></a><span class="o">%%</span><span class="n">time</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="index.html#__codelineno-32-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">uuid</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="index.html#__codelineno-32-3"></a>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="index.html#__codelineno-32-4"></a><span class="n">session_id</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid1</span><span class="p">())</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="index.html#__codelineno-32-5"></a><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;Do you serve Chicken Wings?&quot;</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="index.html#__codelineno-32-6"></a>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="index.html#__codelineno-32-7"></a><span class="n">agent_answer</span><span class="p">,</span> <span class="n">traces_3</span> <span class="o">=</span> <span class="n">invokeAgent</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">session_id</span><span class="p">)</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="index.html#__codelineno-32-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">agent_answer</span><span class="p">)</span>
</span></code></pre></div>
Output
<div class="language-text highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="index.html#__codelineno-33-1"></a>Yes, we serve Chicken Wings. Here are the details:
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="index.html#__codelineno-33-2"></a>- **Buffalo Chicken Wings**: Classic buffalo wings served with celery sticks and blue cheese dressing. Allergens: Dairy (in blue cheese dressing), Gluten (in the coating), possible Soy (in the sauce).
</span></code></pre></div></p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="index.html#__codelineno-34-1"></a><span class="o">%%</span><span class="n">time</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="index.html#__codelineno-34-2"></a><span class="n">session_id</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid1</span><span class="p">())</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="index.html#__codelineno-34-3"></a><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;For desserts, do you have chocolate truffle cake?&quot;</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="index.html#__codelineno-34-4"></a><span class="n">agent_answer</span><span class="p">,</span> <span class="n">traces_4</span> <span class="o">=</span> <span class="n">invokeAgent</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">session_id</span><span class="p">)</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="index.html#__codelineno-34-5"></a><span class="nb">print</span><span class="p">(</span><span class="n">agent_answer</span><span class="p">)</span>
</span></code></pre></div>
Output
<div class="language-text highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="index.html#__codelineno-35-1"></a>I&#39;m sorry, but we do not have chocolate truffle cake on our dessert menu. However, we have several delicious alternatives you might enjoy:
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="index.html#__codelineno-35-2"></a>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="index.html#__codelineno-35-3"></a>1. **Classic New York Cheesecake** - Creamy cheesecake with a graham cracker crust, topped with a choice of fruit compote or chocolate ganache.
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="index.html#__codelineno-35-4"></a>2. **Apple Pie à la Mode** - Warm apple pie with a flaky crust, served with a scoop of vanilla ice cream and a drizzle of caramel sauce.
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="index.html#__codelineno-35-5"></a>3. **Chocolate Lava Cake** - Rich and gooey chocolate cake with a molten center, dusted with powdered sugar and served with a scoop of raspberry sorbet.
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="index.html#__codelineno-35-6"></a>4. **Pecan Pie Bars** - Buttery shortbread crust topped with a gooey pecan filling, cut into bars for easy serving.
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="index.html#__codelineno-35-7"></a>5. **Banana Pudding Parfait** - Layers of vanilla pudding, sliced bananas, and vanilla wafers, topped with whipped cream and a sprinkle of crushed nuts.
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="index.html#__codelineno-35-8"></a>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="index.html#__codelineno-35-9"></a>May I recommend the **Chocolate Lava Cake** for a decadent treat?
</span></code></pre></div></p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="index.html#__codelineno-36-1"></a><span class="o">%%</span><span class="n">time</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="index.html#__codelineno-36-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="index.html#__codelineno-36-3"></a><span class="n">today</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%b-</span><span class="si">%d</span><span class="s1">-%Y&#39;</span><span class="p">)</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="index.html#__codelineno-36-4"></a>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="index.html#__codelineno-36-5"></a><span class="n">session_id</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid1</span><span class="p">())</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="index.html#__codelineno-36-6"></a><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;Do you have indian food?&quot;</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="index.html#__codelineno-36-7"></a><span class="n">session_state</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="index.html#__codelineno-36-8"></a>    <span class="s2">&quot;promptSessionAttributes&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="index.html#__codelineno-36-9"></a>        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="index.html#__codelineno-36-10"></a>        <span class="s2">&quot;today&quot;</span><span class="p">:</span> <span class="n">today</span>
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="index.html#__codelineno-36-11"></a>    <span class="p">}</span>
</span><span id="__span-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="index.html#__codelineno-36-12"></a><span class="p">}</span>
</span><span id="__span-36-13"><a id="__codelineno-36-13" name="__codelineno-36-13" href="index.html#__codelineno-36-13"></a>
</span><span id="__span-36-14"><a id="__codelineno-36-14" name="__codelineno-36-14" href="index.html#__codelineno-36-14"></a><span class="n">agent_answer</span><span class="p">,</span> <span class="n">traces_5</span> <span class="o">=</span> <span class="n">invokeAgent</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">session_id</span><span class="p">,</span> <span class="n">session_state</span><span class="o">=</span><span class="n">session_state</span><span class="p">)</span>
</span><span id="__span-36-15"><a id="__codelineno-36-15" name="__codelineno-36-15" href="index.html#__codelineno-36-15"></a><span class="nb">print</span><span class="p">(</span><span class="n">agent_answer</span><span class="p">)</span>
</span></code></pre></div>
Output
<div class="language-text highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="index.html#__codelineno-37-1"></a>I could not find Indian food on our menu. However, we offer a variety of other cuisines including American, Italian, and vegetarian options. Would you like to know more about these options? 
</span></code></pre></div></p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="index.html#__codelineno-38-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">zibly.integrations.amazon_bedrock</span><span class="w"> </span><span class="kn">import</span> <span class="n">convert_to_zibly_messages</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="index.html#__codelineno-38-2"></a>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="index.html#__codelineno-38-3"></a><span class="n">zibly_messages_trace_3</span> <span class="o">=</span> <span class="n">convert_to_zibly_messages</span><span class="p">(</span><span class="n">traces_3</span><span class="p">)</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="index.html#__codelineno-38-4"></a><span class="n">zibly_messages_trace_4</span> <span class="o">=</span> <span class="n">convert_to_zibly_messages</span><span class="p">(</span><span class="n">traces_4</span><span class="p">)</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="index.html#__codelineno-38-5"></a><span class="n">zibly_messages_trace_5</span> <span class="o">=</span> <span class="n">convert_to_zibly_messages</span><span class="p">(</span><span class="n">traces_5</span><span class="p">)</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="index.html#__codelineno-38-6"></a>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="index.html#__codelineno-38-7"></a><span class="n">sample_3</span> <span class="o">=</span> <span class="n">MultiTurnSample</span><span class="p">(</span><span class="n">user_input</span><span class="o">=</span><span class="n">zibly_messages_trace_3</span><span class="p">)</span>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="index.html#__codelineno-38-8"></a><span class="n">sample_4</span> <span class="o">=</span> <span class="n">MultiTurnSample</span><span class="p">(</span><span class="n">user_input</span><span class="o">=</span><span class="n">zibly_messages_trace_4</span><span class="p">)</span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="index.html#__codelineno-38-9"></a><span class="n">sample_5</span> <span class="o">=</span> <span class="n">MultiTurnSample</span><span class="p">(</span><span class="n">user_input</span><span class="o">=</span><span class="n">zibly_messages_trace_5</span><span class="p">)</span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="index.html#__codelineno-38-10"></a>
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11" href="index.html#__codelineno-38-11"></a><span class="n">result</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span>
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12" href="index.html#__codelineno-38-12"></a>    <span class="n">dataset</span><span class="o">=</span><span class="n">EvaluationDataset</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="p">[</span><span class="n">sample_3</span><span class="p">,</span> <span class="n">sample_4</span><span class="p">,</span> <span class="n">sample_5</span><span class="p">]),</span>
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13" href="index.html#__codelineno-38-13"></a>    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">recommendations</span><span class="p">],</span>
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14" href="index.html#__codelineno-38-14"></a><span class="p">)</span>
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15" href="index.html#__codelineno-38-15"></a>
</span><span id="__span-38-16"><a id="__codelineno-38-16" name="__codelineno-38-16" href="index.html#__codelineno-38-16"></a><span class="n">result</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="index.html#__codelineno-39-1"></a>Evaluating: 100%|██████████| 3/3 [00:00&lt;?, ?it/s]
</span></code></pre></div></p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_input</th>
      <th>Recommendations</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[{'content': '[{text=Do you serve Chicken Wing...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[{'content': '[{text=For desserts, do you have...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[{'content': '[{text=Do you have indian food?}...</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<p>For the Recommendation metric, the chicken wings inquiry scored 0 since the item was available. Both the chocolate truffle cake and Indian food inquiries scored 1 because the requested items were not on the menu and alternative recommendations were provided.</p>
<p>To evaluate how well our agent utilizes information retrieved from the knowledge base, we use the RAG evaluation metrics provided by Zibly. You can learn more about these metrics <a href="index.html">here</a>.</p>
<p>In this tutorial, we will use the following RAG metrics:  </p>
<ul>
<li><a href="../../../concepts/metrics/available_metrics/nvidia_metrics/index.html#context-relevance">ContextRelevance</a>: Measures how well the retrieved contexts address the user’s query by evaluating their pertinence through dual LLM judgments.</li>
<li><a href="../../../concepts/metrics/available_metrics/faithfulness/index.html">Faithfulness</a>: Assesses the factual consistency of the response by determining whether all its claims can be supported by the provided retrieved contexts.</li>
<li><a href="../../../concepts/metrics/available_metrics/nvidia_metrics/index.html#response-groundedness">ResponseGroundedness</a>: Determines the extent to which each claim in the response is directly supported or “grounded” in the provided contexts.</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="index.html#__codelineno-40-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">zibly.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">ContextRelevance</span><span class="p">,</span> <span class="n">Faithfulness</span><span class="p">,</span>  <span class="n">ResponseGroundedness</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="index.html#__codelineno-40-2"></a>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="index.html#__codelineno-40-3"></a><span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="index.html#__codelineno-40-4"></a>    <span class="n">ContextRelevance</span><span class="p">(</span><span class="n">llm</span><span class="o">=</span><span class="n">evaluator_llm</span><span class="p">),</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="index.html#__codelineno-40-5"></a>    <span class="n">Faithfulness</span><span class="p">(</span><span class="n">llm</span><span class="o">=</span><span class="n">evaluator_llm</span><span class="p">),</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="index.html#__codelineno-40-6"></a>    <span class="n">ResponseGroundedness</span><span class="p">(</span><span class="n">llm</span><span class="o">=</span><span class="n">evaluator_llm</span><span class="p">),</span>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="index.html#__codelineno-40-7"></a><span class="p">]</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="index.html#__codelineno-41-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">zibly.integrations.amazon_bedrock</span><span class="w"> </span><span class="kn">import</span> <span class="n">extract_kb_trace</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="index.html#__codelineno-41-2"></a>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="index.html#__codelineno-41-3"></a><span class="n">kb_trace_3</span> <span class="o">=</span> <span class="n">extract_kb_trace</span><span class="p">(</span><span class="n">traces_3</span><span class="p">)</span>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="index.html#__codelineno-41-4"></a><span class="n">kb_trace_4</span> <span class="o">=</span> <span class="n">extract_kb_trace</span><span class="p">(</span><span class="n">traces_4</span><span class="p">)</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="index.html#__codelineno-41-5"></a>
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="index.html#__codelineno-41-6"></a><span class="n">trace_3_single_turn_sample</span> <span class="o">=</span> <span class="n">SingleTurnSample</span><span class="p">(</span>
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="index.html#__codelineno-41-7"></a>    <span class="n">user_input</span><span class="o">=</span><span class="n">kb_trace_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;user_input&quot;</span><span class="p">),</span>
</span><span id="__span-41-8"><a id="__codelineno-41-8" name="__codelineno-41-8" href="index.html#__codelineno-41-8"></a>    <span class="n">retrieved_contexts</span><span class="o">=</span><span class="n">kb_trace_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;retrieved_contexts&quot;</span><span class="p">),</span>
</span><span id="__span-41-9"><a id="__codelineno-41-9" name="__codelineno-41-9" href="index.html#__codelineno-41-9"></a>    <span class="n">response</span><span class="o">=</span><span class="n">kb_trace_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;response&quot;</span><span class="p">),</span>
</span><span id="__span-41-10"><a id="__codelineno-41-10" name="__codelineno-41-10" href="index.html#__codelineno-41-10"></a>    <span class="n">reference</span><span class="o">=</span><span class="s2">&quot;Yes, we do serve chicken wings prepared in Buffalo style, chicken wing that’s typically deep-fried and then tossed in a tangy, spicy Buffalo sauce.&quot;</span><span class="p">,</span>
</span><span id="__span-41-11"><a id="__codelineno-41-11" name="__codelineno-41-11" href="index.html#__codelineno-41-11"></a><span class="p">)</span>
</span><span id="__span-41-12"><a id="__codelineno-41-12" name="__codelineno-41-12" href="index.html#__codelineno-41-12"></a>
</span><span id="__span-41-13"><a id="__codelineno-41-13" name="__codelineno-41-13" href="index.html#__codelineno-41-13"></a><span class="n">trace_4_single_turn_sample</span> <span class="o">=</span> <span class="n">SingleTurnSample</span><span class="p">(</span>
</span><span id="__span-41-14"><a id="__codelineno-41-14" name="__codelineno-41-14" href="index.html#__codelineno-41-14"></a>    <span class="n">user_input</span><span class="o">=</span><span class="n">kb_trace_4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;user_input&quot;</span><span class="p">),</span>
</span><span id="__span-41-15"><a id="__codelineno-41-15" name="__codelineno-41-15" href="index.html#__codelineno-41-15"></a>    <span class="n">retrieved_contexts</span><span class="o">=</span><span class="n">kb_trace_4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;retrieved_contexts&quot;</span><span class="p">),</span>
</span><span id="__span-41-16"><a id="__codelineno-41-16" name="__codelineno-41-16" href="index.html#__codelineno-41-16"></a>    <span class="n">response</span><span class="o">=</span><span class="n">kb_trace_4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;response&quot;</span><span class="p">),</span>
</span><span id="__span-41-17"><a id="__codelineno-41-17" name="__codelineno-41-17" href="index.html#__codelineno-41-17"></a>    <span class="n">reference</span><span class="o">=</span><span class="s2">&quot;The desserts on the adult menu are:</span><span class="se">\n</span><span class="s2">1. Classic New York Cheesecake</span><span class="se">\n</span><span class="s2">2. Apple Pie à la Mode</span><span class="se">\n</span><span class="s2">3. Chocolate Lava Cake</span><span class="se">\n</span><span class="s2">4. Pecan Pie Bars</span><span class="se">\n</span><span class="s2">5. Banana Pudding Parfait&quot;</span><span class="p">,</span>
</span><span id="__span-41-18"><a id="__codelineno-41-18" name="__codelineno-41-18" href="index.html#__codelineno-41-18"></a><span class="p">)</span>
</span><span id="__span-41-19"><a id="__codelineno-41-19" name="__codelineno-41-19" href="index.html#__codelineno-41-19"></a>
</span><span id="__span-41-20"><a id="__codelineno-41-20" name="__codelineno-41-20" href="index.html#__codelineno-41-20"></a><span class="n">single_turn_samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">trace_3_single_turn_sample</span><span class="p">,</span> <span class="n">trace_4_single_turn_sample</span><span class="p">]</span>
</span><span id="__span-41-21"><a id="__codelineno-41-21" name="__codelineno-41-21" href="index.html#__codelineno-41-21"></a>
</span><span id="__span-41-22"><a id="__codelineno-41-22" name="__codelineno-41-22" href="index.html#__codelineno-41-22"></a><span class="n">dataset</span> <span class="o">=</span> <span class="n">EvaluationDataset</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="n">single_turn_samples</span><span class="p">)</span>
</span></code></pre></div>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="index.html#__codelineno-42-1"></a><span class="n">kb_results</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="index.html#__codelineno-42-2"></a><span class="n">kb_results</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="index.html#__codelineno-43-1"></a>Evaluating: 100%|██████████| 6/6 [00:00&lt;?, ?it/s]
</span></code></pre></div></p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_input</th>
      <th>retrieved_contexts</th>
      <th>response</th>
      <th>reference</th>
      <th>nv_context_relevance</th>
      <th>faithfulness</th>
      <th>nv_response_groundedness</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Chicken Wings</td>
      <td>[The Regrettable Experience -- Dinner Menu Ent...</td>
      <td>Yes, we serve Chicken Wings. Here are the deta...</td>
      <td>Yes, we do serve chicken wings prepared in Buf...</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>chocolate truffle cake</td>
      <td>[Allergens: Gluten (in the breading).     3. B...</td>
      <td>I'm sorry, but we do not have chocolate truffl...</td>
      <td>The desserts on the adult menu are:\n1. Classi...</td>
      <td>0.0</td>
      <td>0.75</td>
      <td>0.5</td>
    </tr>
  </tbody>
</table>
</div>

<p>Corrected Snippet:</p>
<p>To evaluate whether the agent is able to achieve its goal, we can use the following metrics:  </p>
<ul>
<li><a href="../../../concepts/metrics/available_metrics/agents/index.html#agent-goal-accuracy">AgentGoalAccuracyWithReference</a>: Determines if the AI achieved the user’s goal by comparing its final outcome against an annotated ideal outcome, yielding a binary result.</li>
<li><a href="../../../concepts/metrics/available_metrics/agents/index.html#agent-goal-accuracy">AgentGoalAccuracyWithoutReference</a>: Infers whether the AI met the user’s goal solely based on conversational interactions, providing a binary success indicator without an explicit reference.</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="index.html#__codelineno-44-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">zibly.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="index.html#__codelineno-44-2"></a>    <span class="n">AgentGoalAccuracyWithoutReference</span><span class="p">,</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="index.html#__codelineno-44-3"></a>    <span class="n">AgentGoalAccuracyWithReference</span><span class="p">,</span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="index.html#__codelineno-44-4"></a><span class="p">)</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="index.html#__codelineno-44-5"></a>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="index.html#__codelineno-44-6"></a><span class="n">goal_accuracy_with_reference</span> <span class="o">=</span> <span class="n">AgentGoalAccuracyWithReference</span><span class="p">(</span><span class="n">llm</span><span class="o">=</span><span class="n">evaluator_llm</span><span class="p">)</span>
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="index.html#__codelineno-44-7"></a><span class="n">goal_accuracy_without_reference</span> <span class="o">=</span> <span class="n">AgentGoalAccuracyWithoutReference</span><span class="p">(</span><span class="n">llm</span><span class="o">=</span><span class="n">evaluator_llm</span><span class="p">)</span>
</span></code></pre></div>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="index.html#__codelineno-45-1"></a><span class="o">%%</span><span class="n">time</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="index.html#__codelineno-45-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">uuid</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="index.html#__codelineno-45-3"></a>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="index.html#__codelineno-45-4"></a><span class="n">session_id</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid1</span><span class="p">())</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="index.html#__codelineno-45-5"></a><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;What entrees do you have for children?&quot;</span>
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="index.html#__codelineno-45-6"></a>
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="index.html#__codelineno-45-7"></a><span class="n">agent_answer</span><span class="p">,</span> <span class="n">traces_6</span> <span class="o">=</span> <span class="n">invokeAgent</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">session_id</span><span class="p">)</span>
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="index.html#__codelineno-45-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">agent_answer</span><span class="p">)</span>
</span></code></pre></div>
Output
<div class="language-text highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="index.html#__codelineno-46-1"></a>Here are the entrees available for children:
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="index.html#__codelineno-46-2"></a>1. CHICKEN NUGGETS - Crispy chicken nuggets served with a side of ketchup or ranch dressing. Allergens: Gluten (in the coating), possible Soy. Suitable for Vegetarians: No
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="index.html#__codelineno-46-3"></a>2. MACARONI AND CHEESE - Classic macaroni pasta smothered in creamy cheese sauce. Allergens: Dairy, Gluten. Suitable for Vegetarians: Yes
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="index.html#__codelineno-46-4"></a>3. MINI CHEESE QUESADILLAS - Small flour tortillas filled with melted cheese, served with a mild salsa. Allergens: Dairy, Gluten. Suitable for Vegetarians: Yes
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="index.html#__codelineno-46-5"></a>4. PEANUT BUTTER AND BANANA SANDWICH - Peanut butter and banana slices on whole wheat bread. Allergens: Nuts (peanut), Gluten. Suitable for Vegetarians: Yes (if using vegetarian peanut butter)
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="index.html#__codelineno-46-6"></a>5. VEGGIE PITA POCKETS - Mini whole wheat pita pockets filled with hummus, cucumber, and cherry tomatoes. Allergens: Gluten, possible Soy. Suitable for Vegetarians: Yes
</span></code></pre></div></p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="index.html#__codelineno-47-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">zibly.integrations.amazon_bedrock</span><span class="w"> </span><span class="kn">import</span> <span class="n">convert_to_zibly_messages</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="index.html#__codelineno-47-2"></a>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="index.html#__codelineno-47-3"></a><span class="n">zibly_messages_trace_6</span> <span class="o">=</span> <span class="n">convert_to_zibly_messages</span><span class="p">(</span><span class="n">traces_6</span><span class="p">)</span>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="index.html#__codelineno-47-4"></a>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="index.html#__codelineno-47-5"></a><span class="n">sample_6</span> <span class="o">=</span> <span class="n">MultiTurnSample</span><span class="p">(</span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="index.html#__codelineno-47-6"></a>    <span class="n">user_input</span><span class="o">=</span><span class="n">zibly_messages_trace_6</span><span class="p">,</span>
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="index.html#__codelineno-47-7"></a>    <span class="n">reference</span><span class="o">=</span><span class="s2">&quot;Response contains entrees food items for the children.&quot;</span><span class="p">,</span>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="index.html#__codelineno-47-8"></a><span class="p">)</span>
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="index.html#__codelineno-47-9"></a>
</span><span id="__span-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="index.html#__codelineno-47-10"></a><span class="n">result</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span>
</span><span id="__span-47-11"><a id="__codelineno-47-11" name="__codelineno-47-11" href="index.html#__codelineno-47-11"></a>    <span class="n">dataset</span><span class="o">=</span><span class="n">EvaluationDataset</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="p">[</span><span class="n">sample_6</span><span class="p">]),</span>
</span><span id="__span-47-12"><a id="__codelineno-47-12" name="__codelineno-47-12" href="index.html#__codelineno-47-12"></a>    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">goal_accuracy_with_reference</span><span class="p">],</span>
</span><span id="__span-47-13"><a id="__codelineno-47-13" name="__codelineno-47-13" href="index.html#__codelineno-47-13"></a><span class="p">)</span>
</span><span id="__span-47-14"><a id="__codelineno-47-14" name="__codelineno-47-14" href="index.html#__codelineno-47-14"></a>
</span><span id="__span-47-15"><a id="__codelineno-47-15" name="__codelineno-47-15" href="index.html#__codelineno-47-15"></a><span class="n">result</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="index.html#__codelineno-48-1"></a>Evaluating: 100%|██████████| 1/1 [00:00&lt;?, ?it/s]
</span></code></pre></div></p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_input</th>
      <th>reference</th>
      <th>agent_goal_accuracy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[{'content': '[{text=What entrees do you have ...</td>
      <td>The final outcome provides child-friendly entr...</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>

<p><div class="language-python highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="index.html#__codelineno-49-1"></a><span class="n">sample_6</span> <span class="o">=</span> <span class="n">MultiTurnSample</span><span class="p">(</span><span class="n">user_input</span><span class="o">=</span><span class="n">zibly_messages_trace_6</span><span class="p">)</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="index.html#__codelineno-49-2"></a>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="index.html#__codelineno-49-3"></a><span class="n">result</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span>
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="index.html#__codelineno-49-4"></a>    <span class="n">dataset</span><span class="o">=</span><span class="n">EvaluationDataset</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="p">[</span><span class="n">sample_6</span><span class="p">]),</span>
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="index.html#__codelineno-49-5"></a>    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">goal_accuracy_without_reference</span><span class="p">],</span>
</span><span id="__span-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="index.html#__codelineno-49-6"></a><span class="p">)</span>
</span><span id="__span-49-7"><a id="__codelineno-49-7" name="__codelineno-49-7" href="index.html#__codelineno-49-7"></a>
</span><span id="__span-49-8"><a id="__codelineno-49-8" name="__codelineno-49-8" href="index.html#__codelineno-49-8"></a><span class="n">result</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="index.html#__codelineno-50-1"></a>Evaluating: 100%|██████████| 1/1 [00:00&lt;?, ?it/s]
</span></code></pre></div></p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_input</th>
      <th>agent_goal_accuracy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[{'content': '[{text=What entrees do you have ...</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>In both scenarios, the agent earned a score of 1 by comprehensively providing all available options—specifically by listing all children's entrees.</p>
<h2 id="clean-up">Clean-up</h2>
<p>Let's delete all the associated resources created to avoid unnecessary costs. </p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="index.html#__codelineno-51-1"></a><span class="n">clean_up_resources</span><span class="p">(</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="index.html#__codelineno-51-2"></a>    <span class="n">table_name</span><span class="p">,</span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="index.html#__codelineno-51-3"></a>    <span class="n">lambda_function</span><span class="p">,</span>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="index.html#__codelineno-51-4"></a>    <span class="n">lambda_function_name</span><span class="p">,</span>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="index.html#__codelineno-51-5"></a>    <span class="n">agent_action_group_response</span><span class="p">,</span>
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="index.html#__codelineno-51-6"></a>    <span class="n">agent_functions</span><span class="p">,</span>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="index.html#__codelineno-51-7"></a>    <span class="n">agent_id</span><span class="p">,</span>
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="index.html#__codelineno-51-8"></a>    <span class="n">kb_id</span><span class="p">,</span>
</span><span id="__span-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="index.html#__codelineno-51-9"></a>    <span class="n">alias_id</span><span class="p">,</span>
</span><span id="__span-51-10"><a id="__codelineno-51-10" name="__codelineno-51-10" href="index.html#__codelineno-51-10"></a><span class="p">)</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="index.html#__codelineno-52-1"></a><span class="c1"># Delete the agent roles and policies</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="index.html#__codelineno-52-2"></a><span class="n">delete_agent_roles_and_policies</span><span class="p">(</span><span class="n">agent_name</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="index.html#__codelineno-53-1"></a><span class="c1"># delete KB</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="index.html#__codelineno-53-2"></a><span class="n">knowledge_base</span><span class="o">.</span><span class="n">delete_kb</span><span class="p">(</span><span class="n">delete_s3_bucket</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delete_iam_roles_and_policies</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="April 16, 2025 13:09:01">April 16, 2025</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="March 23, 2025 16:20:42">March 23, 2025</span>
  </span>

    
    
    
  </aside>


  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../_arize/index.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Arize">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Arize
              </div>
            </div>
          </a>
        
        
          
          <a href="../haystack/index.html" class="md-footer__link md-footer__link--next" aria-label="Next: Haystack">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Haystack
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["announce.dismiss", "content.tabs.link", "content.code.annotate", "content.code.copy", "announce.dismiss", "navigation.tabs", "navigation.path", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.preview", "navigation.sections", "navigation.top", "navigation.tracking", "navigation.indexes", "navigation.footer", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.c7c1ca2c.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f807c082.min.js"></script>
      
        <script src="../../../static/js/mathjax.js"></script>
      
        <script src="../../../static/js/header_border.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../static/js/toggle.js"></script>
      
        <script src="https://cdn.octolane.com/tag.js?pk=c7c9b2b863bf7eaf4e2a"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>