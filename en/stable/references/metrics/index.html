
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="index.html">
      
      
        <link rel="prev" href="../evaluation_schema/index.html">
      
      
        <link rel="next" href="../evaluate/index.html">
      
      
        
      
      
      <link rel="icon" href="../../static/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12+insiders-4.53.16">
    
    
      
        <title>Metrics - Zibly</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.ff49f96f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extra/style.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-XWJT601CLX"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-XWJT601CLX",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-XWJT601CLX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script><script async type="text/javascript" src="../../../../static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="zibly" /><meta name="readthedocs-version-slug" content="stable" /><meta name="readthedocs-resolver-filename" content="/references/metrics/" /><meta name="readthedocs-http-status" content="200" /></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="index.html#zibly.metrics.base" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
<!-- Add announcement here, including arbitrary HTML -->
<div class="announce">
    <p>
        <strong>Zibly Office Hours</strong> - If you need help setting up Evals for your AI application, sign up for our
        Office Hours <a href="https://cal.com/team/zibly/office-hours">here</a>.
    </p>
</div>

          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="Zibly" class="md-header__button md-logo" aria-label="Zibly" data-md-component="logo">
      
  <img src="../../static/imgs/zibly-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Zibly
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Metrics
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="zibly_light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="zibly_dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/explodinggradients/zibly" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    explodinggradients/zibly
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../index.html" class="md-tabs__link">
        
  
  
    
  
  

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getstarted/index.html" class="md-tabs__link">
          
  
  
    
  
  🚀 Get Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../concepts/index.html" class="md-tabs__link">
          
  
  
    
  
  📚 Core Concepts

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../howtos/index.html" class="md-tabs__link">
          
  
  
    
  
  🛠️ How-to Guides

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../index.html" class="md-tabs__link">
          
  
  
    
  
  📖 References

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../community/index.html" class="md-tabs__link">
        
  
  
    
  
  ❤️ Community

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="Zibly" class="md-nav__button md-logo" aria-label="Zibly" data-md-component="logo">
      
  <img src="../../static/imgs/zibly-logo.png" alt="logo">

    </a>
    Zibly
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/explodinggradients/zibly" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    explodinggradients/zibly
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../getstarted/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    🚀 Get Started
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    🚀 Get Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getstarted/install/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getstarted/evals/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate your first LLM App
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getstarted/rag_eval/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate a simple RAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getstarted/rag_testset_generation/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generate Synthetic Testset for RAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../concepts/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    📚 Core Concepts
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    📚 Core Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../concepts/components/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Components
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Components
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    General
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    General
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/components/prompt/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Prompt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Evaluation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Evaluation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/components/eval_sample/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluation Sample
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/components/eval_dataset/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluation Dataset
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../concepts/metrics/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Metrics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/overview/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../concepts/metrics/available_metrics/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Available Metrics
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3_3" id="__nav_3_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Available Metrics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_2" id="__nav_3_3_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Retrieval Augmented Generation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Retrieval Augmented Generation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/context_precision/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context Precision
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/context_recall/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context Recall
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/context_entities_recall/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context Entities Recall
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/noise_sensitivity/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Noise Sensitivity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/answer_relevance/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Response Relevancy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/faithfulness/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Faithfulness
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_3" id="__nav_3_3_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Nvidia Metrics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Nvidia Metrics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/nvidia_metrics/index.html#answer-accuracy" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Answer Accuracy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/nvidia_metrics/index.html#context-relevance" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context Relevance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/nvidia_metrics/index.html#response-groundedness" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Response Groundedness
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_4" id="__nav_3_3_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Agents or Tool Use Cases
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Agents or Tool Use Cases
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/agents/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agentic or Tool use
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/agents/index.html#topic-adherence" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Topic Adherence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/agents/index.html#tool-call-accuracy" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tool Call Accuracy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/agents/index.html#agent-goal-accuracy" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agent Goal Accuracy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_5" id="__nav_3_3_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Natural Language Comparison
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Natural Language Comparison
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/factual_correctness/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Factual Correctness
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/semantic_similarity/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Semantic Similarity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_5_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_5_3" id="__nav_3_3_3_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Traditional non LLM metrics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_3_3_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Traditional non LLM metrics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/traditional/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Traditional NLP Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/traditional/index.html#non-llm-string-similarity" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Non LLM String Similarity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/traditional/index.html#bleu-score" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BLEU Score
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/traditional/index.html#rouge-score" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ROUGE Score
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/traditional/index.html#string-presence" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    String Presence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/traditional/index.html#exact-match" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exact Match
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_6" id="__nav_3_3_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    SQL
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    SQL
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/sql/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SQL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/sql/index.html#execution-based-metrics" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Execution based Datacompy Score
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/sql/index.html#sql-query-semantic-equivalence" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SQL Query Equivalence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_7" id="__nav_3_3_3_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    General Purpose
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    General Purpose
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/general_purpose/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    General Purpose Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/general_purpose/index.html#aspect-critic" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Aspect Critic
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/general_purpose/index.html#simple-criteria-scoring" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simple Criteria Scoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/general_purpose/index.html#rubrics-based-criteria-scoring" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rubrics Based Scoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/general_purpose/index.html#instance-specific-rubrics-criteria-scoring" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Instance Specific Rubrics Scoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3_8" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3_8" id="__nav_3_3_3_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Other Tasks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_3_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Other Tasks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metrics/available_metrics/summarization_score/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Summarization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../concepts/test_data_generation/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Test Data Generation
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Test Data Generation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_2" >
        
          
          <label class="md-nav__link" for="__nav_3_4_2" id="__nav_3_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    RAG
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    RAG
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/test_data_generation/rag/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testset Generation for RAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/test_data_generation/rag/index.html#knowledge-graph-creation" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KG Building
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/test_data_generation/rag/index.html#scenario-generation" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scenario Generation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_3" >
        
          
          <label class="md-nav__link" for="__nav_3_4_3" id="__nav_3_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Agents or tool use
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Agents or tool use
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/test_data_generation/agents/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testset Generation for Agents or Tool use cases
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../concepts/feedback/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Feedback Intelligence
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Feedback Intelligence
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../howtos/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    🛠️ How-to Guides
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    🛠️ How-to Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../howtos/customizations/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Customizations
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Customizations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2_2" id="__nav_4_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    General
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    General
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/customizations/customize_models/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Customise models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/customizations/_run_config/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Run Config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/customizations/_caching/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Caching
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_3" >
        
          
          <label class="md-nav__link" for="__nav_4_2_3" id="__nav_4_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Metrics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/customizations/metrics/_modifying-prompts-metrics/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Modify Prompts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/customizations/metrics/_metrics_language_adaptation/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adapt Metrics to Languages
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/customizations/metrics/_write_your_own_metric/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Write your own Metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/customizations/metrics/_write_your_own_metric_advanced/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Write your own Metrics - (advanced)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_4" >
        
          
          <label class="md-nav__link" for="__nav_4_2_4" id="__nav_4_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Testset Generation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Testset Generation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/customizations/testgenerator/_language_adaptation/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Non-English Testset Generation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/customizations/testgenerator/_persona_generator/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Persona Generation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/customizations/testgenerator/_testgen-custom-single-hop/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Single-hop Query
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/customizations/testgenerator/_testgen-customisation/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Multi-hop Query
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../howtos/applications/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Applications
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Applications
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_2" >
        
          
          <label class="md-nav__link" for="__nav_4_3_2" id="__nav_4_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Metrics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/applications/_cost/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cost Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/applications/evaluating_multi_turn_conversations/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluating Multi-turn Conversations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/applications/vertexai_x_zibly/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluations with Vertex AI models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3_3" id="__nav_4_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Testset Generation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Testset Generation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/applications/singlehop_testset_gen/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Single-hop Query Testset
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_4" >
        
          
          <label class="md-nav__link" for="__nav_4_3_4" id="__nav_4_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Benchmarking
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Benchmarking
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/applications/gemini_benchmarking/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Benchmarking Gemini models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../howtos/integrations/index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Integrations
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Integrations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/integrations/_arize/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Arize
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/integrations/amazon_bedrock/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Amazon Bedrock
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/integrations/haystack/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Haystack
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/integrations/griptape/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Griptape
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/integrations/langchain/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LangChain
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/integrations/_langgraph_agent_evaluation/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LangGraph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/integrations/langsmith/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LangSmith
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/integrations/_llamaindex/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LlamaIndex
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/integrations/llama_stack/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LlamaStack
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/integrations/r2r/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    R2R
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/integrations/swarm_agent_evaluation/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Swarm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Migrations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Migrations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../howtos/migrations/migrate_from_v01_to_v02/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    From v0.1 to v0.2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    📖 References
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    📖 References
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Core
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prompt/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Prompt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llms/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LLMs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../embeddings/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Embeddings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../run_config/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RunConfig
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../executor/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Executor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cache/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cache
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" checked>
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Evaluation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Evaluation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../evaluation_schema/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Schemas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="index.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base" class="md-nav__link">
    <span class="md-ellipsis">
      
        base
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.MetricType" class="md-nav__link">
    <span class="md-ellipsis">
      
        MetricType
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.Metric" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.Metric.score" class="md-nav__link">
    <span class="md-ellipsis">
      
        score
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.Metric.ascore" class="md-nav__link">
    <span class="md-ellipsis">
      
        ascore
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.MetricWithLLM" class="md-nav__link">
    <span class="md-ellipsis">
      
        MetricWithLLM
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MetricWithLLM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.MetricWithLLM.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        train
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.SingleTurnMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        SingleTurnMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SingleTurnMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.SingleTurnMetric.single_turn_score" class="md-nav__link">
    <span class="md-ellipsis">
      
        single_turn_score
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.SingleTurnMetric.single_turn_ascore" class="md-nav__link">
    <span class="md-ellipsis">
      
        single_turn_ascore
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.MultiTurnMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        MultiTurnMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiTurnMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.MultiTurnMetric.multi_turn_score" class="md-nav__link">
    <span class="md-ellipsis">
      
        multi_turn_score
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.MultiTurnMetric.multi_turn_ascore" class="md-nav__link">
    <span class="md-ellipsis">
      
        multi_turn_ascore
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.Ensember" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ensember
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ensember">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.Ensember.from_discrete" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_discrete
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        metrics
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.AnswerCorrectness" class="md-nav__link">
    <span class="md-ellipsis">
      
        AnswerCorrectness
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.ResponseRelevancy" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResponseRelevancy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.SemanticSimilarity" class="md-nav__link">
    <span class="md-ellipsis">
      
        SemanticSimilarity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.AspectCritic" class="md-nav__link">
    <span class="md-ellipsis">
      
        AspectCritic
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.ContextEntityRecall" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContextEntityRecall
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.LLMContextPrecisionWithReference" class="md-nav__link">
    <span class="md-ellipsis">
      
        LLMContextPrecisionWithReference
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.LLMContextRecall" class="md-nav__link">
    <span class="md-ellipsis">
      
        LLMContextRecall
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.FactualCorrectness" class="md-nav__link">
    <span class="md-ellipsis">
      
        FactualCorrectness
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.Faithfulness" class="md-nav__link">
    <span class="md-ellipsis">
      
        Faithfulness
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.FaithfulnesswithHHEM" class="md-nav__link">
    <span class="md-ellipsis">
      
        FaithfulnesswithHHEM
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.NoiseSensitivity" class="md-nav__link">
    <span class="md-ellipsis">
      
        NoiseSensitivity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.AnswerAccuracy" class="md-nav__link">
    <span class="md-ellipsis">
      
        AnswerAccuracy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.ContextRelevance" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContextRelevance
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.ResponseGroundedness" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResponseGroundedness
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.SimpleCriteriaScore" class="md-nav__link">
    <span class="md-ellipsis">
      
        SimpleCriteriaScore
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.Metric" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.Metric.score" class="md-nav__link">
    <span class="md-ellipsis">
      
        score
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.Metric.ascore" class="md-nav__link">
    <span class="md-ellipsis">
      
        ascore
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.MetricType" class="md-nav__link">
    <span class="md-ellipsis">
      
        MetricType
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.MetricWithLLM" class="md-nav__link">
    <span class="md-ellipsis">
      
        MetricWithLLM
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MetricWithLLM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.MetricWithLLM.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        train
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.MultiTurnMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        MultiTurnMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiTurnMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.MultiTurnMetric.multi_turn_score" class="md-nav__link">
    <span class="md-ellipsis">
      
        multi_turn_score
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.MultiTurnMetric.multi_turn_ascore" class="md-nav__link">
    <span class="md-ellipsis">
      
        multi_turn_ascore
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.SingleTurnMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        SingleTurnMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SingleTurnMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.SingleTurnMetric.single_turn_score" class="md-nav__link">
    <span class="md-ellipsis">
      
        single_turn_score
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.SingleTurnMetric.single_turn_ascore" class="md-nav__link">
    <span class="md-ellipsis">
      
        single_turn_ascore
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../evaluate/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    evaluate()
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Testset Generation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Testset Generation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testset_schema/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Schemas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../graph/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Graph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../transforms/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Transforms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../synthesizers/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Synthesizers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generate/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integrations/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Integrations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../community/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ❤️ Community
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base" class="md-nav__link">
    <span class="md-ellipsis">
      
        base
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.MetricType" class="md-nav__link">
    <span class="md-ellipsis">
      
        MetricType
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.Metric" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.Metric.score" class="md-nav__link">
    <span class="md-ellipsis">
      
        score
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.Metric.ascore" class="md-nav__link">
    <span class="md-ellipsis">
      
        ascore
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.MetricWithLLM" class="md-nav__link">
    <span class="md-ellipsis">
      
        MetricWithLLM
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MetricWithLLM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.MetricWithLLM.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        train
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.SingleTurnMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        SingleTurnMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SingleTurnMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.SingleTurnMetric.single_turn_score" class="md-nav__link">
    <span class="md-ellipsis">
      
        single_turn_score
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.SingleTurnMetric.single_turn_ascore" class="md-nav__link">
    <span class="md-ellipsis">
      
        single_turn_ascore
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.MultiTurnMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        MultiTurnMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiTurnMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.MultiTurnMetric.multi_turn_score" class="md-nav__link">
    <span class="md-ellipsis">
      
        multi_turn_score
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.MultiTurnMetric.multi_turn_ascore" class="md-nav__link">
    <span class="md-ellipsis">
      
        multi_turn_ascore
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.Ensember" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ensember
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ensember">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.base.Ensember.from_discrete" class="md-nav__link">
    <span class="md-ellipsis">
      
        from_discrete
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        metrics
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.AnswerCorrectness" class="md-nav__link">
    <span class="md-ellipsis">
      
        AnswerCorrectness
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.ResponseRelevancy" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResponseRelevancy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.SemanticSimilarity" class="md-nav__link">
    <span class="md-ellipsis">
      
        SemanticSimilarity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.AspectCritic" class="md-nav__link">
    <span class="md-ellipsis">
      
        AspectCritic
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.ContextEntityRecall" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContextEntityRecall
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.LLMContextPrecisionWithReference" class="md-nav__link">
    <span class="md-ellipsis">
      
        LLMContextPrecisionWithReference
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.LLMContextRecall" class="md-nav__link">
    <span class="md-ellipsis">
      
        LLMContextRecall
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.FactualCorrectness" class="md-nav__link">
    <span class="md-ellipsis">
      
        FactualCorrectness
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.Faithfulness" class="md-nav__link">
    <span class="md-ellipsis">
      
        Faithfulness
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.FaithfulnesswithHHEM" class="md-nav__link">
    <span class="md-ellipsis">
      
        FaithfulnesswithHHEM
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.NoiseSensitivity" class="md-nav__link">
    <span class="md-ellipsis">
      
        NoiseSensitivity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.AnswerAccuracy" class="md-nav__link">
    <span class="md-ellipsis">
      
        AnswerAccuracy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.ContextRelevance" class="md-nav__link">
    <span class="md-ellipsis">
      
        ContextRelevance
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.ResponseGroundedness" class="md-nav__link">
    <span class="md-ellipsis">
      
        ResponseGroundedness
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.SimpleCriteriaScore" class="md-nav__link">
    <span class="md-ellipsis">
      
        SimpleCriteriaScore
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.Metric" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.Metric.score" class="md-nav__link">
    <span class="md-ellipsis">
      
        score
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.Metric.ascore" class="md-nav__link">
    <span class="md-ellipsis">
      
        ascore
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.MetricType" class="md-nav__link">
    <span class="md-ellipsis">
      
        MetricType
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.MetricWithLLM" class="md-nav__link">
    <span class="md-ellipsis">
      
        MetricWithLLM
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MetricWithLLM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.MetricWithLLM.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        train
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.MultiTurnMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        MultiTurnMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MultiTurnMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.MultiTurnMetric.multi_turn_score" class="md-nav__link">
    <span class="md-ellipsis">
      
        multi_turn_score
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.MultiTurnMetric.multi_turn_ascore" class="md-nav__link">
    <span class="md-ellipsis">
      
        multi_turn_ascore
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="index.html#zibly.metrics.SingleTurnMetric" class="md-nav__link">
    <span class="md-ellipsis">
      
        SingleTurnMetric
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SingleTurnMetric">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.SingleTurnMetric.single_turn_score" class="md-nav__link">
    <span class="md-ellipsis">
      
        single_turn_score
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="index.html#zibly.metrics.SingleTurnMetric.single_turn_ascore" class="md-nav__link">
    <span class="md-ellipsis">
      
        single_turn_ascore
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../index.html" class="md-path__link">
        
  <span class="md-ellipsis">
    
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../index.html" class="md-path__link">
          
  <span class="md-ellipsis">
    📖 References
  </span>

        </a>
      </li>
    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../evaluation_schema/index.html" class="md-path__link">
          
  <span class="md-ellipsis">
    Evaluation
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Metrics</h1>

<div class="doc doc-object doc-module">



<a id="zibly.metrics.base"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.base.MetricType" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MetricType</span>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>


        <p>Enumeration of metric types in Zibly.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.base.MetricType.SINGLE_TURN">SINGLE_TURN</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Represents a single-turn metric type.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.base.MetricType.MULTI_TURN">MULTI_TURN</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Represents a multi-turn metric type.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.base.Metric" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">Metric</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">Metric</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="n"><span title="dict">dict</span></span><span class="p">(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>Abstract base class for metrics in Zibly.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.base.Metric.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the metric.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.base.Metric.required_columns">required_columns</span></code></td>
            <td>
                  <code><span title="Dict">Dict</span>[<span title="str">str</span>, <span title="Set">Set</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping metric type names to sets of required column names. This is
a property and raises <code>ValueError</code> if columns are not in <code>VALID_COLUMNS</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="zibly.metrics.base.Metric.score" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">score</span>


</h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">score</span><span class="p">(</span><span class="n">row</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="langchain_core.callbacks.Callbacks">Callbacks</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="float">float</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculates the score for a single row of data.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>This method is deprecated and will be removed in 0.3. Please use <code>single_turn_ascore</code> or <code>multi_turn_ascore</code> instead.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/zibly/metrics/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-130">130</a></span>
<span class="normal"><a href="index.html#__codelineno-0-131">131</a></span>
<span class="normal"><a href="index.html#__codelineno-0-132">132</a></span>
<span class="normal"><a href="index.html#__codelineno-0-133">133</a></span>
<span class="normal"><a href="index.html#__codelineno-0-134">134</a></span>
<span class="normal"><a href="index.html#__codelineno-0-135">135</a></span>
<span class="normal"><a href="index.html#__codelineno-0-136">136</a></span>
<span class="normal"><a href="index.html#__codelineno-0-137">137</a></span>
<span class="normal"><a href="index.html#__codelineno-0-138">138</a></span>
<span class="normal"><a href="index.html#__codelineno-0-139">139</a></span>
<span class="normal"><a href="index.html#__codelineno-0-140">140</a></span>
<span class="normal"><a href="index.html#__codelineno-0-141">141</a></span>
<span class="normal"><a href="index.html#__codelineno-0-142">142</a></span>
<span class="normal"><a href="index.html#__codelineno-0-143">143</a></span>
<span class="normal"><a href="index.html#__codelineno-0-144">144</a></span>
<span class="normal"><a href="index.html#__codelineno-0-145">145</a></span>
<span class="normal"><a href="index.html#__codelineno-0-146">146</a></span>
<span class="normal"><a href="index.html#__codelineno-0-147">147</a></span>
<span class="normal"><a href="index.html#__codelineno-0-148">148</a></span>
<span class="normal"><a href="index.html#__codelineno-0-149">149</a></span>
<span class="normal"><a href="index.html#__codelineno-0-150">150</a></span>
<span class="normal"><a href="index.html#__codelineno-0-151">151</a></span>
<span class="normal"><a href="index.html#__codelineno-0-152">152</a></span>
<span class="normal"><a href="index.html#__codelineno-0-153">153</a></span>
<span class="normal"><a href="index.html#__codelineno-0-154">154</a></span>
<span class="normal"><a href="index.html#__codelineno-0-155">155</a></span>
<span class="normal"><a href="index.html#__codelineno-0-156">156</a></span>
<span class="normal"><a href="index.html#__codelineno-0-157">157</a></span>
<span class="normal"><a href="index.html#__codelineno-0-158">158</a></span>
<span class="normal"><a href="index.html#__codelineno-0-159">159</a></span>
<span class="normal"><a href="index.html#__codelineno-0-160">160</a></span>
<span class="normal"><a href="index.html#__codelineno-0-161">161</a></span>
<span class="normal"><a href="index.html#__codelineno-0-162">162</a></span>
<span class="normal"><a href="index.html#__codelineno-0-163">163</a></span>
<span class="normal"><a href="index.html#__codelineno-0-164">164</a></span>
<span class="normal"><a href="index.html#__codelineno-0-165">165</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;0.2&quot;</span><span class="p">,</span> <span class="n">removal</span><span class="o">=</span><span class="s2">&quot;0.3&quot;</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;single_turn_ascore&quot;</span><span class="p">)</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="k">def</span><span class="w"> </span><span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n">Callbacks</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    Calculates the score for a single row of data.</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    Note</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    ----</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    This method is deprecated and will be removed in 0.3. Please use `single_turn_ascore` or `multi_turn_ascore` instead.</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="n">callbacks</span> <span class="o">=</span> <span class="n">callbacks</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">rm</span><span class="p">,</span> <span class="n">group_cm</span> <span class="o">=</span> <span class="n">new_group</span><span class="p">(</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">inputs</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ChainType</span><span class="o">.</span><span class="n">METRIC</span><span class="p">},</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="p">)</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="k">if</span> <span class="n">is_event_loop_running</span><span class="p">():</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a>                <span class="kn">import</span><span class="w"> </span><span class="nn">nest_asyncio</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>                <span class="n">nest_asyncio</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a>                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a>                    <span class="s2">&quot;It seems like your running this in a jupyter-like environment. Please install nest_asyncio with `pip install nest_asyncio` to make it work.&quot;</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a>                <span class="p">)</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">score</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ascore</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">group_cm</span><span class="p">))</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="k">raise</span> <span class="n">e</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_end</span><span class="p">({</span><span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">})</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">return</span> <span class="n">score</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="zibly.metrics.base.Metric.ascore" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ascore</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">ascore</span><span class="p">(</span><span class="n">row</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="langchain_core.callbacks.Callbacks">Callbacks</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="float">float</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="float">float</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Asynchronously calculates the score for a single row of data.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>This method is deprecated and will be removed in 0.3. Please use <code>single_turn_ascore</code> instead.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/zibly/metrics/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-167">167</a></span>
<span class="normal"><a href="index.html#__codelineno-0-168">168</a></span>
<span class="normal"><a href="index.html#__codelineno-0-169">169</a></span>
<span class="normal"><a href="index.html#__codelineno-0-170">170</a></span>
<span class="normal"><a href="index.html#__codelineno-0-171">171</a></span>
<span class="normal"><a href="index.html#__codelineno-0-172">172</a></span>
<span class="normal"><a href="index.html#__codelineno-0-173">173</a></span>
<span class="normal"><a href="index.html#__codelineno-0-174">174</a></span>
<span class="normal"><a href="index.html#__codelineno-0-175">175</a></span>
<span class="normal"><a href="index.html#__codelineno-0-176">176</a></span>
<span class="normal"><a href="index.html#__codelineno-0-177">177</a></span>
<span class="normal"><a href="index.html#__codelineno-0-178">178</a></span>
<span class="normal"><a href="index.html#__codelineno-0-179">179</a></span>
<span class="normal"><a href="index.html#__codelineno-0-180">180</a></span>
<span class="normal"><a href="index.html#__codelineno-0-181">181</a></span>
<span class="normal"><a href="index.html#__codelineno-0-182">182</a></span>
<span class="normal"><a href="index.html#__codelineno-0-183">183</a></span>
<span class="normal"><a href="index.html#__codelineno-0-184">184</a></span>
<span class="normal"><a href="index.html#__codelineno-0-185">185</a></span>
<span class="normal"><a href="index.html#__codelineno-0-186">186</a></span>
<span class="normal"><a href="index.html#__codelineno-0-187">187</a></span>
<span class="normal"><a href="index.html#__codelineno-0-188">188</a></span>
<span class="normal"><a href="index.html#__codelineno-0-189">189</a></span>
<span class="normal"><a href="index.html#__codelineno-0-190">190</a></span>
<span class="normal"><a href="index.html#__codelineno-0-191">191</a></span>
<span class="normal"><a href="index.html#__codelineno-0-192">192</a></span>
<span class="normal"><a href="index.html#__codelineno-0-193">193</a></span>
<span class="normal"><a href="index.html#__codelineno-0-194">194</a></span>
<span class="normal"><a href="index.html#__codelineno-0-195">195</a></span>
<span class="normal"><a href="index.html#__codelineno-0-196">196</a></span>
<span class="normal"><a href="index.html#__codelineno-0-197">197</a></span>
<span class="normal"><a href="index.html#__codelineno-0-198">198</a></span>
<span class="normal"><a href="index.html#__codelineno-0-199">199</a></span>
<span class="normal"><a href="index.html#__codelineno-0-200">200</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;0.2&quot;</span><span class="p">,</span> <span class="n">removal</span><span class="o">=</span><span class="s2">&quot;0.3&quot;</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;single_turn_ascore&quot;</span><span class="p">)</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ascore</span><span class="p">(</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">row</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">,</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">callbacks</span><span class="p">:</span> <span class="n">Callbacks</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">timeout</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">    Asynchronously calculates the score for a single row of data.</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">    Note</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    ----</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">    This method is deprecated and will be removed in 0.3. Please use `single_turn_ascore` instead.</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="n">callbacks</span> <span class="o">=</span> <span class="n">callbacks</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">rm</span><span class="p">,</span> <span class="n">group_cm</span> <span class="o">=</span> <span class="n">new_group</span><span class="p">(</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">inputs</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ChainType</span><span class="o">.</span><span class="n">METRIC</span><span class="p">},</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="p">)</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="n">score</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_ascore</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">group_cm</span><span class="p">),</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="p">)</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="k">raise</span> <span class="n">e</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_end</span><span class="p">({</span><span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">})</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="k">return</span> <span class="n">score</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.base.MetricWithLLM" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MetricWithLLM</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">MetricWithLLM</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="n"><span title="dict">dict</span></span><span class="p">(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.Metric">Metric</a></code>, <code><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PromptMixin">PromptMixin</a></code></p>


        <p>A metric class that uses a language model for evaluation.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.base.MetricWithLLM.llm">llm</span></code></td>
            <td>
                  <code><span title="Optional">Optional</span>[<a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The language model used for the metric.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="zibly.metrics.base.MetricWithLLM.train" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">train</span>


</h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">train</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">demonstration_config</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.config.DemonstrationConfig">DemonstrationConfig</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">instruction_config</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.config.InstructionConfig">InstructionConfig</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="langchain_core.callbacks.Callbacks">Callbacks</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">run_config</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../run_config/index.html#zibly.run_config.RunConfig">RunConfig</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">with_debugging_logs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">raise_exceptions</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Train the metric using local JSON data or annotations from Zibly platform</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to local JSON training data file</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Direct run ID to fetch annotations</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>demonstration_config</code>
            </td>
            <td>
                  <code><span title="zibly.config.DemonstrationConfig">DemonstrationConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for demonstration optimization</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>instruction_config</code>
            </td>
            <td>
                  <code><span title="zibly.config.InstructionConfig">InstructionConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for instruction optimization</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>callbacks</code>
            </td>
            <td>
                  <code><span title="langchain_core.callbacks.Callbacks">Callbacks</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of callback functions</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" href="../run_config/index.html#zibly.run_config.RunConfig">RunConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Run configuration</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Batch size for training</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_debugging_logs</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Enable debugging logs</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>raise_exceptions</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to raise exceptions during training</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If invalid combination of path, and run_id is provided</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zibly/metrics/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-345">345</a></span>
<span class="normal"><a href="index.html#__codelineno-0-346">346</a></span>
<span class="normal"><a href="index.html#__codelineno-0-347">347</a></span>
<span class="normal"><a href="index.html#__codelineno-0-348">348</a></span>
<span class="normal"><a href="index.html#__codelineno-0-349">349</a></span>
<span class="normal"><a href="index.html#__codelineno-0-350">350</a></span>
<span class="normal"><a href="index.html#__codelineno-0-351">351</a></span>
<span class="normal"><a href="index.html#__codelineno-0-352">352</a></span>
<span class="normal"><a href="index.html#__codelineno-0-353">353</a></span>
<span class="normal"><a href="index.html#__codelineno-0-354">354</a></span>
<span class="normal"><a href="index.html#__codelineno-0-355">355</a></span>
<span class="normal"><a href="index.html#__codelineno-0-356">356</a></span>
<span class="normal"><a href="index.html#__codelineno-0-357">357</a></span>
<span class="normal"><a href="index.html#__codelineno-0-358">358</a></span>
<span class="normal"><a href="index.html#__codelineno-0-359">359</a></span>
<span class="normal"><a href="index.html#__codelineno-0-360">360</a></span>
<span class="normal"><a href="index.html#__codelineno-0-361">361</a></span>
<span class="normal"><a href="index.html#__codelineno-0-362">362</a></span>
<span class="normal"><a href="index.html#__codelineno-0-363">363</a></span>
<span class="normal"><a href="index.html#__codelineno-0-364">364</a></span>
<span class="normal"><a href="index.html#__codelineno-0-365">365</a></span>
<span class="normal"><a href="index.html#__codelineno-0-366">366</a></span>
<span class="normal"><a href="index.html#__codelineno-0-367">367</a></span>
<span class="normal"><a href="index.html#__codelineno-0-368">368</a></span>
<span class="normal"><a href="index.html#__codelineno-0-369">369</a></span>
<span class="normal"><a href="index.html#__codelineno-0-370">370</a></span>
<span class="normal"><a href="index.html#__codelineno-0-371">371</a></span>
<span class="normal"><a href="index.html#__codelineno-0-372">372</a></span>
<span class="normal"><a href="index.html#__codelineno-0-373">373</a></span>
<span class="normal"><a href="index.html#__codelineno-0-374">374</a></span>
<span class="normal"><a href="index.html#__codelineno-0-375">375</a></span>
<span class="normal"><a href="index.html#__codelineno-0-376">376</a></span>
<span class="normal"><a href="index.html#__codelineno-0-377">377</a></span>
<span class="normal"><a href="index.html#__codelineno-0-378">378</a></span>
<span class="normal"><a href="index.html#__codelineno-0-379">379</a></span>
<span class="normal"><a href="index.html#__codelineno-0-380">380</a></span>
<span class="normal"><a href="index.html#__codelineno-0-381">381</a></span>
<span class="normal"><a href="index.html#__codelineno-0-382">382</a></span>
<span class="normal"><a href="index.html#__codelineno-0-383">383</a></span>
<span class="normal"><a href="index.html#__codelineno-0-384">384</a></span>
<span class="normal"><a href="index.html#__codelineno-0-385">385</a></span>
<span class="normal"><a href="index.html#__codelineno-0-386">386</a></span>
<span class="normal"><a href="index.html#__codelineno-0-387">387</a></span>
<span class="normal"><a href="index.html#__codelineno-0-388">388</a></span>
<span class="normal"><a href="index.html#__codelineno-0-389">389</a></span>
<span class="normal"><a href="index.html#__codelineno-0-390">390</a></span>
<span class="normal"><a href="index.html#__codelineno-0-391">391</a></span>
<span class="normal"><a href="index.html#__codelineno-0-392">392</a></span>
<span class="normal"><a href="index.html#__codelineno-0-393">393</a></span>
<span class="normal"><a href="index.html#__codelineno-0-394">394</a></span>
<span class="normal"><a href="index.html#__codelineno-0-395">395</a></span>
<span class="normal"><a href="index.html#__codelineno-0-396">396</a></span>
<span class="normal"><a href="index.html#__codelineno-0-397">397</a></span>
<span class="normal"><a href="index.html#__codelineno-0-398">398</a></span>
<span class="normal"><a href="index.html#__codelineno-0-399">399</a></span>
<span class="normal"><a href="index.html#__codelineno-0-400">400</a></span>
<span class="normal"><a href="index.html#__codelineno-0-401">401</a></span>
<span class="normal"><a href="index.html#__codelineno-0-402">402</a></span>
<span class="normal"><a href="index.html#__codelineno-0-403">403</a></span>
<span class="normal"><a href="index.html#__codelineno-0-404">404</a></span>
<span class="normal"><a href="index.html#__codelineno-0-405">405</a></span>
<span class="normal"><a href="index.html#__codelineno-0-406">406</a></span>
<span class="normal"><a href="index.html#__codelineno-0-407">407</a></span>
<span class="normal"><a href="index.html#__codelineno-0-408">408</a></span>
<span class="normal"><a href="index.html#__codelineno-0-409">409</a></span>
<span class="normal"><a href="index.html#__codelineno-0-410">410</a></span>
<span class="normal"><a href="index.html#__codelineno-0-411">411</a></span>
<span class="normal"><a href="index.html#__codelineno-0-412">412</a></span>
<span class="normal"><a href="index.html#__codelineno-0-413">413</a></span>
<span class="normal"><a href="index.html#__codelineno-0-414">414</a></span>
<span class="normal"><a href="index.html#__codelineno-0-415">415</a></span>
<span class="normal"><a href="index.html#__codelineno-0-416">416</a></span>
<span class="normal"><a href="index.html#__codelineno-0-417">417</a></span>
<span class="normal"><a href="index.html#__codelineno-0-418">418</a></span>
<span class="normal"><a href="index.html#__codelineno-0-419">419</a></span>
<span class="normal"><a href="index.html#__codelineno-0-420">420</a></span>
<span class="normal"><a href="index.html#__codelineno-0-421">421</a></span>
<span class="normal"><a href="index.html#__codelineno-0-422">422</a></span>
<span class="normal"><a href="index.html#__codelineno-0-423">423</a></span>
<span class="normal"><a href="index.html#__codelineno-0-424">424</a></span>
<span class="normal"><a href="index.html#__codelineno-0-425">425</a></span>
<span class="normal"><a href="index.html#__codelineno-0-426">426</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="n">path</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="n">run_id</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="n">demonstration_config</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">DemonstrationConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="n">instruction_config</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">InstructionConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="n">callbacks</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Callbacks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="n">run_config</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">RunConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="n">batch_size</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="n">with_debugging_logs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="n">raise_exceptions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">    Train the metric using local JSON data or annotations from Zibly platform</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359"></a>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">    ----------</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">    path : str, optional</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        Path to local JSON training data file</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">    run_id : str, optional</span>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        Direct run ID to fetch annotations</span>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">    demonstration_config : DemonstrationConfig, optional</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        Configuration for demonstration optimization</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">    instruction_config : InstructionConfig, optional</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">        Configuration for instruction optimization</span>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">    callbacks : Callbacks, optional</span>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        List of callback functions</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">    run_config : RunConfig, optional</span>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        Run configuration</span>
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">    batch_size : int, optional</span>
</span><span id="__span-0-375"><a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">        Batch size for training</span>
</span><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">    with_debugging_logs : bool, default=False</span>
</span><span id="__span-0-377"><a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">        Enable debugging logs</span>
</span><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">    raise_exceptions : bool, default=True</span>
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        Whether to raise exceptions during training</span>
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380"></a>
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">    Raises</span>
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">    ------</span>
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">    ValueError</span>
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">        If invalid combination of path, and run_id is provided</span>
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-386"><a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="c1"># Validate input parameters</span>
</span><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="n">provided_inputs</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">path</span><span class="p">,</span> <span class="n">run_id</span><span class="p">])</span>
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="k">if</span> <span class="n">provided_inputs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;One of path or run_id must be provided&quot;</span><span class="p">)</span>
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="k">if</span> <span class="n">provided_inputs</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only one of path or run_id should be provided&quot;</span><span class="p">)</span>
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392"></a>
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="n">run_config</span> <span class="o">=</span> <span class="n">run_config</span> <span class="ow">or</span> <span class="n">RunConfig</span><span class="p">()</span>
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="n">callbacks</span> <span class="o">=</span> <span class="n">callbacks</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395"></a>
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="c1"># Load the dataset based on input type</span>
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Train data must be in json format&quot;</span><span class="p">)</span>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="n">dataset</span> <span class="o">=</span> <span class="n">MetricAnnotation</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">metric_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="k">elif</span> <span class="n">run_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="n">dataset</span> <span class="o">=</span> <span class="n">MetricAnnotation</span><span class="o">.</span><span class="n">from_app</span><span class="p">(</span>
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403"></a>            <span class="n">run_id</span><span class="o">=</span><span class="n">run_id</span><span class="p">,</span>
</span><span id="__span-0-404"><a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="n">metric_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="p">)</span>
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;One of path or run_id must be provided&quot;</span><span class="p">)</span>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408"></a>
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="c1"># only optimize the instruction if instruction_config is provided</span>
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="k">if</span> <span class="n">instruction_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimize_instruction</span><span class="p">(</span>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="n">instruction_config</span><span class="o">=</span><span class="n">instruction_config</span><span class="p">,</span>
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
</span><span id="__span-0-414"><a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
</span><span id="__span-0-415"><a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="n">run_config</span><span class="o">=</span><span class="n">run_config</span><span class="p">,</span>
</span><span id="__span-0-416"><a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
</span><span id="__span-0-417"><a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="n">with_debugging_logs</span><span class="o">=</span><span class="n">with_debugging_logs</span><span class="p">,</span>
</span><span id="__span-0-418"><a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="n">raise_exceptions</span><span class="o">=</span><span class="n">raise_exceptions</span><span class="p">,</span>
</span><span id="__span-0-419"><a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="p">)</span>
</span><span id="__span-0-420"><a id="__codelineno-0-420" name="__codelineno-0-420"></a>
</span><span id="__span-0-421"><a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="c1"># if demonstration_config is provided, optimize the demonstrations</span>
</span><span id="__span-0-422"><a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="k">if</span> <span class="n">demonstration_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-423"><a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimize_demonstration</span><span class="p">(</span>
</span><span id="__span-0-424"><a id="__codelineno-0-424" name="__codelineno-0-424"></a>            <span class="n">demonstration_config</span><span class="o">=</span><span class="n">demonstration_config</span><span class="p">,</span>
</span><span id="__span-0-425"><a id="__codelineno-0-425" name="__codelineno-0-425"></a>            <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
</span><span id="__span-0-426"><a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.base.SingleTurnMetric" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">SingleTurnMetric</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">SingleTurnMetric</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="n"><span title="dict">dict</span></span><span class="p">(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.Metric">Metric</a></code></p>


        <p>A metric class for evaluating single-turn interactions.</p>
<p>This class provides methods to score single-turn samples, both synchronously and asynchronously.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="zibly.metrics.base.SingleTurnMetric.single_turn_score" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">single_turn_score</span>


</h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">single_turn_score</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../evaluation_schema/index.html#zibly.dataset_schema.SingleTurnSample">SingleTurnSample</a></span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="langchain_core.callbacks.Callbacks">Callbacks</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="float">float</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Synchronously score a single-turn sample.</p>
<p>May raise ImportError if nest_asyncio is not installed in a Jupyter-like environment.</p>


            <details class="quote">
              <summary>Source code in <code>src/zibly/metrics/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-461">461</a></span>
<span class="normal"><a href="index.html#__codelineno-0-462">462</a></span>
<span class="normal"><a href="index.html#__codelineno-0-463">463</a></span>
<span class="normal"><a href="index.html#__codelineno-0-464">464</a></span>
<span class="normal"><a href="index.html#__codelineno-0-465">465</a></span>
<span class="normal"><a href="index.html#__codelineno-0-466">466</a></span>
<span class="normal"><a href="index.html#__codelineno-0-467">467</a></span>
<span class="normal"><a href="index.html#__codelineno-0-468">468</a></span>
<span class="normal"><a href="index.html#__codelineno-0-469">469</a></span>
<span class="normal"><a href="index.html#__codelineno-0-470">470</a></span>
<span class="normal"><a href="index.html#__codelineno-0-471">471</a></span>
<span class="normal"><a href="index.html#__codelineno-0-472">472</a></span>
<span class="normal"><a href="index.html#__codelineno-0-473">473</a></span>
<span class="normal"><a href="index.html#__codelineno-0-474">474</a></span>
<span class="normal"><a href="index.html#__codelineno-0-475">475</a></span>
<span class="normal"><a href="index.html#__codelineno-0-476">476</a></span>
<span class="normal"><a href="index.html#__codelineno-0-477">477</a></span>
<span class="normal"><a href="index.html#__codelineno-0-478">478</a></span>
<span class="normal"><a href="index.html#__codelineno-0-479">479</a></span>
<span class="normal"><a href="index.html#__codelineno-0-480">480</a></span>
<span class="normal"><a href="index.html#__codelineno-0-481">481</a></span>
<span class="normal"><a href="index.html#__codelineno-0-482">482</a></span>
<span class="normal"><a href="index.html#__codelineno-0-483">483</a></span>
<span class="normal"><a href="index.html#__codelineno-0-484">484</a></span>
<span class="normal"><a href="index.html#__codelineno-0-485">485</a></span>
<span class="normal"><a href="index.html#__codelineno-0-486">486</a></span>
<span class="normal"><a href="index.html#__codelineno-0-487">487</a></span>
<span class="normal"><a href="index.html#__codelineno-0-488">488</a></span>
<span class="normal"><a href="index.html#__codelineno-0-489">489</a></span>
<span class="normal"><a href="index.html#__codelineno-0-490">490</a></span>
<span class="normal"><a href="index.html#__codelineno-0-491">491</a></span>
<span class="normal"><a href="index.html#__codelineno-0-492">492</a></span>
<span class="normal"><a href="index.html#__codelineno-0-493">493</a></span>
<span class="normal"><a href="index.html#__codelineno-0-494">494</a></span>
<span class="normal"><a href="index.html#__codelineno-0-495">495</a></span>
<span class="normal"><a href="index.html#__codelineno-0-496">496</a></span>
<span class="normal"><a href="index.html#__codelineno-0-497">497</a></span>
<span class="normal"><a href="index.html#__codelineno-0-498">498</a></span>
<span class="normal"><a href="index.html#__codelineno-0-499">499</a></span>
<span class="normal"><a href="index.html#__codelineno-0-500">500</a></span>
<span class="normal"><a href="index.html#__codelineno-0-501">501</a></span>
<span class="normal"><a href="index.html#__codelineno-0-502">502</a></span>
<span class="normal"><a href="index.html#__codelineno-0-503">503</a></span>
<span class="normal"><a href="index.html#__codelineno-0-504">504</a></span>
<span class="normal"><a href="index.html#__codelineno-0-505">505</a></span>
<span class="normal"><a href="index.html#__codelineno-0-506">506</a></span>
<span class="normal"><a href="index.html#__codelineno-0-507">507</a></span>
<span class="normal"><a href="index.html#__codelineno-0-508">508</a></span>
<span class="normal"><a href="index.html#__codelineno-0-509">509</a></span>
<span class="normal"><a href="index.html#__codelineno-0-510">510</a></span>
<span class="normal"><a href="index.html#__codelineno-0-511">511</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-461"><a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="k">def</span><span class="w"> </span><span class="nf">single_turn_score</span><span class="p">(</span>
</span><span id="__span-0-462"><a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-463"><a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="n">sample</span><span class="p">:</span> <span class="n">SingleTurnSample</span><span class="p">,</span>
</span><span id="__span-0-464"><a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="n">callbacks</span><span class="p">:</span> <span class="n">Callbacks</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-465"><a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-466"><a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-467"><a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">    Synchronously score a single-turn sample.</span>
</span><span id="__span-0-468"><a id="__codelineno-0-468" name="__codelineno-0-468"></a>
</span><span id="__span-0-469"><a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">    May raise ImportError if nest_asyncio is not installed in a Jupyter-like environment.</span>
</span><span id="__span-0-470"><a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-471"><a id="__codelineno-0-471" name="__codelineno-0-471"></a>    <span class="n">callbacks</span> <span class="o">=</span> <span class="n">callbacks</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="__span-0-472"><a id="__codelineno-0-472" name="__codelineno-0-472"></a>    <span class="c1"># only get the required columns</span>
</span><span id="__span-0-473"><a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="n">sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_only_required_columns_single_turn</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="__span-0-474"><a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="n">rm</span><span class="p">,</span> <span class="n">group_cm</span> <span class="o">=</span> <span class="n">new_group</span><span class="p">(</span>
</span><span id="__span-0-475"><a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-476"><a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="n">inputs</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span>
</span><span id="__span-0-477"><a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
</span><span id="__span-0-478"><a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ChainType</span><span class="o">.</span><span class="n">METRIC</span><span class="p">},</span>
</span><span id="__span-0-479"><a id="__codelineno-0-479" name="__codelineno-0-479"></a>    <span class="p">)</span>
</span><span id="__span-0-480"><a id="__codelineno-0-480" name="__codelineno-0-480"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-481"><a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="k">if</span> <span class="n">is_event_loop_running</span><span class="p">():</span>
</span><span id="__span-0-482"><a id="__codelineno-0-482" name="__codelineno-0-482"></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-483"><a id="__codelineno-0-483" name="__codelineno-0-483"></a>                <span class="kn">import</span><span class="w"> </span><span class="nn">nest_asyncio</span>
</span><span id="__span-0-484"><a id="__codelineno-0-484" name="__codelineno-0-484"></a>
</span><span id="__span-0-485"><a id="__codelineno-0-485" name="__codelineno-0-485"></a>                <span class="n">nest_asyncio</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
</span><span id="__span-0-486"><a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span id="__span-0-487"><a id="__codelineno-0-487" name="__codelineno-0-487"></a>                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
</span><span id="__span-0-488"><a id="__codelineno-0-488" name="__codelineno-0-488"></a>                    <span class="s2">&quot;It seems like your running this in a jupyter-like environment. Please install nest_asyncio with `pip install nest_asyncio` to make it work.&quot;</span>
</span><span id="__span-0-489"><a id="__codelineno-0-489" name="__codelineno-0-489"></a>                <span class="p">)</span>
</span><span id="__span-0-490"><a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
</span><span id="__span-0-491"><a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="n">score</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span>
</span><span id="__span-0-492"><a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_single_turn_ascore</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">sample</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">group_cm</span><span class="p">)</span>
</span><span id="__span-0-493"><a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="p">)</span>
</span><span id="__span-0-494"><a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-495"><a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-496"><a id="__codelineno-0-496" name="__codelineno-0-496"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-497"><a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="k">raise</span> <span class="n">e</span>
</span><span id="__span-0-498"><a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-499"><a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-500"><a id="__codelineno-0-500" name="__codelineno-0-500"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_end</span><span class="p">({</span><span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">})</span>
</span><span id="__span-0-501"><a id="__codelineno-0-501" name="__codelineno-0-501"></a>
</span><span id="__span-0-502"><a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="c1"># track the evaluation event</span>
</span><span id="__span-0-503"><a id="__codelineno-0-503" name="__codelineno-0-503"></a>    <span class="n">_analytics_batcher</span><span class="o">.</span><span class="n">add_evaluation</span><span class="p">(</span>
</span><span id="__span-0-504"><a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="n">EvaluationEvent</span><span class="p">(</span>
</span><span id="__span-0-505"><a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="__span-0-506"><a id="__codelineno-0-506" name="__codelineno-0-506"></a>            <span class="n">num_rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-507"><a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="n">evaluation_type</span><span class="o">=</span><span class="n">MetricType</span><span class="o">.</span><span class="n">SINGLE_TURN</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-508"><a id="__codelineno-0-508" name="__codelineno-0-508"></a>            <span class="n">language</span><span class="o">=</span><span class="n">get_metric_language</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
</span><span id="__span-0-509"><a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="p">)</span>
</span><span id="__span-0-510"><a id="__codelineno-0-510" name="__codelineno-0-510"></a>    <span class="p">)</span>
</span><span id="__span-0-511"><a id="__codelineno-0-511" name="__codelineno-0-511"></a>    <span class="k">return</span> <span class="n">score</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="zibly.metrics.base.SingleTurnMetric.single_turn_ascore" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">single_turn_ascore</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">single_turn_ascore</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../evaluation_schema/index.html#zibly.dataset_schema.SingleTurnSample">SingleTurnSample</a></span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="langchain_core.callbacks.Callbacks">Callbacks</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="float">float</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="float">float</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Asynchronously score a single-turn sample with an optional timeout.</p>
<p>May raise asyncio.TimeoutError if the scoring process exceeds the specified timeout.</p>


            <details class="quote">
              <summary>Source code in <code>src/zibly/metrics/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-513">513</a></span>
<span class="normal"><a href="index.html#__codelineno-0-514">514</a></span>
<span class="normal"><a href="index.html#__codelineno-0-515">515</a></span>
<span class="normal"><a href="index.html#__codelineno-0-516">516</a></span>
<span class="normal"><a href="index.html#__codelineno-0-517">517</a></span>
<span class="normal"><a href="index.html#__codelineno-0-518">518</a></span>
<span class="normal"><a href="index.html#__codelineno-0-519">519</a></span>
<span class="normal"><a href="index.html#__codelineno-0-520">520</a></span>
<span class="normal"><a href="index.html#__codelineno-0-521">521</a></span>
<span class="normal"><a href="index.html#__codelineno-0-522">522</a></span>
<span class="normal"><a href="index.html#__codelineno-0-523">523</a></span>
<span class="normal"><a href="index.html#__codelineno-0-524">524</a></span>
<span class="normal"><a href="index.html#__codelineno-0-525">525</a></span>
<span class="normal"><a href="index.html#__codelineno-0-526">526</a></span>
<span class="normal"><a href="index.html#__codelineno-0-527">527</a></span>
<span class="normal"><a href="index.html#__codelineno-0-528">528</a></span>
<span class="normal"><a href="index.html#__codelineno-0-529">529</a></span>
<span class="normal"><a href="index.html#__codelineno-0-530">530</a></span>
<span class="normal"><a href="index.html#__codelineno-0-531">531</a></span>
<span class="normal"><a href="index.html#__codelineno-0-532">532</a></span>
<span class="normal"><a href="index.html#__codelineno-0-533">533</a></span>
<span class="normal"><a href="index.html#__codelineno-0-534">534</a></span>
<span class="normal"><a href="index.html#__codelineno-0-535">535</a></span>
<span class="normal"><a href="index.html#__codelineno-0-536">536</a></span>
<span class="normal"><a href="index.html#__codelineno-0-537">537</a></span>
<span class="normal"><a href="index.html#__codelineno-0-538">538</a></span>
<span class="normal"><a href="index.html#__codelineno-0-539">539</a></span>
<span class="normal"><a href="index.html#__codelineno-0-540">540</a></span>
<span class="normal"><a href="index.html#__codelineno-0-541">541</a></span>
<span class="normal"><a href="index.html#__codelineno-0-542">542</a></span>
<span class="normal"><a href="index.html#__codelineno-0-543">543</a></span>
<span class="normal"><a href="index.html#__codelineno-0-544">544</a></span>
<span class="normal"><a href="index.html#__codelineno-0-545">545</a></span>
<span class="normal"><a href="index.html#__codelineno-0-546">546</a></span>
<span class="normal"><a href="index.html#__codelineno-0-547">547</a></span>
<span class="normal"><a href="index.html#__codelineno-0-548">548</a></span>
<span class="normal"><a href="index.html#__codelineno-0-549">549</a></span>
<span class="normal"><a href="index.html#__codelineno-0-550">550</a></span>
<span class="normal"><a href="index.html#__codelineno-0-551">551</a></span>
<span class="normal"><a href="index.html#__codelineno-0-552">552</a></span>
<span class="normal"><a href="index.html#__codelineno-0-553">553</a></span>
<span class="normal"><a href="index.html#__codelineno-0-554">554</a></span>
<span class="normal"><a href="index.html#__codelineno-0-555">555</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-513"><a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">single_turn_ascore</span><span class="p">(</span>
</span><span id="__span-0-514"><a id="__codelineno-0-514" name="__codelineno-0-514"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-515"><a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="n">sample</span><span class="p">:</span> <span class="n">SingleTurnSample</span><span class="p">,</span>
</span><span id="__span-0-516"><a id="__codelineno-0-516" name="__codelineno-0-516"></a>    <span class="n">callbacks</span><span class="p">:</span> <span class="n">Callbacks</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-517"><a id="__codelineno-0-517" name="__codelineno-0-517"></a>    <span class="n">timeout</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-518"><a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-519"><a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-520"><a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">    Asynchronously score a single-turn sample with an optional timeout.</span>
</span><span id="__span-0-521"><a id="__codelineno-0-521" name="__codelineno-0-521"></a>
</span><span id="__span-0-522"><a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">    May raise asyncio.TimeoutError if the scoring process exceeds the specified timeout.</span>
</span><span id="__span-0-523"><a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-524"><a id="__codelineno-0-524" name="__codelineno-0-524"></a>    <span class="n">callbacks</span> <span class="o">=</span> <span class="n">callbacks</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="__span-0-525"><a id="__codelineno-0-525" name="__codelineno-0-525"></a>    <span class="c1"># only get the required columns</span>
</span><span id="__span-0-526"><a id="__codelineno-0-526" name="__codelineno-0-526"></a>    <span class="n">sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_only_required_columns_single_turn</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="__span-0-527"><a id="__codelineno-0-527" name="__codelineno-0-527"></a>    <span class="n">rm</span><span class="p">,</span> <span class="n">group_cm</span> <span class="o">=</span> <span class="n">new_group</span><span class="p">(</span>
</span><span id="__span-0-528"><a id="__codelineno-0-528" name="__codelineno-0-528"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-529"><a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="n">inputs</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span>
</span><span id="__span-0-530"><a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
</span><span id="__span-0-531"><a id="__codelineno-0-531" name="__codelineno-0-531"></a>        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ChainType</span><span class="o">.</span><span class="n">METRIC</span><span class="p">},</span>
</span><span id="__span-0-532"><a id="__codelineno-0-532" name="__codelineno-0-532"></a>    <span class="p">)</span>
</span><span id="__span-0-533"><a id="__codelineno-0-533" name="__codelineno-0-533"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-534"><a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="n">score</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span>
</span><span id="__span-0-535"><a id="__codelineno-0-535" name="__codelineno-0-535"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_single_turn_ascore</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">sample</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">group_cm</span><span class="p">),</span>
</span><span id="__span-0-536"><a id="__codelineno-0-536" name="__codelineno-0-536"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
</span><span id="__span-0-537"><a id="__codelineno-0-537" name="__codelineno-0-537"></a>        <span class="p">)</span>
</span><span id="__span-0-538"><a id="__codelineno-0-538" name="__codelineno-0-538"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-539"><a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-540"><a id="__codelineno-0-540" name="__codelineno-0-540"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-541"><a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="k">raise</span> <span class="n">e</span>
</span><span id="__span-0-542"><a id="__codelineno-0-542" name="__codelineno-0-542"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-543"><a id="__codelineno-0-543" name="__codelineno-0-543"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-544"><a id="__codelineno-0-544" name="__codelineno-0-544"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_end</span><span class="p">({</span><span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">})</span>
</span><span id="__span-0-545"><a id="__codelineno-0-545" name="__codelineno-0-545"></a>
</span><span id="__span-0-546"><a id="__codelineno-0-546" name="__codelineno-0-546"></a>    <span class="c1"># track the evaluation event</span>
</span><span id="__span-0-547"><a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="n">_analytics_batcher</span><span class="o">.</span><span class="n">add_evaluation</span><span class="p">(</span>
</span><span id="__span-0-548"><a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="n">EvaluationEvent</span><span class="p">(</span>
</span><span id="__span-0-549"><a id="__codelineno-0-549" name="__codelineno-0-549"></a>            <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="__span-0-550"><a id="__codelineno-0-550" name="__codelineno-0-550"></a>            <span class="n">num_rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-551"><a id="__codelineno-0-551" name="__codelineno-0-551"></a>            <span class="n">evaluation_type</span><span class="o">=</span><span class="n">MetricType</span><span class="o">.</span><span class="n">SINGLE_TURN</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-552"><a id="__codelineno-0-552" name="__codelineno-0-552"></a>            <span class="n">language</span><span class="o">=</span><span class="n">get_metric_language</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
</span><span id="__span-0-553"><a id="__codelineno-0-553" name="__codelineno-0-553"></a>        <span class="p">)</span>
</span><span id="__span-0-554"><a id="__codelineno-0-554" name="__codelineno-0-554"></a>    <span class="p">)</span>
</span><span id="__span-0-555"><a id="__codelineno-0-555" name="__codelineno-0-555"></a>    <span class="k">return</span> <span class="n">score</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.base.MultiTurnMetric" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MultiTurnMetric</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">MultiTurnMetric</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="n"><span title="dict">dict</span></span><span class="p">(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.Metric">Metric</a></code></p>


        <p>A metric class for evaluating multi-turn conversations.</p>
<p>This class extends the base Metric class to provide functionality
for scoring multi-turn conversation samples.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="zibly.metrics.base.MultiTurnMetric.multi_turn_score" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">multi_turn_score</span>


</h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">multi_turn_score</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../evaluation_schema/index.html#zibly.dataset_schema.MultiTurnSample">MultiTurnSample</a></span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="langchain_core.callbacks.Callbacks">Callbacks</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="float">float</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Score a multi-turn conversation sample synchronously.</p>
<p>May raise ImportError if nest_asyncio is not installed in Jupyter-like environments.</p>


            <details class="quote">
              <summary>Source code in <code>src/zibly/metrics/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-590">590</a></span>
<span class="normal"><a href="index.html#__codelineno-0-591">591</a></span>
<span class="normal"><a href="index.html#__codelineno-0-592">592</a></span>
<span class="normal"><a href="index.html#__codelineno-0-593">593</a></span>
<span class="normal"><a href="index.html#__codelineno-0-594">594</a></span>
<span class="normal"><a href="index.html#__codelineno-0-595">595</a></span>
<span class="normal"><a href="index.html#__codelineno-0-596">596</a></span>
<span class="normal"><a href="index.html#__codelineno-0-597">597</a></span>
<span class="normal"><a href="index.html#__codelineno-0-598">598</a></span>
<span class="normal"><a href="index.html#__codelineno-0-599">599</a></span>
<span class="normal"><a href="index.html#__codelineno-0-600">600</a></span>
<span class="normal"><a href="index.html#__codelineno-0-601">601</a></span>
<span class="normal"><a href="index.html#__codelineno-0-602">602</a></span>
<span class="normal"><a href="index.html#__codelineno-0-603">603</a></span>
<span class="normal"><a href="index.html#__codelineno-0-604">604</a></span>
<span class="normal"><a href="index.html#__codelineno-0-605">605</a></span>
<span class="normal"><a href="index.html#__codelineno-0-606">606</a></span>
<span class="normal"><a href="index.html#__codelineno-0-607">607</a></span>
<span class="normal"><a href="index.html#__codelineno-0-608">608</a></span>
<span class="normal"><a href="index.html#__codelineno-0-609">609</a></span>
<span class="normal"><a href="index.html#__codelineno-0-610">610</a></span>
<span class="normal"><a href="index.html#__codelineno-0-611">611</a></span>
<span class="normal"><a href="index.html#__codelineno-0-612">612</a></span>
<span class="normal"><a href="index.html#__codelineno-0-613">613</a></span>
<span class="normal"><a href="index.html#__codelineno-0-614">614</a></span>
<span class="normal"><a href="index.html#__codelineno-0-615">615</a></span>
<span class="normal"><a href="index.html#__codelineno-0-616">616</a></span>
<span class="normal"><a href="index.html#__codelineno-0-617">617</a></span>
<span class="normal"><a href="index.html#__codelineno-0-618">618</a></span>
<span class="normal"><a href="index.html#__codelineno-0-619">619</a></span>
<span class="normal"><a href="index.html#__codelineno-0-620">620</a></span>
<span class="normal"><a href="index.html#__codelineno-0-621">621</a></span>
<span class="normal"><a href="index.html#__codelineno-0-622">622</a></span>
<span class="normal"><a href="index.html#__codelineno-0-623">623</a></span>
<span class="normal"><a href="index.html#__codelineno-0-624">624</a></span>
<span class="normal"><a href="index.html#__codelineno-0-625">625</a></span>
<span class="normal"><a href="index.html#__codelineno-0-626">626</a></span>
<span class="normal"><a href="index.html#__codelineno-0-627">627</a></span>
<span class="normal"><a href="index.html#__codelineno-0-628">628</a></span>
<span class="normal"><a href="index.html#__codelineno-0-629">629</a></span>
<span class="normal"><a href="index.html#__codelineno-0-630">630</a></span>
<span class="normal"><a href="index.html#__codelineno-0-631">631</a></span>
<span class="normal"><a href="index.html#__codelineno-0-632">632</a></span>
<span class="normal"><a href="index.html#__codelineno-0-633">633</a></span>
<span class="normal"><a href="index.html#__codelineno-0-634">634</a></span>
<span class="normal"><a href="index.html#__codelineno-0-635">635</a></span>
<span class="normal"><a href="index.html#__codelineno-0-636">636</a></span>
<span class="normal"><a href="index.html#__codelineno-0-637">637</a></span>
<span class="normal"><a href="index.html#__codelineno-0-638">638</a></span>
<span class="normal"><a href="index.html#__codelineno-0-639">639</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-590"><a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="k">def</span><span class="w"> </span><span class="nf">multi_turn_score</span><span class="p">(</span>
</span><span id="__span-0-591"><a id="__codelineno-0-591" name="__codelineno-0-591"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-592"><a id="__codelineno-0-592" name="__codelineno-0-592"></a>    <span class="n">sample</span><span class="p">:</span> <span class="n">MultiTurnSample</span><span class="p">,</span>
</span><span id="__span-0-593"><a id="__codelineno-0-593" name="__codelineno-0-593"></a>    <span class="n">callbacks</span><span class="p">:</span> <span class="n">Callbacks</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-594"><a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-595"><a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-596"><a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">    Score a multi-turn conversation sample synchronously.</span>
</span><span id="__span-0-597"><a id="__codelineno-0-597" name="__codelineno-0-597"></a>
</span><span id="__span-0-598"><a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">    May raise ImportError if nest_asyncio is not installed in Jupyter-like environments.</span>
</span><span id="__span-0-599"><a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-600"><a id="__codelineno-0-600" name="__codelineno-0-600"></a>    <span class="n">callbacks</span> <span class="o">=</span> <span class="n">callbacks</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="__span-0-601"><a id="__codelineno-0-601" name="__codelineno-0-601"></a>    <span class="n">sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_only_required_columns_multi_turn</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="__span-0-602"><a id="__codelineno-0-602" name="__codelineno-0-602"></a>    <span class="n">rm</span><span class="p">,</span> <span class="n">group_cm</span> <span class="o">=</span> <span class="n">new_group</span><span class="p">(</span>
</span><span id="__span-0-603"><a id="__codelineno-0-603" name="__codelineno-0-603"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-604"><a id="__codelineno-0-604" name="__codelineno-0-604"></a>        <span class="n">inputs</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span>
</span><span id="__span-0-605"><a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
</span><span id="__span-0-606"><a id="__codelineno-0-606" name="__codelineno-0-606"></a>        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ChainType</span><span class="o">.</span><span class="n">METRIC</span><span class="p">},</span>
</span><span id="__span-0-607"><a id="__codelineno-0-607" name="__codelineno-0-607"></a>    <span class="p">)</span>
</span><span id="__span-0-608"><a id="__codelineno-0-608" name="__codelineno-0-608"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-609"><a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="k">if</span> <span class="n">is_event_loop_running</span><span class="p">():</span>
</span><span id="__span-0-610"><a id="__codelineno-0-610" name="__codelineno-0-610"></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-611"><a id="__codelineno-0-611" name="__codelineno-0-611"></a>                <span class="kn">import</span><span class="w"> </span><span class="nn">nest_asyncio</span>
</span><span id="__span-0-612"><a id="__codelineno-0-612" name="__codelineno-0-612"></a>
</span><span id="__span-0-613"><a id="__codelineno-0-613" name="__codelineno-0-613"></a>                <span class="n">nest_asyncio</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
</span><span id="__span-0-614"><a id="__codelineno-0-614" name="__codelineno-0-614"></a>            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span id="__span-0-615"><a id="__codelineno-0-615" name="__codelineno-0-615"></a>                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
</span><span id="__span-0-616"><a id="__codelineno-0-616" name="__codelineno-0-616"></a>                    <span class="s2">&quot;It seems like your running this in a jupyter-like environment. Please install nest_asyncio with `pip install nest_asyncio` to make it work.&quot;</span>
</span><span id="__span-0-617"><a id="__codelineno-0-617" name="__codelineno-0-617"></a>                <span class="p">)</span>
</span><span id="__span-0-618"><a id="__codelineno-0-618" name="__codelineno-0-618"></a>        <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
</span><span id="__span-0-619"><a id="__codelineno-0-619" name="__codelineno-0-619"></a>        <span class="n">score</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span>
</span><span id="__span-0-620"><a id="__codelineno-0-620" name="__codelineno-0-620"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_multi_turn_ascore</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">sample</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">group_cm</span><span class="p">)</span>
</span><span id="__span-0-621"><a id="__codelineno-0-621" name="__codelineno-0-621"></a>        <span class="p">)</span>
</span><span id="__span-0-622"><a id="__codelineno-0-622" name="__codelineno-0-622"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-623"><a id="__codelineno-0-623" name="__codelineno-0-623"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-624"><a id="__codelineno-0-624" name="__codelineno-0-624"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-625"><a id="__codelineno-0-625" name="__codelineno-0-625"></a>        <span class="k">raise</span> <span class="n">e</span>
</span><span id="__span-0-626"><a id="__codelineno-0-626" name="__codelineno-0-626"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-627"><a id="__codelineno-0-627" name="__codelineno-0-627"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-628"><a id="__codelineno-0-628" name="__codelineno-0-628"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_end</span><span class="p">({</span><span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">})</span>
</span><span id="__span-0-629"><a id="__codelineno-0-629" name="__codelineno-0-629"></a>
</span><span id="__span-0-630"><a id="__codelineno-0-630" name="__codelineno-0-630"></a>    <span class="c1"># track the evaluation event</span>
</span><span id="__span-0-631"><a id="__codelineno-0-631" name="__codelineno-0-631"></a>    <span class="n">_analytics_batcher</span><span class="o">.</span><span class="n">add_evaluation</span><span class="p">(</span>
</span><span id="__span-0-632"><a id="__codelineno-0-632" name="__codelineno-0-632"></a>        <span class="n">EvaluationEvent</span><span class="p">(</span>
</span><span id="__span-0-633"><a id="__codelineno-0-633" name="__codelineno-0-633"></a>            <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="__span-0-634"><a id="__codelineno-0-634" name="__codelineno-0-634"></a>            <span class="n">num_rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-635"><a id="__codelineno-0-635" name="__codelineno-0-635"></a>            <span class="n">evaluation_type</span><span class="o">=</span><span class="n">MetricType</span><span class="o">.</span><span class="n">SINGLE_TURN</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-636"><a id="__codelineno-0-636" name="__codelineno-0-636"></a>            <span class="n">language</span><span class="o">=</span><span class="n">get_metric_language</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
</span><span id="__span-0-637"><a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="p">)</span>
</span><span id="__span-0-638"><a id="__codelineno-0-638" name="__codelineno-0-638"></a>    <span class="p">)</span>
</span><span id="__span-0-639"><a id="__codelineno-0-639" name="__codelineno-0-639"></a>    <span class="k">return</span> <span class="n">score</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="zibly.metrics.base.MultiTurnMetric.multi_turn_ascore" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">multi_turn_ascore</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">multi_turn_ascore</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../evaluation_schema/index.html#zibly.dataset_schema.MultiTurnSample">MultiTurnSample</a></span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="langchain_core.callbacks.Callbacks">Callbacks</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="float">float</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="float">float</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Score a multi-turn conversation sample asynchronously.</p>
<p>May raise asyncio.TimeoutError if the scoring process exceeds the specified timeout.</p>


            <details class="quote">
              <summary>Source code in <code>src/zibly/metrics/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-641">641</a></span>
<span class="normal"><a href="index.html#__codelineno-0-642">642</a></span>
<span class="normal"><a href="index.html#__codelineno-0-643">643</a></span>
<span class="normal"><a href="index.html#__codelineno-0-644">644</a></span>
<span class="normal"><a href="index.html#__codelineno-0-645">645</a></span>
<span class="normal"><a href="index.html#__codelineno-0-646">646</a></span>
<span class="normal"><a href="index.html#__codelineno-0-647">647</a></span>
<span class="normal"><a href="index.html#__codelineno-0-648">648</a></span>
<span class="normal"><a href="index.html#__codelineno-0-649">649</a></span>
<span class="normal"><a href="index.html#__codelineno-0-650">650</a></span>
<span class="normal"><a href="index.html#__codelineno-0-651">651</a></span>
<span class="normal"><a href="index.html#__codelineno-0-652">652</a></span>
<span class="normal"><a href="index.html#__codelineno-0-653">653</a></span>
<span class="normal"><a href="index.html#__codelineno-0-654">654</a></span>
<span class="normal"><a href="index.html#__codelineno-0-655">655</a></span>
<span class="normal"><a href="index.html#__codelineno-0-656">656</a></span>
<span class="normal"><a href="index.html#__codelineno-0-657">657</a></span>
<span class="normal"><a href="index.html#__codelineno-0-658">658</a></span>
<span class="normal"><a href="index.html#__codelineno-0-659">659</a></span>
<span class="normal"><a href="index.html#__codelineno-0-660">660</a></span>
<span class="normal"><a href="index.html#__codelineno-0-661">661</a></span>
<span class="normal"><a href="index.html#__codelineno-0-662">662</a></span>
<span class="normal"><a href="index.html#__codelineno-0-663">663</a></span>
<span class="normal"><a href="index.html#__codelineno-0-664">664</a></span>
<span class="normal"><a href="index.html#__codelineno-0-665">665</a></span>
<span class="normal"><a href="index.html#__codelineno-0-666">666</a></span>
<span class="normal"><a href="index.html#__codelineno-0-667">667</a></span>
<span class="normal"><a href="index.html#__codelineno-0-668">668</a></span>
<span class="normal"><a href="index.html#__codelineno-0-669">669</a></span>
<span class="normal"><a href="index.html#__codelineno-0-670">670</a></span>
<span class="normal"><a href="index.html#__codelineno-0-671">671</a></span>
<span class="normal"><a href="index.html#__codelineno-0-672">672</a></span>
<span class="normal"><a href="index.html#__codelineno-0-673">673</a></span>
<span class="normal"><a href="index.html#__codelineno-0-674">674</a></span>
<span class="normal"><a href="index.html#__codelineno-0-675">675</a></span>
<span class="normal"><a href="index.html#__codelineno-0-676">676</a></span>
<span class="normal"><a href="index.html#__codelineno-0-677">677</a></span>
<span class="normal"><a href="index.html#__codelineno-0-678">678</a></span>
<span class="normal"><a href="index.html#__codelineno-0-679">679</a></span>
<span class="normal"><a href="index.html#__codelineno-0-680">680</a></span>
<span class="normal"><a href="index.html#__codelineno-0-681">681</a></span>
<span class="normal"><a href="index.html#__codelineno-0-682">682</a></span>
<span class="normal"><a href="index.html#__codelineno-0-683">683</a></span>
<span class="normal"><a href="index.html#__codelineno-0-684">684</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-641"><a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">multi_turn_ascore</span><span class="p">(</span>
</span><span id="__span-0-642"><a id="__codelineno-0-642" name="__codelineno-0-642"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-643"><a id="__codelineno-0-643" name="__codelineno-0-643"></a>    <span class="n">sample</span><span class="p">:</span> <span class="n">MultiTurnSample</span><span class="p">,</span>
</span><span id="__span-0-644"><a id="__codelineno-0-644" name="__codelineno-0-644"></a>    <span class="n">callbacks</span><span class="p">:</span> <span class="n">Callbacks</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-645"><a id="__codelineno-0-645" name="__codelineno-0-645"></a>    <span class="n">timeout</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-646"><a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-647"><a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-648"><a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">    Score a multi-turn conversation sample asynchronously.</span>
</span><span id="__span-0-649"><a id="__codelineno-0-649" name="__codelineno-0-649"></a>
</span><span id="__span-0-650"><a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">    May raise asyncio.TimeoutError if the scoring process exceeds the specified timeout.</span>
</span><span id="__span-0-651"><a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-652"><a id="__codelineno-0-652" name="__codelineno-0-652"></a>    <span class="n">callbacks</span> <span class="o">=</span> <span class="n">callbacks</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="__span-0-653"><a id="__codelineno-0-653" name="__codelineno-0-653"></a>    <span class="n">sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_only_required_columns_multi_turn</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="__span-0-654"><a id="__codelineno-0-654" name="__codelineno-0-654"></a>
</span><span id="__span-0-655"><a id="__codelineno-0-655" name="__codelineno-0-655"></a>    <span class="n">rm</span><span class="p">,</span> <span class="n">group_cm</span> <span class="o">=</span> <span class="n">new_group</span><span class="p">(</span>
</span><span id="__span-0-656"><a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-657"><a id="__codelineno-0-657" name="__codelineno-0-657"></a>        <span class="n">inputs</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span>
</span><span id="__span-0-658"><a id="__codelineno-0-658" name="__codelineno-0-658"></a>        <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
</span><span id="__span-0-659"><a id="__codelineno-0-659" name="__codelineno-0-659"></a>        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ChainType</span><span class="o">.</span><span class="n">METRIC</span><span class="p">},</span>
</span><span id="__span-0-660"><a id="__codelineno-0-660" name="__codelineno-0-660"></a>    <span class="p">)</span>
</span><span id="__span-0-661"><a id="__codelineno-0-661" name="__codelineno-0-661"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-662"><a id="__codelineno-0-662" name="__codelineno-0-662"></a>        <span class="n">score</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span>
</span><span id="__span-0-663"><a id="__codelineno-0-663" name="__codelineno-0-663"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_multi_turn_ascore</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">sample</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">group_cm</span><span class="p">),</span>
</span><span id="__span-0-664"><a id="__codelineno-0-664" name="__codelineno-0-664"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
</span><span id="__span-0-665"><a id="__codelineno-0-665" name="__codelineno-0-665"></a>        <span class="p">)</span>
</span><span id="__span-0-666"><a id="__codelineno-0-666" name="__codelineno-0-666"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-667"><a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-668"><a id="__codelineno-0-668" name="__codelineno-0-668"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-669"><a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="k">raise</span> <span class="n">e</span>
</span><span id="__span-0-670"><a id="__codelineno-0-670" name="__codelineno-0-670"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-671"><a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-672"><a id="__codelineno-0-672" name="__codelineno-0-672"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_end</span><span class="p">({</span><span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">})</span>
</span><span id="__span-0-673"><a id="__codelineno-0-673" name="__codelineno-0-673"></a>
</span><span id="__span-0-674"><a id="__codelineno-0-674" name="__codelineno-0-674"></a>    <span class="c1"># track the evaluation event</span>
</span><span id="__span-0-675"><a id="__codelineno-0-675" name="__codelineno-0-675"></a>    <span class="n">_analytics_batcher</span><span class="o">.</span><span class="n">add_evaluation</span><span class="p">(</span>
</span><span id="__span-0-676"><a id="__codelineno-0-676" name="__codelineno-0-676"></a>        <span class="n">EvaluationEvent</span><span class="p">(</span>
</span><span id="__span-0-677"><a id="__codelineno-0-677" name="__codelineno-0-677"></a>            <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="__span-0-678"><a id="__codelineno-0-678" name="__codelineno-0-678"></a>            <span class="n">num_rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-679"><a id="__codelineno-0-679" name="__codelineno-0-679"></a>            <span class="n">evaluation_type</span><span class="o">=</span><span class="n">MetricType</span><span class="o">.</span><span class="n">SINGLE_TURN</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-680"><a id="__codelineno-0-680" name="__codelineno-0-680"></a>            <span class="n">language</span><span class="o">=</span><span class="n">get_metric_language</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
</span><span id="__span-0-681"><a id="__codelineno-0-681" name="__codelineno-0-681"></a>        <span class="p">)</span>
</span><span id="__span-0-682"><a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="p">)</span>
</span><span id="__span-0-683"><a id="__codelineno-0-683" name="__codelineno-0-683"></a>
</span><span id="__span-0-684"><a id="__codelineno-0-684" name="__codelineno-0-684"></a>    <span class="k">return</span> <span class="n">score</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.base.Ensember" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">Ensember</span>


</h2>


    <div class="doc doc-contents ">


        <p>Combine multiple llm outputs for same input (n&gt;1) to a single output</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="zibly.metrics.base.Ensember.from_discrete" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">from_discrete</span>


</h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">from_discrete</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="typing.Dict">Dict</span></span><span class="p">]],</span> <span class="n">attribute</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.List">List</span></span><span class="p">[</span><span class="n"><span title="typing.Dict">Dict</span></span><span class="p">]</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Simple majority voting for binary values, ie [0,0,1] -&gt; 0
inputs: list of list of dicts each containing verdict for a single input</p>


            <details class="quote">
              <summary>Source code in <code>src/zibly/metrics/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-703">703</a></span>
<span class="normal"><a href="index.html#__codelineno-0-704">704</a></span>
<span class="normal"><a href="index.html#__codelineno-0-705">705</a></span>
<span class="normal"><a href="index.html#__codelineno-0-706">706</a></span>
<span class="normal"><a href="index.html#__codelineno-0-707">707</a></span>
<span class="normal"><a href="index.html#__codelineno-0-708">708</a></span>
<span class="normal"><a href="index.html#__codelineno-0-709">709</a></span>
<span class="normal"><a href="index.html#__codelineno-0-710">710</a></span>
<span class="normal"><a href="index.html#__codelineno-0-711">711</a></span>
<span class="normal"><a href="index.html#__codelineno-0-712">712</a></span>
<span class="normal"><a href="index.html#__codelineno-0-713">713</a></span>
<span class="normal"><a href="index.html#__codelineno-0-714">714</a></span>
<span class="normal"><a href="index.html#__codelineno-0-715">715</a></span>
<span class="normal"><a href="index.html#__codelineno-0-716">716</a></span>
<span class="normal"><a href="index.html#__codelineno-0-717">717</a></span>
<span class="normal"><a href="index.html#__codelineno-0-718">718</a></span>
<span class="normal"><a href="index.html#__codelineno-0-719">719</a></span>
<span class="normal"><a href="index.html#__codelineno-0-720">720</a></span>
<span class="normal"><a href="index.html#__codelineno-0-721">721</a></span>
<span class="normal"><a href="index.html#__codelineno-0-722">722</a></span>
<span class="normal"><a href="index.html#__codelineno-0-723">723</a></span>
<span class="normal"><a href="index.html#__codelineno-0-724">724</a></span>
<span class="normal"><a href="index.html#__codelineno-0-725">725</a></span>
<span class="normal"><a href="index.html#__codelineno-0-726">726</a></span>
<span class="normal"><a href="index.html#__codelineno-0-727">727</a></span>
<span class="normal"><a href="index.html#__codelineno-0-728">728</a></span>
<span class="normal"><a href="index.html#__codelineno-0-729">729</a></span>
<span class="normal"><a href="index.html#__codelineno-0-730">730</a></span>
<span class="normal"><a href="index.html#__codelineno-0-731">731</a></span>
<span class="normal"><a href="index.html#__codelineno-0-732">732</a></span>
<span class="normal"><a href="index.html#__codelineno-0-733">733</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-703"><a id="__codelineno-0-703" name="__codelineno-0-703"></a><span class="k">def</span><span class="w"> </span><span class="nf">from_discrete</span><span class="p">(</span>
</span><span id="__span-0-704"><a id="__codelineno-0-704" name="__codelineno-0-704"></a>    <span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">]],</span> <span class="n">attribute</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="__span-0-705"><a id="__codelineno-0-705" name="__codelineno-0-705"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="__span-0-706"><a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-707"><a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="sd">    Simple majority voting for binary values, ie [0,0,1] -&gt; 0</span>
</span><span id="__span-0-708"><a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">    inputs: list of list of dicts each containing verdict for a single input</span>
</span><span id="__span-0-709"><a id="__codelineno-0-709" name="__codelineno-0-709"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-710"><a id="__codelineno-0-710" name="__codelineno-0-710"></a>
</span><span id="__span-0-711"><a id="__codelineno-0-711" name="__codelineno-0-711"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="__span-0-712"><a id="__codelineno-0-712" name="__codelineno-0-712"></a>        <span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">inputs</span><span class="p">]</span>
</span><span id="__span-0-713"><a id="__codelineno-0-713" name="__codelineno-0-713"></a>
</span><span id="__span-0-714"><a id="__codelineno-0-714" name="__codelineno-0-714"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">):</span>
</span><span id="__span-0-715"><a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;All inputs must have the same length&quot;</span><span class="p">)</span>
</span><span id="__span-0-716"><a id="__codelineno-0-716" name="__codelineno-0-716"></a>        <span class="k">return</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-717"><a id="__codelineno-0-717" name="__codelineno-0-717"></a>
</span><span id="__span-0-718"><a id="__codelineno-0-718" name="__codelineno-0-718"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">attribute</span> <span class="ow">in</span> <span class="n">item</span> <span class="k">for</span> <span class="nb">input</span> <span class="ow">in</span> <span class="n">inputs</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">input</span><span class="p">):</span>
</span><span id="__span-0-719"><a id="__codelineno-0-719" name="__codelineno-0-719"></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;All inputs must have </span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2"> attribute&quot;</span><span class="p">)</span>
</span><span id="__span-0-720"><a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="k">return</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-721"><a id="__codelineno-0-721" name="__codelineno-0-721"></a>
</span><span id="__span-0-722"><a id="__codelineno-0-722" name="__codelineno-0-722"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-723"><a id="__codelineno-0-723" name="__codelineno-0-723"></a>        <span class="k">return</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-724"><a id="__codelineno-0-724" name="__codelineno-0-724"></a>
</span><span id="__span-0-725"><a id="__codelineno-0-725" name="__codelineno-0-725"></a>    <span class="n">verdict_agg</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-726"><a id="__codelineno-0-726" name="__codelineno-0-726"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
</span><span id="__span-0-727"><a id="__codelineno-0-727" name="__codelineno-0-727"></a>        <span class="n">item</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-0-728"><a id="__codelineno-0-728" name="__codelineno-0-728"></a>        <span class="n">verdicts</span> <span class="o">=</span> <span class="p">[</span><span class="n">inputs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">attribute</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">))]</span>
</span><span id="__span-0-729"><a id="__codelineno-0-729" name="__codelineno-0-729"></a>        <span class="n">verdict_counts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">verdicts</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">())</span>
</span><span id="__span-0-730"><a id="__codelineno-0-730" name="__codelineno-0-730"></a>        <span class="n">item</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">verdict_counts</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-0-731"><a id="__codelineno-0-731" name="__codelineno-0-731"></a>        <span class="n">verdict_agg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span id="__span-0-732"><a id="__codelineno-0-732" name="__codelineno-0-732"></a>
</span><span id="__span-0-733"><a id="__codelineno-0-733" name="__codelineno-0-733"></a>    <span class="k">return</span> <span class="n">verdict_agg</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="zibly.metrics"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.AnswerCorrectness" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">AnswerCorrectness</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">AnswerCorrectness</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="n"><span title="zibly.metrics.base.MetricType.SINGLE_TURN">SINGLE_TURN</span></span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;user_input&#39;</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">,</span> <span class="s1">&#39;reference&#39;</span><span class="p">}}(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;answer_correctness&#39;</span><span class="p">,</span> <span class="n">embeddings</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../embeddings/index.html#zibly.embeddings.BaseZiblyEmbeddings">BaseZiblyEmbeddings</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">correctness_prompt</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span> <span class="o">=</span> <span class="n"><span title="zibly.metrics._answer_correctness.CorrectnessClassifier">CorrectnessClassifier</span></span><span class="p">(),</span> <span class="n">statement_generator_prompt</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span> <span class="o">=</span> <span class="n"><span title="zibly.metrics._faithfulness.StatementGeneratorPrompt">StatementGeneratorPrompt</span></span><span class="p">(),</span> <span class="n">weights</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="float">float</span></span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">](),</span> <span class="n">beta</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">answer_similarity</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics._answer_similarity.AnswerSimilarity">AnswerSimilarity</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_retries</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricWithLLM">MetricWithLLM</a></code>, <code><span title="zibly.metrics.base.MetricWithEmbeddings">MetricWithEmbeddings</span></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.SingleTurnMetric">SingleTurnMetric</a></code></p>


        <p>Measures answer correctness compared to ground truth as a combination of
factuality and semantic similarity.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.AnswerCorrectness.name">name</span></code></td>
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the metrics</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.AnswerCorrectness.weights">weights</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a list of two weights corresponding to factuality and semantic similarity
Defaults [0.75, 0.25]</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.AnswerCorrectness.answer_similarity">answer_similarity</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="zibly.metrics._answer_similarity.AnswerSimilarity">AnswerSimilarity</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The AnswerSimilarity object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.ResponseRelevancy" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ResponseRelevancy</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">ResponseRelevancy</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="n"><span title="zibly.metrics.base.MetricType.SINGLE_TURN">SINGLE_TURN</span></span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;user_input&#39;</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">}}(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;answer_relevancy&#39;</span><span class="p">,</span> <span class="n">embeddings</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../embeddings/index.html#zibly.embeddings.BaseZiblyEmbeddings">BaseZiblyEmbeddings</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">question_generation</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span> <span class="o">=</span> <span class="n"><span title="zibly.metrics._answer_relevance.ResponseRelevancePrompt">ResponseRelevancePrompt</span></span><span class="p">(),</span> <span class="n">strictness</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricWithLLM">MetricWithLLM</a></code>, <code><span title="zibly.metrics.base.MetricWithEmbeddings">MetricWithEmbeddings</span></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.SingleTurnMetric">SingleTurnMetric</a></code></p>


        <p>Scores the relevancy of the answer according to the given question.
Answers with incomplete, redundant or unnecessary information is penalized.
Score can range from 0 to 1 with 1 being the best.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.ResponseRelevancy.name">name</span></code></td>
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the metrics</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.ResponseRelevancy.strictness">strictness</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Here indicates the number questions generated per answer.
Ideal range between 3 to 5.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.ResponseRelevancy.embeddings">embeddings</span></code></td>
            <td>
                  <code><span title="Embedding">Embedding</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The langchain wrapper of Embedding object.
E.g. HuggingFaceEmbeddings('BAAI/bge-base-en')</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.SemanticSimilarity" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">SemanticSimilarity</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">SemanticSimilarity</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="n"><span title="zibly.metrics.base.MetricType.SINGLE_TURN">SINGLE_TURN</span></span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;reference&#39;</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">}}(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;semantic_similarity&#39;</span><span class="p">,</span> <span class="n">embeddings</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../embeddings/index.html#zibly.embeddings.BaseZiblyEmbeddings">BaseZiblyEmbeddings</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">is_cross_encoder</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="float">float</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="zibly.metrics.base.MetricWithEmbeddings">MetricWithEmbeddings</span></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.SingleTurnMetric">SingleTurnMetric</a></code></p>


        <p>Scores the semantic similarity of ground truth with generated answer.
cross encoder score is used to quantify semantic similarity.
SAS paper: https://arxiv.org/pdf/2108.06130.pdf</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.SemanticSimilarity.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.SemanticSimilarity.model_name">model_name</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to be used for calculating semantic similarity
Defaults open-ai-embeddings
select cross-encoder model for best results
https://huggingface.co/spaces/mteb/leaderboard</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.SemanticSimilarity.threshold">threshold</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The threshold if given used to map output to binary
Default 0.5</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.AspectCritic" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">AspectCritic</span>


</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">AspectCritic</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">definition</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="n"><span title="zibly.metrics.base.MetricOutputType.BINARY">BINARY</span></span><span class="p">,</span> <span class="n">single_turn_prompt</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">multi_turn_prompt</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">strictness</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_retries</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricWithLLM">MetricWithLLM</a></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.SingleTurnMetric">SingleTurnMetric</a></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MultiTurnMetric">MultiTurnMetric</a></code></p>


        <p>Judges the submission to give binary results using the criteria specified
in the metric definition.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.AspectCritic.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of the metrics</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.AspectCritic.definition">definition</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>criteria to judge the submission, example "Is the submission spreading
fake information?"</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.AspectCritic.strictness">strictness</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of times self consistency checks is made. Final judgement is
made using majority vote.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>src/zibly/metrics/_aspect_critic.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="index.html#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="index.html#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="index.html#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="index.html#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="index.html#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="index.html#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="index.html#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="index.html#__codelineno-0-100">100</a></span>
<span class="normal"><a href="index.html#__codelineno-0-101">101</a></span>
<span class="normal"><a href="index.html#__codelineno-0-102">102</a></span>
<span class="normal"><a href="index.html#__codelineno-0-103">103</a></span>
<span class="normal"><a href="index.html#__codelineno-0-104">104</a></span>
<span class="normal"><a href="index.html#__codelineno-0-105">105</a></span>
<span class="normal"><a href="index.html#__codelineno-0-106">106</a></span>
<span class="normal"><a href="index.html#__codelineno-0-107">107</a></span>
<span class="normal"><a href="index.html#__codelineno-0-108">108</a></span>
<span class="normal"><a href="index.html#__codelineno-0-109">109</a></span>
<span class="normal"><a href="index.html#__codelineno-0-110">110</a></span>
<span class="normal"><a href="index.html#__codelineno-0-111">111</a></span>
<span class="normal"><a href="index.html#__codelineno-0-112">112</a></span>
<span class="normal"><a href="index.html#__codelineno-0-113">113</a></span>
<span class="normal"><a href="index.html#__codelineno-0-114">114</a></span>
<span class="normal"><a href="index.html#__codelineno-0-115">115</a></span>
<span class="normal"><a href="index.html#__codelineno-0-116">116</a></span>
<span class="normal"><a href="index.html#__codelineno-0-117">117</a></span>
<span class="normal"><a href="index.html#__codelineno-0-118">118</a></span>
<span class="normal"><a href="index.html#__codelineno-0-119">119</a></span>
<span class="normal"><a href="index.html#__codelineno-0-120">120</a></span>
<span class="normal"><a href="index.html#__codelineno-0-121">121</a></span>
<span class="normal"><a href="index.html#__codelineno-0-122">122</a></span>
<span class="normal"><a href="index.html#__codelineno-0-123">123</a></span>
<span class="normal"><a href="index.html#__codelineno-0-124">124</a></span>
<span class="normal"><a href="index.html#__codelineno-0-125">125</a></span>
<span class="normal"><a href="index.html#__codelineno-0-126">126</a></span>
<span class="normal"><a href="index.html#__codelineno-0-127">127</a></span>
<span class="normal"><a href="index.html#__codelineno-0-128">128</a></span>
<span class="normal"><a href="index.html#__codelineno-0-129">129</a></span>
<span class="normal"><a href="index.html#__codelineno-0-130">130</a></span>
<span class="normal"><a href="index.html#__codelineno-0-131">131</a></span>
<span class="normal"><a href="index.html#__codelineno-0-132">132</a></span>
<span class="normal"><a href="index.html#__codelineno-0-133">133</a></span>
<span class="normal"><a href="index.html#__codelineno-0-134">134</a></span>
<span class="normal"><a href="index.html#__codelineno-0-135">135</a></span>
<span class="normal"><a href="index.html#__codelineno-0-136">136</a></span>
<span class="normal"><a href="index.html#__codelineno-0-137">137</a></span>
<span class="normal"><a href="index.html#__codelineno-0-138">138</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">definition</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">llm</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">BaseZiblyLLM</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">required_columns</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="n">MetricType</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="n">output_type</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">MetricOutputType</span><span class="p">]</span> <span class="o">=</span> <span class="n">MetricOutputType</span><span class="o">.</span><span class="n">BINARY</span><span class="p">,</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="n">single_turn_prompt</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PydanticPrompt</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">multi_turn_prompt</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PydanticPrompt</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="n">strictness</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="p">):</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_required_columns</span> <span class="o">=</span> <span class="n">required_columns</span> <span class="ow">or</span> <span class="p">{</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">MetricType</span><span class="o">.</span><span class="n">SINGLE_TURN</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="s2">&quot;user_input:optional&quot;</span><span class="p">,</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="s2">&quot;response:optional&quot;</span><span class="p">,</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="s2">&quot;retrieved_contexts:optional&quot;</span><span class="p">,</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="s2">&quot;reference:optional&quot;</span><span class="p">,</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="s2">&quot;reference_contexts:optional&quot;</span><span class="p">,</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="p">},</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="n">MetricType</span><span class="o">.</span><span class="n">MULTI_TURN</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a>            <span class="s2">&quot;user_input:optional&quot;</span><span class="p">,</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a>            <span class="s2">&quot;reference:optional&quot;</span><span class="p">,</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="p">},</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="p">}</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="n">_required_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_required_columns</span><span class="p">,</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="n">llm</span><span class="o">=</span><span class="n">llm</span><span class="p">,</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">output_type</span><span class="o">=</span><span class="n">output_type</span><span class="p">,</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="p">)</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span> <span class="o">=</span> <span class="n">definition</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">single_turn_prompt</span> <span class="o">=</span> <span class="n">single_turn_prompt</span> <span class="ow">or</span> <span class="n">SingleTurnAspectCriticPrompt</span><span class="p">()</span>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">multi_turn_prompt</span> <span class="o">=</span> <span class="n">multi_turn_prompt</span> <span class="ow">or</span> <span class="n">MultiTurnAspectCriticPrompt</span><span class="p">()</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">max_retries</span> <span class="o">=</span> <span class="n">max_retries</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="c1"># update the instruction for the prompts with the definition</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="n">instruction</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Evaluate the Input based on the criterial defined. Use only &#39;Yes&#39; (1) and &#39;No&#39; (0) as verdict.</span><span class="se">\n</span><span class="s2">Criteria Definition: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">single_turn_prompt</span><span class="o">.</span><span class="n">instruction</span> <span class="o">=</span> <span class="n">instruction</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">multi_turn_prompt</span><span class="o">.</span><span class="n">instruction</span> <span class="o">=</span> <span class="n">instruction</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="c1"># ensure odd number of checks to avoid tie in majority vote.</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">strictness</span> <span class="o">=</span> <span class="n">strictness</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">strictness</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">strictness</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strictness</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">strictness</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.ContextEntityRecall" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ContextEntityRecall</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">ContextEntityRecall</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="n"><span title="zibly.metrics.base.MetricType.SINGLE_TURN">SINGLE_TURN</span></span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;reference&#39;</span><span class="p">,</span> <span class="s1">&#39;retrieved_contexts&#39;</span><span class="p">}}(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;context_entity_recall&#39;</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">context_entity_recall_prompt</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span> <span class="o">=</span> <span class="n"><span title="zibly.metrics._context_entities_recall.ExtractEntitiesPrompt">ExtractEntitiesPrompt</span></span><span class="p">(),</span> <span class="n">max_retries</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricWithLLM">MetricWithLLM</a></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.SingleTurnMetric">SingleTurnMetric</a></code></p>


        <p>Calculates recall based on entities present in ground truth and context.
Let CN be the set of entities present in context,
GN be the set of entities present in the ground truth.</p>
<p>Then we define can the context entity recall as follows:
Context Entity recall = | CN ∩ GN | / | GN |</p>
<p>If this quantity is 1, we can say that the retrieval mechanism has
retrieved context which covers all entities present in the ground truth,
thus being a useful retrieval. Thus this can be used to evaluate retrieval
mechanisms in specific use cases where entities matter, for example, a
tourism help chatbot.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.ContextEntityRecall.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.ContextEntityRecall.batch_size">batch_size</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Batch size for openai completion.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.LLMContextPrecisionWithReference" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">LLMContextPrecisionWithReference</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">LLMContextPrecisionWithReference</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="n"><span title="zibly.metrics.base.MetricType.SINGLE_TURN">SINGLE_TURN</span></span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;user_input&#39;</span><span class="p">,</span> <span class="s1">&#39;retrieved_contexts&#39;</span><span class="p">,</span> <span class="s1">&#39;reference&#39;</span><span class="p">}}(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;llm_context_precision_with_reference&#39;</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">context_precision_prompt</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span> <span class="o">=</span> <span class="n"><span title="zibly.metrics._context_precision.ContextPrecisionPrompt">ContextPrecisionPrompt</span></span><span class="p">(),</span> <span class="n">max_retries</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricWithLLM">MetricWithLLM</a></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.SingleTurnMetric">SingleTurnMetric</a></code></p>


        <p>Average Precision is a metric that evaluates whether all of the
relevant items selected by the model are ranked higher or not.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.LLMContextPrecisionWithReference.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.LLMContextPrecisionWithReference.evaluation_mode">evaluation_mode</span></code></td>
            <td>
                  <code><span title="EvaluationMode">EvaluationMode</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.LLMContextPrecisionWithReference.context_precision_prompt">context_precision_prompt</span></code></td>
            <td>
                  <code><span title="Prompt">Prompt</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.LLMContextRecall" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">LLMContextRecall</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">LLMContextRecall</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="n"><span title="zibly.metrics.base.MetricType.SINGLE_TURN">SINGLE_TURN</span></span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;user_input&#39;</span><span class="p">,</span> <span class="s1">&#39;retrieved_contexts&#39;</span><span class="p">,</span> <span class="s1">&#39;reference&#39;</span><span class="p">}}(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;context_recall&#39;</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="n"><span title="zibly.metrics.base.MetricOutputType.CONTINUOUS">CONTINUOUS</span></span><span class="p">,</span> <span class="n">context_recall_prompt</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span> <span class="o">=</span> <span class="n"><span title="zibly.metrics._context_recall.ContextRecallClassificationPrompt">ContextRecallClassificationPrompt</span></span><span class="p">(),</span> <span class="n">max_retries</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricWithLLM">MetricWithLLM</a></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.SingleTurnMetric">SingleTurnMetric</a></code></p>


        <p>Estimates context recall by estimating TP and FN using annotated answer and
retrieved context.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.LLMContextRecall.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.FactualCorrectness" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">FactualCorrectness</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">FactualCorrectness</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="n"><span title="zibly.metrics.base.MetricType.SINGLE_TURN">SINGLE_TURN</span></span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;response&#39;</span><span class="p">,</span> <span class="s1">&#39;reference&#39;</span><span class="p">}}(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;factual_correctness&#39;</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="n"><span title="zibly.metrics.base.MetricOutputType.CONTINUOUS">CONTINUOUS</span></span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="n"><span title="typing.Literal">Literal</span></span><span class="p">[</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="s1">&#39;recall&#39;</span><span class="p">,</span> <span class="s1">&#39;f1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="n">beta</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">atomicity</span><span class="p">:</span> <span class="n"><span title="typing.Literal">Literal</span></span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="n">coverage</span><span class="p">:</span> <span class="n"><span title="typing.Literal">Literal</span></span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="n">claim_decomposition_prompt</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span> <span class="o">=</span> <span class="n"><span title="zibly.metrics._factual_correctness.ClaimDecompositionPrompt">ClaimDecompositionPrompt</span></span><span class="p">(),</span> <span class="n">nli_prompt</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span> <span class="o">=</span> <span class="n"><span title="zibly.metrics._faithfulness.NLIStatementPrompt">NLIStatementPrompt</span></span><span class="p">(),</span> <span class="n">language</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;english&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricWithLLM">MetricWithLLM</a></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.SingleTurnMetric">SingleTurnMetric</a></code></p>


        <p>FactualCorrectness is a metric class that evaluates the factual correctness of responses
generated by a language model. It uses claim decomposition and natural language inference (NLI)
to verify the claims made in the responses against reference texts.</p>
<p>Attributes:
    name (str): The name of the metric, default is "factual_correctness".
    _required_columns (Dict[MetricType, Set[str]]): A dictionary specifying the required columns
        for each metric type. Default is {"SINGLE_TURN": {"response", "reference"}}.
    mode (Literal["precision", "recall", "f1"]): The mode of evaluation, can be "precision",
        "recall", or "f1". Default is "f1".
    beta (float): The beta value used for the F1 score calculation. A beta &gt; 1 gives more weight
        to recall, while beta &lt; 1 favors precision. Default is 1.0.
    atomicity (Literal["low", "high"]): The level of atomicity for claim decomposition. Default is "low".
    coverage (Literal["low", "high"]): The level of coverage for claim decomposition. Default is "low".
    claim_decomposition_prompt (PydanticPrompt): The prompt used for claim decomposition.
    nli_prompt (PydanticPrompt): The prompt used for natural language inference (NLI).</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.Faithfulness" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">Faithfulness</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">Faithfulness</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="n"><span title="zibly.metrics.base.MetricType.SINGLE_TURN">SINGLE_TURN</span></span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;user_input&#39;</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">,</span> <span class="s1">&#39;retrieved_contexts&#39;</span><span class="p">}}(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;faithfulness&#39;</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="n"><span title="zibly.metrics.base.MetricOutputType.CONTINUOUS">CONTINUOUS</span></span><span class="p">,</span> <span class="n">nli_statements_prompt</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span> <span class="o">=</span> <span class="n"><span title="zibly.metrics._faithfulness.NLIStatementPrompt">NLIStatementPrompt</span></span><span class="p">(),</span> <span class="n">statement_generator_prompt</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span> <span class="o">=</span> <span class="n"><span title="zibly.metrics._faithfulness.StatementGeneratorPrompt">StatementGeneratorPrompt</span></span><span class="p">(),</span> <span class="n">max_retries</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricWithLLM">MetricWithLLM</a></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.SingleTurnMetric">SingleTurnMetric</a></code></p>











  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.FaithfulnesswithHHEM" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">FaithfulnesswithHHEM</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">FaithfulnesswithHHEM</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="n"><span title="zibly.metrics.base.MetricType.SINGLE_TURN">SINGLE_TURN</span></span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;user_input&#39;</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">,</span> <span class="s1">&#39;retrieved_contexts&#39;</span><span class="p">}}(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;faithfulness_with_hhem&#39;</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="n"><span title="zibly.metrics.base.MetricOutputType.CONTINUOUS">CONTINUOUS</span></span><span class="p">,</span> <span class="n">nli_statements_prompt</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span> <span class="o">=</span> <span class="n"><span title="zibly.metrics._faithfulness.NLIStatementPrompt">NLIStatementPrompt</span></span><span class="p">(),</span> <span class="n">statement_generator_prompt</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span> <span class="o">=</span> <span class="n"><span title="zibly.metrics._faithfulness.StatementGeneratorPrompt">StatementGeneratorPrompt</span></span><span class="p">(),</span> <span class="n">max_retries</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.Faithfulness">Faithfulness</a></code></p>











  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.NoiseSensitivity" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">NoiseSensitivity</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">NoiseSensitivity</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="n"><span title="zibly.metrics.base.MetricType.SINGLE_TURN">SINGLE_TURN</span></span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;user_input&#39;</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">,</span> <span class="s1">&#39;reference&#39;</span><span class="p">,</span> <span class="s1">&#39;retrieved_contexts&#39;</span><span class="p">}}(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;noise_sensitivity&#39;</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="n"><span title="zibly.metrics.base.MetricOutputType.CONTINUOUS">CONTINUOUS</span></span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="n"><span title="typing.Literal">Literal</span></span><span class="p">[</span><span class="s1">&#39;relevant&#39;</span><span class="p">,</span> <span class="s1">&#39;irrelevant&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;relevant&#39;</span><span class="p">,</span> <span class="n">nli_statements_prompt</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span> <span class="o">=</span> <span class="n"><span title="zibly.metrics._faithfulness.NLIStatementPrompt">NLIStatementPrompt</span></span><span class="p">(),</span> <span class="n">statement_generator_prompt</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span> <span class="o">=</span> <span class="n"><span title="zibly.metrics._faithfulness.StatementGeneratorPrompt">StatementGeneratorPrompt</span></span><span class="p">(),</span> <span class="n">max_retries</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricWithLLM">MetricWithLLM</a></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.SingleTurnMetric">SingleTurnMetric</a></code></p>











  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.AnswerAccuracy" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">AnswerAccuracy</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">AnswerAccuracy</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="n"><span title="zibly.metrics.base.MetricType.SINGLE_TURN">SINGLE_TURN</span></span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;user_input&#39;</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">,</span> <span class="s1">&#39;reference&#39;</span><span class="p">}}(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;nv_accuracy&#39;</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricWithLLM">MetricWithLLM</a></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.SingleTurnMetric">SingleTurnMetric</a></code></p>


        <p>Measures answer accuracy compared to ground truth given a user_input.
This metric averages two distinct judge prompts to evaluate.</p>
<p>Top10, Zero-shoot LLM-as-a-Judge Leaderboard:
1)- mistralai/mixtral-8x22b-instruct-v0.1
2)- mistralai/mixtral-8x7b-instruct-v0.1
3)- meta/llama-3.1-70b-instruct
4)- meta/llama-3.3-70b-instruct
5)- meta/llama-3.1-405b-instruct
6)- mistralai/mistral-nemo-12b-instruct
7)- nvidia/llama-3.1-nemotron-70b-instruct
8)- meta/llama-3.1-8b-instruct
9)- google/gemma-2-2b-it
10)- nvidia/nemotron-mini-4b-instruct
The top1 LB model have high correlation with human judges (~0.90).</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.AnswerAccuracy.name">name</span></code></td>
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the metrics</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.AnswerAccuracy.answer_accuracy">answer_accuracy</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The AnswerAccuracy object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.ContextRelevance" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ContextRelevance</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">ContextRelevance</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="n"><span title="zibly.metrics.base.MetricType.SINGLE_TURN">SINGLE_TURN</span></span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;user_input&#39;</span><span class="p">,</span> <span class="s1">&#39;retrieved_contexts&#39;</span><span class="p">}}(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;nv_context_relevance&#39;</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricWithLLM">MetricWithLLM</a></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.SingleTurnMetric">SingleTurnMetric</a></code></p>


        <p>Parameters:
Score the relevance of the retrieved contexts be based on the user input.</p>
<p>Input:
    data: list of Dicts with keys: user_input, retrieved_contexts
Output:
    0.0: retrieved_contexts is not relevant for the user_input
    0.5: retrieved_contexts is partially relevant for the user_input
    1.0: retrieved_contexts is fully relevant for the user_input</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.ResponseGroundedness" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ResponseGroundedness</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">ResponseGroundedness</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="n"><span title="zibly.metrics.base.MetricType.SINGLE_TURN">SINGLE_TURN</span></span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;response&#39;</span><span class="p">,</span> <span class="s1">&#39;retrieved_contexts&#39;</span><span class="p">}}(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;nv_response_groundedness&#39;</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricWithLLM">MetricWithLLM</a></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.SingleTurnMetric">SingleTurnMetric</a></code></p>


        <p>Parameters:
Score the groundedness of the response based on the retrieved contexts.</p>
<p>Input:
    data: list of Dicts with keys: response, retrieved contexts
Output:
    0.0: response is not grounded in the retrieved contexts
    0.5: response is partially grounded in the retrieved contexts
    1.0: response is fully grounded in the retrieved contexts</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.SimpleCriteriaScore" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">SimpleCriteriaScore</span>


</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">SimpleCriteriaScore</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">definition</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="n"><span title="zibly.metrics.base.MetricOutputType.DISCRETE">DISCRETE</span></span><span class="p">,</span> <span class="n">single_turn_prompt</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">multi_turn_prompt</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PydanticPrompt">PydanticPrompt</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">strictness</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricWithLLM">MetricWithLLM</a></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.SingleTurnMetric">SingleTurnMetric</a></code>, <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MultiTurnMetric">MultiTurnMetric</a></code></p>


        <p>Judges the submission to give binary results using the criteria specified
in the metric definition.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.SimpleCriteriaScore.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>name of the metrics</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.SimpleCriteriaScore.definition">definition</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>criteria to score the submission</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.SimpleCriteriaScore.strictness">strictness</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of times self consistency checks is made. Final judgement is
made using majority vote.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







                  <details class="quote">
                    <summary>Source code in <code>src/zibly/metrics/_simple_criteria.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="index.html#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="index.html#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="index.html#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="index.html#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="index.html#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="index.html#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="index.html#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="index.html#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="index.html#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="index.html#__codelineno-0-100">100</a></span>
<span class="normal"><a href="index.html#__codelineno-0-101">101</a></span>
<span class="normal"><a href="index.html#__codelineno-0-102">102</a></span>
<span class="normal"><a href="index.html#__codelineno-0-103">103</a></span>
<span class="normal"><a href="index.html#__codelineno-0-104">104</a></span>
<span class="normal"><a href="index.html#__codelineno-0-105">105</a></span>
<span class="normal"><a href="index.html#__codelineno-0-106">106</a></span>
<span class="normal"><a href="index.html#__codelineno-0-107">107</a></span>
<span class="normal"><a href="index.html#__codelineno-0-108">108</a></span>
<span class="normal"><a href="index.html#__codelineno-0-109">109</a></span>
<span class="normal"><a href="index.html#__codelineno-0-110">110</a></span>
<span class="normal"><a href="index.html#__codelineno-0-111">111</a></span>
<span class="normal"><a href="index.html#__codelineno-0-112">112</a></span>
<span class="normal"><a href="index.html#__codelineno-0-113">113</a></span>
<span class="normal"><a href="index.html#__codelineno-0-114">114</a></span>
<span class="normal"><a href="index.html#__codelineno-0-115">115</a></span>
<span class="normal"><a href="index.html#__codelineno-0-116">116</a></span>
<span class="normal"><a href="index.html#__codelineno-0-117">117</a></span>
<span class="normal"><a href="index.html#__codelineno-0-118">118</a></span>
<span class="normal"><a href="index.html#__codelineno-0-119">119</a></span>
<span class="normal"><a href="index.html#__codelineno-0-120">120</a></span>
<span class="normal"><a href="index.html#__codelineno-0-121">121</a></span>
<span class="normal"><a href="index.html#__codelineno-0-122">122</a></span>
<span class="normal"><a href="index.html#__codelineno-0-123">123</a></span>
<span class="normal"><a href="index.html#__codelineno-0-124">124</a></span>
<span class="normal"><a href="index.html#__codelineno-0-125">125</a></span>
<span class="normal"><a href="index.html#__codelineno-0-126">126</a></span>
<span class="normal"><a href="index.html#__codelineno-0-127">127</a></span>
<span class="normal"><a href="index.html#__codelineno-0-128">128</a></span>
<span class="normal"><a href="index.html#__codelineno-0-129">129</a></span>
<span class="normal"><a href="index.html#__codelineno-0-130">130</a></span>
<span class="normal"><a href="index.html#__codelineno-0-131">131</a></span>
<span class="normal"><a href="index.html#__codelineno-0-132">132</a></span>
<span class="normal"><a href="index.html#__codelineno-0-133">133</a></span>
<span class="normal"><a href="index.html#__codelineno-0-134">134</a></span>
<span class="normal"><a href="index.html#__codelineno-0-135">135</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="n">definition</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">llm</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">BaseZiblyLLM</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">required_columns</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="n">MetricType</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">output_type</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">MetricOutputType</span><span class="p">]</span> <span class="o">=</span> <span class="n">MetricOutputType</span><span class="o">.</span><span class="n">DISCRETE</span><span class="p">,</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">single_turn_prompt</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PydanticPrompt</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="n">multi_turn_prompt</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PydanticPrompt</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="n">strictness</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="p">):</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101"></a>    <span class="k">if</span> <span class="n">required_columns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">required_columns</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="n">MetricType</span><span class="o">.</span><span class="n">SINGLE_TURN</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104"></a>                <span class="s2">&quot;user_input:optional&quot;</span><span class="p">,</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105"></a>                <span class="s2">&quot;response:optional&quot;</span><span class="p">,</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106"></a>                <span class="s2">&quot;retrieved_contexts:optional&quot;</span><span class="p">,</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107"></a>                <span class="s2">&quot;reference:optional&quot;</span><span class="p">,</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108"></a>                <span class="s2">&quot;reference_contexts:optional&quot;</span><span class="p">,</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="p">},</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="n">MetricType</span><span class="o">.</span><span class="n">MULTI_TURN</span><span class="p">:</span> <span class="p">{</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111"></a>                <span class="s2">&quot;user_input:optional&quot;</span><span class="p">,</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112"></a>                <span class="s2">&quot;reference:optional&quot;</span><span class="p">,</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113"></a>            <span class="p">},</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="p">}</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">llm</span><span class="o">=</span><span class="n">llm</span><span class="p">,</span>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="n">_required_columns</span><span class="o">=</span><span class="n">required_columns</span><span class="p">,</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="n">output_type</span><span class="o">=</span><span class="n">output_type</span><span class="p">,</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="p">)</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121"></a>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_definition</span> <span class="o">=</span> <span class="n">definition</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">single_turn_prompt</span> <span class="o">=</span> <span class="n">single_turn_prompt</span> <span class="ow">or</span> <span class="n">SingleTurnSimpleCriteriaPrompt</span><span class="p">()</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">multi_turn_prompt</span> <span class="o">=</span> <span class="n">multi_turn_prompt</span> <span class="ow">or</span> <span class="n">MultiTurnSimpleCriteriaPrompt</span><span class="p">()</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125"></a>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="c1"># update the instruction for the prompts with the definition</span>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">instruction</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Evaluate the input based on the criteria defined.</span><span class="se">\n</span><span class="s2">Criteria Definition: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_definition</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">single_turn_prompt</span><span class="o">.</span><span class="n">instruction</span> <span class="o">=</span> <span class="n">instruction</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">multi_turn_prompt</span><span class="o">.</span><span class="n">instruction</span> <span class="o">=</span> <span class="n">instruction</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="c1"># ensure odd number of checks to avoid tie in majority vote.</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">strictness</span> <span class="o">=</span> <span class="n">strictness</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">strictness</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">strictness</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strictness</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">strictness</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.Metric" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">Metric</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">Metric</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="n"><span title="dict">dict</span></span><span class="p">(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>Abstract base class for metrics in Zibly.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.Metric.name">name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the metric.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.Metric.required_columns">required_columns</span></code></td>
            <td>
                  <code><span title="Dict">Dict</span>[<span title="str">str</span>, <span title="Set">Set</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary mapping metric type names to sets of required column names. This is
a property and raises <code>ValueError</code> if columns are not in <code>VALID_COLUMNS</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="zibly.metrics.Metric.score" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">score</span>


</h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">score</span><span class="p">(</span><span class="n">row</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="langchain_core.callbacks.Callbacks">Callbacks</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="float">float</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculates the score for a single row of data.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>This method is deprecated and will be removed in 0.3. Please use <code>single_turn_ascore</code> or <code>multi_turn_ascore</code> instead.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/zibly/metrics/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-130">130</a></span>
<span class="normal"><a href="index.html#__codelineno-0-131">131</a></span>
<span class="normal"><a href="index.html#__codelineno-0-132">132</a></span>
<span class="normal"><a href="index.html#__codelineno-0-133">133</a></span>
<span class="normal"><a href="index.html#__codelineno-0-134">134</a></span>
<span class="normal"><a href="index.html#__codelineno-0-135">135</a></span>
<span class="normal"><a href="index.html#__codelineno-0-136">136</a></span>
<span class="normal"><a href="index.html#__codelineno-0-137">137</a></span>
<span class="normal"><a href="index.html#__codelineno-0-138">138</a></span>
<span class="normal"><a href="index.html#__codelineno-0-139">139</a></span>
<span class="normal"><a href="index.html#__codelineno-0-140">140</a></span>
<span class="normal"><a href="index.html#__codelineno-0-141">141</a></span>
<span class="normal"><a href="index.html#__codelineno-0-142">142</a></span>
<span class="normal"><a href="index.html#__codelineno-0-143">143</a></span>
<span class="normal"><a href="index.html#__codelineno-0-144">144</a></span>
<span class="normal"><a href="index.html#__codelineno-0-145">145</a></span>
<span class="normal"><a href="index.html#__codelineno-0-146">146</a></span>
<span class="normal"><a href="index.html#__codelineno-0-147">147</a></span>
<span class="normal"><a href="index.html#__codelineno-0-148">148</a></span>
<span class="normal"><a href="index.html#__codelineno-0-149">149</a></span>
<span class="normal"><a href="index.html#__codelineno-0-150">150</a></span>
<span class="normal"><a href="index.html#__codelineno-0-151">151</a></span>
<span class="normal"><a href="index.html#__codelineno-0-152">152</a></span>
<span class="normal"><a href="index.html#__codelineno-0-153">153</a></span>
<span class="normal"><a href="index.html#__codelineno-0-154">154</a></span>
<span class="normal"><a href="index.html#__codelineno-0-155">155</a></span>
<span class="normal"><a href="index.html#__codelineno-0-156">156</a></span>
<span class="normal"><a href="index.html#__codelineno-0-157">157</a></span>
<span class="normal"><a href="index.html#__codelineno-0-158">158</a></span>
<span class="normal"><a href="index.html#__codelineno-0-159">159</a></span>
<span class="normal"><a href="index.html#__codelineno-0-160">160</a></span>
<span class="normal"><a href="index.html#__codelineno-0-161">161</a></span>
<span class="normal"><a href="index.html#__codelineno-0-162">162</a></span>
<span class="normal"><a href="index.html#__codelineno-0-163">163</a></span>
<span class="normal"><a href="index.html#__codelineno-0-164">164</a></span>
<span class="normal"><a href="index.html#__codelineno-0-165">165</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;0.2&quot;</span><span class="p">,</span> <span class="n">removal</span><span class="o">=</span><span class="s2">&quot;0.3&quot;</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;single_turn_ascore&quot;</span><span class="p">)</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="k">def</span><span class="w"> </span><span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n">Callbacks</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    Calculates the score for a single row of data.</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134"></a>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    Note</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    ----</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">    This method is deprecated and will be removed in 0.3. Please use `single_turn_ascore` or `multi_turn_ascore` instead.</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="n">callbacks</span> <span class="o">=</span> <span class="n">callbacks</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="n">rm</span><span class="p">,</span> <span class="n">group_cm</span> <span class="o">=</span> <span class="n">new_group</span><span class="p">(</span>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">inputs</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ChainType</span><span class="o">.</span><span class="n">METRIC</span><span class="p">},</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="p">)</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="k">if</span> <span class="n">is_event_loop_running</span><span class="p">():</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149"></a>                <span class="kn">import</span><span class="w"> </span><span class="nn">nest_asyncio</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150"></a>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151"></a>                <span class="n">nest_asyncio</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152"></a>            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153"></a>                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154"></a>                    <span class="s2">&quot;It seems like your running this in a jupyter-like environment. Please install nest_asyncio with `pip install nest_asyncio` to make it work.&quot;</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155"></a>                <span class="p">)</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">score</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ascore</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">group_cm</span><span class="p">))</span>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161"></a>        <span class="k">raise</span> <span class="n">e</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_end</span><span class="p">({</span><span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">})</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165"></a>    <span class="k">return</span> <span class="n">score</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="zibly.metrics.Metric.ascore" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">ascore</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">ascore</span><span class="p">(</span><span class="n">row</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="langchain_core.callbacks.Callbacks">Callbacks</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="float">float</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="float">float</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Asynchronously calculates the score for a single row of data.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>This method is deprecated and will be removed in 0.3. Please use <code>single_turn_ascore</code> instead.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/zibly/metrics/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-167">167</a></span>
<span class="normal"><a href="index.html#__codelineno-0-168">168</a></span>
<span class="normal"><a href="index.html#__codelineno-0-169">169</a></span>
<span class="normal"><a href="index.html#__codelineno-0-170">170</a></span>
<span class="normal"><a href="index.html#__codelineno-0-171">171</a></span>
<span class="normal"><a href="index.html#__codelineno-0-172">172</a></span>
<span class="normal"><a href="index.html#__codelineno-0-173">173</a></span>
<span class="normal"><a href="index.html#__codelineno-0-174">174</a></span>
<span class="normal"><a href="index.html#__codelineno-0-175">175</a></span>
<span class="normal"><a href="index.html#__codelineno-0-176">176</a></span>
<span class="normal"><a href="index.html#__codelineno-0-177">177</a></span>
<span class="normal"><a href="index.html#__codelineno-0-178">178</a></span>
<span class="normal"><a href="index.html#__codelineno-0-179">179</a></span>
<span class="normal"><a href="index.html#__codelineno-0-180">180</a></span>
<span class="normal"><a href="index.html#__codelineno-0-181">181</a></span>
<span class="normal"><a href="index.html#__codelineno-0-182">182</a></span>
<span class="normal"><a href="index.html#__codelineno-0-183">183</a></span>
<span class="normal"><a href="index.html#__codelineno-0-184">184</a></span>
<span class="normal"><a href="index.html#__codelineno-0-185">185</a></span>
<span class="normal"><a href="index.html#__codelineno-0-186">186</a></span>
<span class="normal"><a href="index.html#__codelineno-0-187">187</a></span>
<span class="normal"><a href="index.html#__codelineno-0-188">188</a></span>
<span class="normal"><a href="index.html#__codelineno-0-189">189</a></span>
<span class="normal"><a href="index.html#__codelineno-0-190">190</a></span>
<span class="normal"><a href="index.html#__codelineno-0-191">191</a></span>
<span class="normal"><a href="index.html#__codelineno-0-192">192</a></span>
<span class="normal"><a href="index.html#__codelineno-0-193">193</a></span>
<span class="normal"><a href="index.html#__codelineno-0-194">194</a></span>
<span class="normal"><a href="index.html#__codelineno-0-195">195</a></span>
<span class="normal"><a href="index.html#__codelineno-0-196">196</a></span>
<span class="normal"><a href="index.html#__codelineno-0-197">197</a></span>
<span class="normal"><a href="index.html#__codelineno-0-198">198</a></span>
<span class="normal"><a href="index.html#__codelineno-0-199">199</a></span>
<span class="normal"><a href="index.html#__codelineno-0-200">200</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;0.2&quot;</span><span class="p">,</span> <span class="n">removal</span><span class="o">=</span><span class="s2">&quot;0.3&quot;</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;single_turn_ascore&quot;</span><span class="p">)</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ascore</span><span class="p">(</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">row</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">,</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">callbacks</span><span class="p">:</span> <span class="n">Callbacks</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="n">timeout</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">    Asynchronously calculates the score for a single row of data.</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176"></a>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">    Note</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    ----</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">    This method is deprecated and will be removed in 0.3. Please use `single_turn_ascore` instead.</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="n">callbacks</span> <span class="o">=</span> <span class="n">callbacks</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">rm</span><span class="p">,</span> <span class="n">group_cm</span> <span class="o">=</span> <span class="n">new_group</span><span class="p">(</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">inputs</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186"></a>        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ChainType</span><span class="o">.</span><span class="n">METRIC</span><span class="p">},</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187"></a>    <span class="p">)</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189"></a>        <span class="n">score</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_ascore</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">group_cm</span><span class="p">),</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="p">)</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="k">raise</span> <span class="n">e</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_end</span><span class="p">({</span><span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">})</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="k">return</span> <span class="n">score</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.MetricType" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MetricType</span>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>


        <p>Enumeration of metric types in Zibly.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.MetricType.SINGLE_TURN">SINGLE_TURN</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Represents a single-turn metric type.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.MetricType.MULTI_TURN">MULTI_TURN</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Represents a multi-turn metric type.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.MetricWithLLM" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MetricWithLLM</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">MetricWithLLM</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="n"><span title="dict">dict</span></span><span class="p">(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">llm</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.metrics.base.MetricOutputType">MetricOutputType</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.Metric">Metric</a></code>, <code><a class="autorefs autorefs-internal" href="../prompt/index.html#zibly.prompt.PromptMixin">PromptMixin</a></code></p>


        <p>A metric class that uses a language model for evaluation.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="zibly.metrics.MetricWithLLM.llm">llm</span></code></td>
            <td>
                  <code><span title="Optional">Optional</span>[<a class="autorefs autorefs-internal" href="../llms/index.html#zibly.llms.BaseZiblyLLM">BaseZiblyLLM</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The language model used for the metric.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="zibly.metrics.MetricWithLLM.train" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">train</span>


</h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">train</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">run_id</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">demonstration_config</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.config.DemonstrationConfig">DemonstrationConfig</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">instruction_config</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="zibly.config.InstructionConfig">InstructionConfig</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="langchain_core.callbacks.Callbacks">Callbacks</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">run_config</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="../run_config/index.html#zibly.run_config.RunConfig">RunConfig</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="int">int</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">with_debugging_logs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">raise_exceptions</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Train the metric using local JSON data or annotations from Zibly platform</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to local JSON training data file</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Direct run ID to fetch annotations</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>demonstration_config</code>
            </td>
            <td>
                  <code><span title="zibly.config.DemonstrationConfig">DemonstrationConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for demonstration optimization</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>instruction_config</code>
            </td>
            <td>
                  <code><span title="zibly.config.InstructionConfig">InstructionConfig</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration for instruction optimization</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>callbacks</code>
            </td>
            <td>
                  <code><span title="langchain_core.callbacks.Callbacks">Callbacks</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of callback functions</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" href="../run_config/index.html#zibly.run_config.RunConfig">RunConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Run configuration</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Batch size for training</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>with_debugging_logs</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Enable debugging logs</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>raise_exceptions</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to raise exceptions during training</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If invalid combination of path, and run_id is provided</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/zibly/metrics/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-345">345</a></span>
<span class="normal"><a href="index.html#__codelineno-0-346">346</a></span>
<span class="normal"><a href="index.html#__codelineno-0-347">347</a></span>
<span class="normal"><a href="index.html#__codelineno-0-348">348</a></span>
<span class="normal"><a href="index.html#__codelineno-0-349">349</a></span>
<span class="normal"><a href="index.html#__codelineno-0-350">350</a></span>
<span class="normal"><a href="index.html#__codelineno-0-351">351</a></span>
<span class="normal"><a href="index.html#__codelineno-0-352">352</a></span>
<span class="normal"><a href="index.html#__codelineno-0-353">353</a></span>
<span class="normal"><a href="index.html#__codelineno-0-354">354</a></span>
<span class="normal"><a href="index.html#__codelineno-0-355">355</a></span>
<span class="normal"><a href="index.html#__codelineno-0-356">356</a></span>
<span class="normal"><a href="index.html#__codelineno-0-357">357</a></span>
<span class="normal"><a href="index.html#__codelineno-0-358">358</a></span>
<span class="normal"><a href="index.html#__codelineno-0-359">359</a></span>
<span class="normal"><a href="index.html#__codelineno-0-360">360</a></span>
<span class="normal"><a href="index.html#__codelineno-0-361">361</a></span>
<span class="normal"><a href="index.html#__codelineno-0-362">362</a></span>
<span class="normal"><a href="index.html#__codelineno-0-363">363</a></span>
<span class="normal"><a href="index.html#__codelineno-0-364">364</a></span>
<span class="normal"><a href="index.html#__codelineno-0-365">365</a></span>
<span class="normal"><a href="index.html#__codelineno-0-366">366</a></span>
<span class="normal"><a href="index.html#__codelineno-0-367">367</a></span>
<span class="normal"><a href="index.html#__codelineno-0-368">368</a></span>
<span class="normal"><a href="index.html#__codelineno-0-369">369</a></span>
<span class="normal"><a href="index.html#__codelineno-0-370">370</a></span>
<span class="normal"><a href="index.html#__codelineno-0-371">371</a></span>
<span class="normal"><a href="index.html#__codelineno-0-372">372</a></span>
<span class="normal"><a href="index.html#__codelineno-0-373">373</a></span>
<span class="normal"><a href="index.html#__codelineno-0-374">374</a></span>
<span class="normal"><a href="index.html#__codelineno-0-375">375</a></span>
<span class="normal"><a href="index.html#__codelineno-0-376">376</a></span>
<span class="normal"><a href="index.html#__codelineno-0-377">377</a></span>
<span class="normal"><a href="index.html#__codelineno-0-378">378</a></span>
<span class="normal"><a href="index.html#__codelineno-0-379">379</a></span>
<span class="normal"><a href="index.html#__codelineno-0-380">380</a></span>
<span class="normal"><a href="index.html#__codelineno-0-381">381</a></span>
<span class="normal"><a href="index.html#__codelineno-0-382">382</a></span>
<span class="normal"><a href="index.html#__codelineno-0-383">383</a></span>
<span class="normal"><a href="index.html#__codelineno-0-384">384</a></span>
<span class="normal"><a href="index.html#__codelineno-0-385">385</a></span>
<span class="normal"><a href="index.html#__codelineno-0-386">386</a></span>
<span class="normal"><a href="index.html#__codelineno-0-387">387</a></span>
<span class="normal"><a href="index.html#__codelineno-0-388">388</a></span>
<span class="normal"><a href="index.html#__codelineno-0-389">389</a></span>
<span class="normal"><a href="index.html#__codelineno-0-390">390</a></span>
<span class="normal"><a href="index.html#__codelineno-0-391">391</a></span>
<span class="normal"><a href="index.html#__codelineno-0-392">392</a></span>
<span class="normal"><a href="index.html#__codelineno-0-393">393</a></span>
<span class="normal"><a href="index.html#__codelineno-0-394">394</a></span>
<span class="normal"><a href="index.html#__codelineno-0-395">395</a></span>
<span class="normal"><a href="index.html#__codelineno-0-396">396</a></span>
<span class="normal"><a href="index.html#__codelineno-0-397">397</a></span>
<span class="normal"><a href="index.html#__codelineno-0-398">398</a></span>
<span class="normal"><a href="index.html#__codelineno-0-399">399</a></span>
<span class="normal"><a href="index.html#__codelineno-0-400">400</a></span>
<span class="normal"><a href="index.html#__codelineno-0-401">401</a></span>
<span class="normal"><a href="index.html#__codelineno-0-402">402</a></span>
<span class="normal"><a href="index.html#__codelineno-0-403">403</a></span>
<span class="normal"><a href="index.html#__codelineno-0-404">404</a></span>
<span class="normal"><a href="index.html#__codelineno-0-405">405</a></span>
<span class="normal"><a href="index.html#__codelineno-0-406">406</a></span>
<span class="normal"><a href="index.html#__codelineno-0-407">407</a></span>
<span class="normal"><a href="index.html#__codelineno-0-408">408</a></span>
<span class="normal"><a href="index.html#__codelineno-0-409">409</a></span>
<span class="normal"><a href="index.html#__codelineno-0-410">410</a></span>
<span class="normal"><a href="index.html#__codelineno-0-411">411</a></span>
<span class="normal"><a href="index.html#__codelineno-0-412">412</a></span>
<span class="normal"><a href="index.html#__codelineno-0-413">413</a></span>
<span class="normal"><a href="index.html#__codelineno-0-414">414</a></span>
<span class="normal"><a href="index.html#__codelineno-0-415">415</a></span>
<span class="normal"><a href="index.html#__codelineno-0-416">416</a></span>
<span class="normal"><a href="index.html#__codelineno-0-417">417</a></span>
<span class="normal"><a href="index.html#__codelineno-0-418">418</a></span>
<span class="normal"><a href="index.html#__codelineno-0-419">419</a></span>
<span class="normal"><a href="index.html#__codelineno-0-420">420</a></span>
<span class="normal"><a href="index.html#__codelineno-0-421">421</a></span>
<span class="normal"><a href="index.html#__codelineno-0-422">422</a></span>
<span class="normal"><a href="index.html#__codelineno-0-423">423</a></span>
<span class="normal"><a href="index.html#__codelineno-0-424">424</a></span>
<span class="normal"><a href="index.html#__codelineno-0-425">425</a></span>
<span class="normal"><a href="index.html#__codelineno-0-426">426</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347"></a>    <span class="n">path</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348"></a>    <span class="n">run_id</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349"></a>    <span class="n">demonstration_config</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">DemonstrationConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350"></a>    <span class="n">instruction_config</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">InstructionConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351"></a>    <span class="n">callbacks</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">Callbacks</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352"></a>    <span class="n">run_config</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">RunConfig</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353"></a>    <span class="n">batch_size</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354"></a>    <span class="n">with_debugging_logs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355"></a>    <span class="n">raise_exceptions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">    Train the metric using local JSON data or annotations from Zibly platform</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359"></a>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">    Parameters</span>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">    ----------</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">    path : str, optional</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        Path to local JSON training data file</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">    run_id : str, optional</span>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        Direct run ID to fetch annotations</span>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">    demonstration_config : DemonstrationConfig, optional</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        Configuration for demonstration optimization</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">    instruction_config : InstructionConfig, optional</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">        Configuration for instruction optimization</span>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">    callbacks : Callbacks, optional</span>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        List of callback functions</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">    run_config : RunConfig, optional</span>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        Run configuration</span>
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">    batch_size : int, optional</span>
</span><span id="__span-0-375"><a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">        Batch size for training</span>
</span><span id="__span-0-376"><a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">    with_debugging_logs : bool, default=False</span>
</span><span id="__span-0-377"><a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">        Enable debugging logs</span>
</span><span id="__span-0-378"><a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">    raise_exceptions : bool, default=True</span>
</span><span id="__span-0-379"><a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        Whether to raise exceptions during training</span>
</span><span id="__span-0-380"><a id="__codelineno-0-380" name="__codelineno-0-380"></a>
</span><span id="__span-0-381"><a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="sd">    Raises</span>
</span><span id="__span-0-382"><a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">    ------</span>
</span><span id="__span-0-383"><a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">    ValueError</span>
</span><span id="__span-0-384"><a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">        If invalid combination of path, and run_id is provided</span>
</span><span id="__span-0-385"><a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-386"><a id="__codelineno-0-386" name="__codelineno-0-386"></a>    <span class="c1"># Validate input parameters</span>
</span><span id="__span-0-387"><a id="__codelineno-0-387" name="__codelineno-0-387"></a>    <span class="n">provided_inputs</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">path</span><span class="p">,</span> <span class="n">run_id</span><span class="p">])</span>
</span><span id="__span-0-388"><a id="__codelineno-0-388" name="__codelineno-0-388"></a>    <span class="k">if</span> <span class="n">provided_inputs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-0-389"><a id="__codelineno-0-389" name="__codelineno-0-389"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;One of path or run_id must be provided&quot;</span><span class="p">)</span>
</span><span id="__span-0-390"><a id="__codelineno-0-390" name="__codelineno-0-390"></a>    <span class="k">if</span> <span class="n">provided_inputs</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-0-391"><a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Only one of path or run_id should be provided&quot;</span><span class="p">)</span>
</span><span id="__span-0-392"><a id="__codelineno-0-392" name="__codelineno-0-392"></a>
</span><span id="__span-0-393"><a id="__codelineno-0-393" name="__codelineno-0-393"></a>    <span class="n">run_config</span> <span class="o">=</span> <span class="n">run_config</span> <span class="ow">or</span> <span class="n">RunConfig</span><span class="p">()</span>
</span><span id="__span-0-394"><a id="__codelineno-0-394" name="__codelineno-0-394"></a>    <span class="n">callbacks</span> <span class="o">=</span> <span class="n">callbacks</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="__span-0-395"><a id="__codelineno-0-395" name="__codelineno-0-395"></a>
</span><span id="__span-0-396"><a id="__codelineno-0-396" name="__codelineno-0-396"></a>    <span class="c1"># Load the dataset based on input type</span>
</span><span id="__span-0-397"><a id="__codelineno-0-397" name="__codelineno-0-397"></a>    <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-398"><a id="__codelineno-0-398" name="__codelineno-0-398"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
</span><span id="__span-0-399"><a id="__codelineno-0-399" name="__codelineno-0-399"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Train data must be in json format&quot;</span><span class="p">)</span>
</span><span id="__span-0-400"><a id="__codelineno-0-400" name="__codelineno-0-400"></a>        <span class="n">dataset</span> <span class="o">=</span> <span class="n">MetricAnnotation</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">metric_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-0-401"><a id="__codelineno-0-401" name="__codelineno-0-401"></a>    <span class="k">elif</span> <span class="n">run_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-402"><a id="__codelineno-0-402" name="__codelineno-0-402"></a>        <span class="n">dataset</span> <span class="o">=</span> <span class="n">MetricAnnotation</span><span class="o">.</span><span class="n">from_app</span><span class="p">(</span>
</span><span id="__span-0-403"><a id="__codelineno-0-403" name="__codelineno-0-403"></a>            <span class="n">run_id</span><span class="o">=</span><span class="n">run_id</span><span class="p">,</span>
</span><span id="__span-0-404"><a id="__codelineno-0-404" name="__codelineno-0-404"></a>            <span class="n">metric_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-405"><a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="p">)</span>
</span><span id="__span-0-406"><a id="__codelineno-0-406" name="__codelineno-0-406"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-407"><a id="__codelineno-0-407" name="__codelineno-0-407"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;One of path or run_id must be provided&quot;</span><span class="p">)</span>
</span><span id="__span-0-408"><a id="__codelineno-0-408" name="__codelineno-0-408"></a>
</span><span id="__span-0-409"><a id="__codelineno-0-409" name="__codelineno-0-409"></a>    <span class="c1"># only optimize the instruction if instruction_config is provided</span>
</span><span id="__span-0-410"><a id="__codelineno-0-410" name="__codelineno-0-410"></a>    <span class="k">if</span> <span class="n">instruction_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-411"><a id="__codelineno-0-411" name="__codelineno-0-411"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimize_instruction</span><span class="p">(</span>
</span><span id="__span-0-412"><a id="__codelineno-0-412" name="__codelineno-0-412"></a>            <span class="n">instruction_config</span><span class="o">=</span><span class="n">instruction_config</span><span class="p">,</span>
</span><span id="__span-0-413"><a id="__codelineno-0-413" name="__codelineno-0-413"></a>            <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
</span><span id="__span-0-414"><a id="__codelineno-0-414" name="__codelineno-0-414"></a>            <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
</span><span id="__span-0-415"><a id="__codelineno-0-415" name="__codelineno-0-415"></a>            <span class="n">run_config</span><span class="o">=</span><span class="n">run_config</span><span class="p">,</span>
</span><span id="__span-0-416"><a id="__codelineno-0-416" name="__codelineno-0-416"></a>            <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
</span><span id="__span-0-417"><a id="__codelineno-0-417" name="__codelineno-0-417"></a>            <span class="n">with_debugging_logs</span><span class="o">=</span><span class="n">with_debugging_logs</span><span class="p">,</span>
</span><span id="__span-0-418"><a id="__codelineno-0-418" name="__codelineno-0-418"></a>            <span class="n">raise_exceptions</span><span class="o">=</span><span class="n">raise_exceptions</span><span class="p">,</span>
</span><span id="__span-0-419"><a id="__codelineno-0-419" name="__codelineno-0-419"></a>        <span class="p">)</span>
</span><span id="__span-0-420"><a id="__codelineno-0-420" name="__codelineno-0-420"></a>
</span><span id="__span-0-421"><a id="__codelineno-0-421" name="__codelineno-0-421"></a>    <span class="c1"># if demonstration_config is provided, optimize the demonstrations</span>
</span><span id="__span-0-422"><a id="__codelineno-0-422" name="__codelineno-0-422"></a>    <span class="k">if</span> <span class="n">demonstration_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-423"><a id="__codelineno-0-423" name="__codelineno-0-423"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_optimize_demonstration</span><span class="p">(</span>
</span><span id="__span-0-424"><a id="__codelineno-0-424" name="__codelineno-0-424"></a>            <span class="n">demonstration_config</span><span class="o">=</span><span class="n">demonstration_config</span><span class="p">,</span>
</span><span id="__span-0-425"><a id="__codelineno-0-425" name="__codelineno-0-425"></a>            <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
</span><span id="__span-0-426"><a id="__codelineno-0-426" name="__codelineno-0-426"></a>        <span class="p">)</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.MultiTurnMetric" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MultiTurnMetric</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">MultiTurnMetric</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="n"><span title="dict">dict</span></span><span class="p">(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.Metric">Metric</a></code></p>


        <p>A metric class for evaluating multi-turn conversations.</p>
<p>This class extends the base Metric class to provide functionality
for scoring multi-turn conversation samples.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="zibly.metrics.MultiTurnMetric.multi_turn_score" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">multi_turn_score</span>


</h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">multi_turn_score</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../evaluation_schema/index.html#zibly.dataset_schema.MultiTurnSample">MultiTurnSample</a></span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="langchain_core.callbacks.Callbacks">Callbacks</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="float">float</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Score a multi-turn conversation sample synchronously.</p>
<p>May raise ImportError if nest_asyncio is not installed in Jupyter-like environments.</p>


            <details class="quote">
              <summary>Source code in <code>src/zibly/metrics/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-590">590</a></span>
<span class="normal"><a href="index.html#__codelineno-0-591">591</a></span>
<span class="normal"><a href="index.html#__codelineno-0-592">592</a></span>
<span class="normal"><a href="index.html#__codelineno-0-593">593</a></span>
<span class="normal"><a href="index.html#__codelineno-0-594">594</a></span>
<span class="normal"><a href="index.html#__codelineno-0-595">595</a></span>
<span class="normal"><a href="index.html#__codelineno-0-596">596</a></span>
<span class="normal"><a href="index.html#__codelineno-0-597">597</a></span>
<span class="normal"><a href="index.html#__codelineno-0-598">598</a></span>
<span class="normal"><a href="index.html#__codelineno-0-599">599</a></span>
<span class="normal"><a href="index.html#__codelineno-0-600">600</a></span>
<span class="normal"><a href="index.html#__codelineno-0-601">601</a></span>
<span class="normal"><a href="index.html#__codelineno-0-602">602</a></span>
<span class="normal"><a href="index.html#__codelineno-0-603">603</a></span>
<span class="normal"><a href="index.html#__codelineno-0-604">604</a></span>
<span class="normal"><a href="index.html#__codelineno-0-605">605</a></span>
<span class="normal"><a href="index.html#__codelineno-0-606">606</a></span>
<span class="normal"><a href="index.html#__codelineno-0-607">607</a></span>
<span class="normal"><a href="index.html#__codelineno-0-608">608</a></span>
<span class="normal"><a href="index.html#__codelineno-0-609">609</a></span>
<span class="normal"><a href="index.html#__codelineno-0-610">610</a></span>
<span class="normal"><a href="index.html#__codelineno-0-611">611</a></span>
<span class="normal"><a href="index.html#__codelineno-0-612">612</a></span>
<span class="normal"><a href="index.html#__codelineno-0-613">613</a></span>
<span class="normal"><a href="index.html#__codelineno-0-614">614</a></span>
<span class="normal"><a href="index.html#__codelineno-0-615">615</a></span>
<span class="normal"><a href="index.html#__codelineno-0-616">616</a></span>
<span class="normal"><a href="index.html#__codelineno-0-617">617</a></span>
<span class="normal"><a href="index.html#__codelineno-0-618">618</a></span>
<span class="normal"><a href="index.html#__codelineno-0-619">619</a></span>
<span class="normal"><a href="index.html#__codelineno-0-620">620</a></span>
<span class="normal"><a href="index.html#__codelineno-0-621">621</a></span>
<span class="normal"><a href="index.html#__codelineno-0-622">622</a></span>
<span class="normal"><a href="index.html#__codelineno-0-623">623</a></span>
<span class="normal"><a href="index.html#__codelineno-0-624">624</a></span>
<span class="normal"><a href="index.html#__codelineno-0-625">625</a></span>
<span class="normal"><a href="index.html#__codelineno-0-626">626</a></span>
<span class="normal"><a href="index.html#__codelineno-0-627">627</a></span>
<span class="normal"><a href="index.html#__codelineno-0-628">628</a></span>
<span class="normal"><a href="index.html#__codelineno-0-629">629</a></span>
<span class="normal"><a href="index.html#__codelineno-0-630">630</a></span>
<span class="normal"><a href="index.html#__codelineno-0-631">631</a></span>
<span class="normal"><a href="index.html#__codelineno-0-632">632</a></span>
<span class="normal"><a href="index.html#__codelineno-0-633">633</a></span>
<span class="normal"><a href="index.html#__codelineno-0-634">634</a></span>
<span class="normal"><a href="index.html#__codelineno-0-635">635</a></span>
<span class="normal"><a href="index.html#__codelineno-0-636">636</a></span>
<span class="normal"><a href="index.html#__codelineno-0-637">637</a></span>
<span class="normal"><a href="index.html#__codelineno-0-638">638</a></span>
<span class="normal"><a href="index.html#__codelineno-0-639">639</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-590"><a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="k">def</span><span class="w"> </span><span class="nf">multi_turn_score</span><span class="p">(</span>
</span><span id="__span-0-591"><a id="__codelineno-0-591" name="__codelineno-0-591"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-592"><a id="__codelineno-0-592" name="__codelineno-0-592"></a>    <span class="n">sample</span><span class="p">:</span> <span class="n">MultiTurnSample</span><span class="p">,</span>
</span><span id="__span-0-593"><a id="__codelineno-0-593" name="__codelineno-0-593"></a>    <span class="n">callbacks</span><span class="p">:</span> <span class="n">Callbacks</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-594"><a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-595"><a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-596"><a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">    Score a multi-turn conversation sample synchronously.</span>
</span><span id="__span-0-597"><a id="__codelineno-0-597" name="__codelineno-0-597"></a>
</span><span id="__span-0-598"><a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">    May raise ImportError if nest_asyncio is not installed in Jupyter-like environments.</span>
</span><span id="__span-0-599"><a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-600"><a id="__codelineno-0-600" name="__codelineno-0-600"></a>    <span class="n">callbacks</span> <span class="o">=</span> <span class="n">callbacks</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="__span-0-601"><a id="__codelineno-0-601" name="__codelineno-0-601"></a>    <span class="n">sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_only_required_columns_multi_turn</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="__span-0-602"><a id="__codelineno-0-602" name="__codelineno-0-602"></a>    <span class="n">rm</span><span class="p">,</span> <span class="n">group_cm</span> <span class="o">=</span> <span class="n">new_group</span><span class="p">(</span>
</span><span id="__span-0-603"><a id="__codelineno-0-603" name="__codelineno-0-603"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-604"><a id="__codelineno-0-604" name="__codelineno-0-604"></a>        <span class="n">inputs</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span>
</span><span id="__span-0-605"><a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
</span><span id="__span-0-606"><a id="__codelineno-0-606" name="__codelineno-0-606"></a>        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ChainType</span><span class="o">.</span><span class="n">METRIC</span><span class="p">},</span>
</span><span id="__span-0-607"><a id="__codelineno-0-607" name="__codelineno-0-607"></a>    <span class="p">)</span>
</span><span id="__span-0-608"><a id="__codelineno-0-608" name="__codelineno-0-608"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-609"><a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="k">if</span> <span class="n">is_event_loop_running</span><span class="p">():</span>
</span><span id="__span-0-610"><a id="__codelineno-0-610" name="__codelineno-0-610"></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-611"><a id="__codelineno-0-611" name="__codelineno-0-611"></a>                <span class="kn">import</span><span class="w"> </span><span class="nn">nest_asyncio</span>
</span><span id="__span-0-612"><a id="__codelineno-0-612" name="__codelineno-0-612"></a>
</span><span id="__span-0-613"><a id="__codelineno-0-613" name="__codelineno-0-613"></a>                <span class="n">nest_asyncio</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
</span><span id="__span-0-614"><a id="__codelineno-0-614" name="__codelineno-0-614"></a>            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span id="__span-0-615"><a id="__codelineno-0-615" name="__codelineno-0-615"></a>                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
</span><span id="__span-0-616"><a id="__codelineno-0-616" name="__codelineno-0-616"></a>                    <span class="s2">&quot;It seems like your running this in a jupyter-like environment. Please install nest_asyncio with `pip install nest_asyncio` to make it work.&quot;</span>
</span><span id="__span-0-617"><a id="__codelineno-0-617" name="__codelineno-0-617"></a>                <span class="p">)</span>
</span><span id="__span-0-618"><a id="__codelineno-0-618" name="__codelineno-0-618"></a>        <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
</span><span id="__span-0-619"><a id="__codelineno-0-619" name="__codelineno-0-619"></a>        <span class="n">score</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span>
</span><span id="__span-0-620"><a id="__codelineno-0-620" name="__codelineno-0-620"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_multi_turn_ascore</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">sample</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">group_cm</span><span class="p">)</span>
</span><span id="__span-0-621"><a id="__codelineno-0-621" name="__codelineno-0-621"></a>        <span class="p">)</span>
</span><span id="__span-0-622"><a id="__codelineno-0-622" name="__codelineno-0-622"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-623"><a id="__codelineno-0-623" name="__codelineno-0-623"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-624"><a id="__codelineno-0-624" name="__codelineno-0-624"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-625"><a id="__codelineno-0-625" name="__codelineno-0-625"></a>        <span class="k">raise</span> <span class="n">e</span>
</span><span id="__span-0-626"><a id="__codelineno-0-626" name="__codelineno-0-626"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-627"><a id="__codelineno-0-627" name="__codelineno-0-627"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-628"><a id="__codelineno-0-628" name="__codelineno-0-628"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_end</span><span class="p">({</span><span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">})</span>
</span><span id="__span-0-629"><a id="__codelineno-0-629" name="__codelineno-0-629"></a>
</span><span id="__span-0-630"><a id="__codelineno-0-630" name="__codelineno-0-630"></a>    <span class="c1"># track the evaluation event</span>
</span><span id="__span-0-631"><a id="__codelineno-0-631" name="__codelineno-0-631"></a>    <span class="n">_analytics_batcher</span><span class="o">.</span><span class="n">add_evaluation</span><span class="p">(</span>
</span><span id="__span-0-632"><a id="__codelineno-0-632" name="__codelineno-0-632"></a>        <span class="n">EvaluationEvent</span><span class="p">(</span>
</span><span id="__span-0-633"><a id="__codelineno-0-633" name="__codelineno-0-633"></a>            <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="__span-0-634"><a id="__codelineno-0-634" name="__codelineno-0-634"></a>            <span class="n">num_rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-635"><a id="__codelineno-0-635" name="__codelineno-0-635"></a>            <span class="n">evaluation_type</span><span class="o">=</span><span class="n">MetricType</span><span class="o">.</span><span class="n">SINGLE_TURN</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-636"><a id="__codelineno-0-636" name="__codelineno-0-636"></a>            <span class="n">language</span><span class="o">=</span><span class="n">get_metric_language</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
</span><span id="__span-0-637"><a id="__codelineno-0-637" name="__codelineno-0-637"></a>        <span class="p">)</span>
</span><span id="__span-0-638"><a id="__codelineno-0-638" name="__codelineno-0-638"></a>    <span class="p">)</span>
</span><span id="__span-0-639"><a id="__codelineno-0-639" name="__codelineno-0-639"></a>    <span class="k">return</span> <span class="n">score</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="zibly.metrics.MultiTurnMetric.multi_turn_ascore" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">multi_turn_ascore</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">multi_turn_ascore</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../evaluation_schema/index.html#zibly.dataset_schema.MultiTurnSample">MultiTurnSample</a></span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="langchain_core.callbacks.Callbacks">Callbacks</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="float">float</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="float">float</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Score a multi-turn conversation sample asynchronously.</p>
<p>May raise asyncio.TimeoutError if the scoring process exceeds the specified timeout.</p>


            <details class="quote">
              <summary>Source code in <code>src/zibly/metrics/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-641">641</a></span>
<span class="normal"><a href="index.html#__codelineno-0-642">642</a></span>
<span class="normal"><a href="index.html#__codelineno-0-643">643</a></span>
<span class="normal"><a href="index.html#__codelineno-0-644">644</a></span>
<span class="normal"><a href="index.html#__codelineno-0-645">645</a></span>
<span class="normal"><a href="index.html#__codelineno-0-646">646</a></span>
<span class="normal"><a href="index.html#__codelineno-0-647">647</a></span>
<span class="normal"><a href="index.html#__codelineno-0-648">648</a></span>
<span class="normal"><a href="index.html#__codelineno-0-649">649</a></span>
<span class="normal"><a href="index.html#__codelineno-0-650">650</a></span>
<span class="normal"><a href="index.html#__codelineno-0-651">651</a></span>
<span class="normal"><a href="index.html#__codelineno-0-652">652</a></span>
<span class="normal"><a href="index.html#__codelineno-0-653">653</a></span>
<span class="normal"><a href="index.html#__codelineno-0-654">654</a></span>
<span class="normal"><a href="index.html#__codelineno-0-655">655</a></span>
<span class="normal"><a href="index.html#__codelineno-0-656">656</a></span>
<span class="normal"><a href="index.html#__codelineno-0-657">657</a></span>
<span class="normal"><a href="index.html#__codelineno-0-658">658</a></span>
<span class="normal"><a href="index.html#__codelineno-0-659">659</a></span>
<span class="normal"><a href="index.html#__codelineno-0-660">660</a></span>
<span class="normal"><a href="index.html#__codelineno-0-661">661</a></span>
<span class="normal"><a href="index.html#__codelineno-0-662">662</a></span>
<span class="normal"><a href="index.html#__codelineno-0-663">663</a></span>
<span class="normal"><a href="index.html#__codelineno-0-664">664</a></span>
<span class="normal"><a href="index.html#__codelineno-0-665">665</a></span>
<span class="normal"><a href="index.html#__codelineno-0-666">666</a></span>
<span class="normal"><a href="index.html#__codelineno-0-667">667</a></span>
<span class="normal"><a href="index.html#__codelineno-0-668">668</a></span>
<span class="normal"><a href="index.html#__codelineno-0-669">669</a></span>
<span class="normal"><a href="index.html#__codelineno-0-670">670</a></span>
<span class="normal"><a href="index.html#__codelineno-0-671">671</a></span>
<span class="normal"><a href="index.html#__codelineno-0-672">672</a></span>
<span class="normal"><a href="index.html#__codelineno-0-673">673</a></span>
<span class="normal"><a href="index.html#__codelineno-0-674">674</a></span>
<span class="normal"><a href="index.html#__codelineno-0-675">675</a></span>
<span class="normal"><a href="index.html#__codelineno-0-676">676</a></span>
<span class="normal"><a href="index.html#__codelineno-0-677">677</a></span>
<span class="normal"><a href="index.html#__codelineno-0-678">678</a></span>
<span class="normal"><a href="index.html#__codelineno-0-679">679</a></span>
<span class="normal"><a href="index.html#__codelineno-0-680">680</a></span>
<span class="normal"><a href="index.html#__codelineno-0-681">681</a></span>
<span class="normal"><a href="index.html#__codelineno-0-682">682</a></span>
<span class="normal"><a href="index.html#__codelineno-0-683">683</a></span>
<span class="normal"><a href="index.html#__codelineno-0-684">684</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-641"><a id="__codelineno-0-641" name="__codelineno-0-641"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">multi_turn_ascore</span><span class="p">(</span>
</span><span id="__span-0-642"><a id="__codelineno-0-642" name="__codelineno-0-642"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-643"><a id="__codelineno-0-643" name="__codelineno-0-643"></a>    <span class="n">sample</span><span class="p">:</span> <span class="n">MultiTurnSample</span><span class="p">,</span>
</span><span id="__span-0-644"><a id="__codelineno-0-644" name="__codelineno-0-644"></a>    <span class="n">callbacks</span><span class="p">:</span> <span class="n">Callbacks</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-645"><a id="__codelineno-0-645" name="__codelineno-0-645"></a>    <span class="n">timeout</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-646"><a id="__codelineno-0-646" name="__codelineno-0-646"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-647"><a id="__codelineno-0-647" name="__codelineno-0-647"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-648"><a id="__codelineno-0-648" name="__codelineno-0-648"></a><span class="sd">    Score a multi-turn conversation sample asynchronously.</span>
</span><span id="__span-0-649"><a id="__codelineno-0-649" name="__codelineno-0-649"></a>
</span><span id="__span-0-650"><a id="__codelineno-0-650" name="__codelineno-0-650"></a><span class="sd">    May raise asyncio.TimeoutError if the scoring process exceeds the specified timeout.</span>
</span><span id="__span-0-651"><a id="__codelineno-0-651" name="__codelineno-0-651"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-652"><a id="__codelineno-0-652" name="__codelineno-0-652"></a>    <span class="n">callbacks</span> <span class="o">=</span> <span class="n">callbacks</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="__span-0-653"><a id="__codelineno-0-653" name="__codelineno-0-653"></a>    <span class="n">sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_only_required_columns_multi_turn</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="__span-0-654"><a id="__codelineno-0-654" name="__codelineno-0-654"></a>
</span><span id="__span-0-655"><a id="__codelineno-0-655" name="__codelineno-0-655"></a>    <span class="n">rm</span><span class="p">,</span> <span class="n">group_cm</span> <span class="o">=</span> <span class="n">new_group</span><span class="p">(</span>
</span><span id="__span-0-656"><a id="__codelineno-0-656" name="__codelineno-0-656"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-657"><a id="__codelineno-0-657" name="__codelineno-0-657"></a>        <span class="n">inputs</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span>
</span><span id="__span-0-658"><a id="__codelineno-0-658" name="__codelineno-0-658"></a>        <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
</span><span id="__span-0-659"><a id="__codelineno-0-659" name="__codelineno-0-659"></a>        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ChainType</span><span class="o">.</span><span class="n">METRIC</span><span class="p">},</span>
</span><span id="__span-0-660"><a id="__codelineno-0-660" name="__codelineno-0-660"></a>    <span class="p">)</span>
</span><span id="__span-0-661"><a id="__codelineno-0-661" name="__codelineno-0-661"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-662"><a id="__codelineno-0-662" name="__codelineno-0-662"></a>        <span class="n">score</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span>
</span><span id="__span-0-663"><a id="__codelineno-0-663" name="__codelineno-0-663"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_multi_turn_ascore</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">sample</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">group_cm</span><span class="p">),</span>
</span><span id="__span-0-664"><a id="__codelineno-0-664" name="__codelineno-0-664"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
</span><span id="__span-0-665"><a id="__codelineno-0-665" name="__codelineno-0-665"></a>        <span class="p">)</span>
</span><span id="__span-0-666"><a id="__codelineno-0-666" name="__codelineno-0-666"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-667"><a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-668"><a id="__codelineno-0-668" name="__codelineno-0-668"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-669"><a id="__codelineno-0-669" name="__codelineno-0-669"></a>        <span class="k">raise</span> <span class="n">e</span>
</span><span id="__span-0-670"><a id="__codelineno-0-670" name="__codelineno-0-670"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-671"><a id="__codelineno-0-671" name="__codelineno-0-671"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-672"><a id="__codelineno-0-672" name="__codelineno-0-672"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_end</span><span class="p">({</span><span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">})</span>
</span><span id="__span-0-673"><a id="__codelineno-0-673" name="__codelineno-0-673"></a>
</span><span id="__span-0-674"><a id="__codelineno-0-674" name="__codelineno-0-674"></a>    <span class="c1"># track the evaluation event</span>
</span><span id="__span-0-675"><a id="__codelineno-0-675" name="__codelineno-0-675"></a>    <span class="n">_analytics_batcher</span><span class="o">.</span><span class="n">add_evaluation</span><span class="p">(</span>
</span><span id="__span-0-676"><a id="__codelineno-0-676" name="__codelineno-0-676"></a>        <span class="n">EvaluationEvent</span><span class="p">(</span>
</span><span id="__span-0-677"><a id="__codelineno-0-677" name="__codelineno-0-677"></a>            <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="__span-0-678"><a id="__codelineno-0-678" name="__codelineno-0-678"></a>            <span class="n">num_rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-679"><a id="__codelineno-0-679" name="__codelineno-0-679"></a>            <span class="n">evaluation_type</span><span class="o">=</span><span class="n">MetricType</span><span class="o">.</span><span class="n">SINGLE_TURN</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-680"><a id="__codelineno-0-680" name="__codelineno-0-680"></a>            <span class="n">language</span><span class="o">=</span><span class="n">get_metric_language</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
</span><span id="__span-0-681"><a id="__codelineno-0-681" name="__codelineno-0-681"></a>        <span class="p">)</span>
</span><span id="__span-0-682"><a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="p">)</span>
</span><span id="__span-0-683"><a id="__codelineno-0-683" name="__codelineno-0-683"></a>
</span><span id="__span-0-684"><a id="__codelineno-0-684" name="__codelineno-0-684"></a>    <span class="k">return</span> <span class="n">score</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="zibly.metrics.SingleTurnMetric" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">SingleTurnMetric</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">SingleTurnMetric</span><span class="p">(</span><span class="n">_required_columns</span><span class="p">:</span> <span class="n"><span title="typing.Dict">Dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.MetricType">MetricType</a></span><span class="p">,</span> <span class="n"><span title="typing.Set">Set</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]]</span> <span class="o">=</span> <span class="n"><span title="dict">dict</span></span><span class="p">(),</span> <span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></code></pre></div>

    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" href="index.html#zibly.metrics.base.Metric">Metric</a></code></p>


        <p>A metric class for evaluating single-turn interactions.</p>
<p>This class provides methods to score single-turn samples, both synchronously and asynchronously.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="zibly.metrics.SingleTurnMetric.single_turn_score" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">single_turn_score</span>


</h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">single_turn_score</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../evaluation_schema/index.html#zibly.dataset_schema.SingleTurnSample">SingleTurnSample</a></span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="langchain_core.callbacks.Callbacks">Callbacks</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="float">float</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Synchronously score a single-turn sample.</p>
<p>May raise ImportError if nest_asyncio is not installed in a Jupyter-like environment.</p>


            <details class="quote">
              <summary>Source code in <code>src/zibly/metrics/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-461">461</a></span>
<span class="normal"><a href="index.html#__codelineno-0-462">462</a></span>
<span class="normal"><a href="index.html#__codelineno-0-463">463</a></span>
<span class="normal"><a href="index.html#__codelineno-0-464">464</a></span>
<span class="normal"><a href="index.html#__codelineno-0-465">465</a></span>
<span class="normal"><a href="index.html#__codelineno-0-466">466</a></span>
<span class="normal"><a href="index.html#__codelineno-0-467">467</a></span>
<span class="normal"><a href="index.html#__codelineno-0-468">468</a></span>
<span class="normal"><a href="index.html#__codelineno-0-469">469</a></span>
<span class="normal"><a href="index.html#__codelineno-0-470">470</a></span>
<span class="normal"><a href="index.html#__codelineno-0-471">471</a></span>
<span class="normal"><a href="index.html#__codelineno-0-472">472</a></span>
<span class="normal"><a href="index.html#__codelineno-0-473">473</a></span>
<span class="normal"><a href="index.html#__codelineno-0-474">474</a></span>
<span class="normal"><a href="index.html#__codelineno-0-475">475</a></span>
<span class="normal"><a href="index.html#__codelineno-0-476">476</a></span>
<span class="normal"><a href="index.html#__codelineno-0-477">477</a></span>
<span class="normal"><a href="index.html#__codelineno-0-478">478</a></span>
<span class="normal"><a href="index.html#__codelineno-0-479">479</a></span>
<span class="normal"><a href="index.html#__codelineno-0-480">480</a></span>
<span class="normal"><a href="index.html#__codelineno-0-481">481</a></span>
<span class="normal"><a href="index.html#__codelineno-0-482">482</a></span>
<span class="normal"><a href="index.html#__codelineno-0-483">483</a></span>
<span class="normal"><a href="index.html#__codelineno-0-484">484</a></span>
<span class="normal"><a href="index.html#__codelineno-0-485">485</a></span>
<span class="normal"><a href="index.html#__codelineno-0-486">486</a></span>
<span class="normal"><a href="index.html#__codelineno-0-487">487</a></span>
<span class="normal"><a href="index.html#__codelineno-0-488">488</a></span>
<span class="normal"><a href="index.html#__codelineno-0-489">489</a></span>
<span class="normal"><a href="index.html#__codelineno-0-490">490</a></span>
<span class="normal"><a href="index.html#__codelineno-0-491">491</a></span>
<span class="normal"><a href="index.html#__codelineno-0-492">492</a></span>
<span class="normal"><a href="index.html#__codelineno-0-493">493</a></span>
<span class="normal"><a href="index.html#__codelineno-0-494">494</a></span>
<span class="normal"><a href="index.html#__codelineno-0-495">495</a></span>
<span class="normal"><a href="index.html#__codelineno-0-496">496</a></span>
<span class="normal"><a href="index.html#__codelineno-0-497">497</a></span>
<span class="normal"><a href="index.html#__codelineno-0-498">498</a></span>
<span class="normal"><a href="index.html#__codelineno-0-499">499</a></span>
<span class="normal"><a href="index.html#__codelineno-0-500">500</a></span>
<span class="normal"><a href="index.html#__codelineno-0-501">501</a></span>
<span class="normal"><a href="index.html#__codelineno-0-502">502</a></span>
<span class="normal"><a href="index.html#__codelineno-0-503">503</a></span>
<span class="normal"><a href="index.html#__codelineno-0-504">504</a></span>
<span class="normal"><a href="index.html#__codelineno-0-505">505</a></span>
<span class="normal"><a href="index.html#__codelineno-0-506">506</a></span>
<span class="normal"><a href="index.html#__codelineno-0-507">507</a></span>
<span class="normal"><a href="index.html#__codelineno-0-508">508</a></span>
<span class="normal"><a href="index.html#__codelineno-0-509">509</a></span>
<span class="normal"><a href="index.html#__codelineno-0-510">510</a></span>
<span class="normal"><a href="index.html#__codelineno-0-511">511</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-461"><a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="k">def</span><span class="w"> </span><span class="nf">single_turn_score</span><span class="p">(</span>
</span><span id="__span-0-462"><a id="__codelineno-0-462" name="__codelineno-0-462"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-463"><a id="__codelineno-0-463" name="__codelineno-0-463"></a>    <span class="n">sample</span><span class="p">:</span> <span class="n">SingleTurnSample</span><span class="p">,</span>
</span><span id="__span-0-464"><a id="__codelineno-0-464" name="__codelineno-0-464"></a>    <span class="n">callbacks</span><span class="p">:</span> <span class="n">Callbacks</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-465"><a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-466"><a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-467"><a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">    Synchronously score a single-turn sample.</span>
</span><span id="__span-0-468"><a id="__codelineno-0-468" name="__codelineno-0-468"></a>
</span><span id="__span-0-469"><a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">    May raise ImportError if nest_asyncio is not installed in a Jupyter-like environment.</span>
</span><span id="__span-0-470"><a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-471"><a id="__codelineno-0-471" name="__codelineno-0-471"></a>    <span class="n">callbacks</span> <span class="o">=</span> <span class="n">callbacks</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="__span-0-472"><a id="__codelineno-0-472" name="__codelineno-0-472"></a>    <span class="c1"># only get the required columns</span>
</span><span id="__span-0-473"><a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="n">sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_only_required_columns_single_turn</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="__span-0-474"><a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="n">rm</span><span class="p">,</span> <span class="n">group_cm</span> <span class="o">=</span> <span class="n">new_group</span><span class="p">(</span>
</span><span id="__span-0-475"><a id="__codelineno-0-475" name="__codelineno-0-475"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-476"><a id="__codelineno-0-476" name="__codelineno-0-476"></a>        <span class="n">inputs</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span>
</span><span id="__span-0-477"><a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
</span><span id="__span-0-478"><a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ChainType</span><span class="o">.</span><span class="n">METRIC</span><span class="p">},</span>
</span><span id="__span-0-479"><a id="__codelineno-0-479" name="__codelineno-0-479"></a>    <span class="p">)</span>
</span><span id="__span-0-480"><a id="__codelineno-0-480" name="__codelineno-0-480"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-481"><a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="k">if</span> <span class="n">is_event_loop_running</span><span class="p">():</span>
</span><span id="__span-0-482"><a id="__codelineno-0-482" name="__codelineno-0-482"></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-483"><a id="__codelineno-0-483" name="__codelineno-0-483"></a>                <span class="kn">import</span><span class="w"> </span><span class="nn">nest_asyncio</span>
</span><span id="__span-0-484"><a id="__codelineno-0-484" name="__codelineno-0-484"></a>
</span><span id="__span-0-485"><a id="__codelineno-0-485" name="__codelineno-0-485"></a>                <span class="n">nest_asyncio</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
</span><span id="__span-0-486"><a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
</span><span id="__span-0-487"><a id="__codelineno-0-487" name="__codelineno-0-487"></a>                <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
</span><span id="__span-0-488"><a id="__codelineno-0-488" name="__codelineno-0-488"></a>                    <span class="s2">&quot;It seems like your running this in a jupyter-like environment. Please install nest_asyncio with `pip install nest_asyncio` to make it work.&quot;</span>
</span><span id="__span-0-489"><a id="__codelineno-0-489" name="__codelineno-0-489"></a>                <span class="p">)</span>
</span><span id="__span-0-490"><a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
</span><span id="__span-0-491"><a id="__codelineno-0-491" name="__codelineno-0-491"></a>        <span class="n">score</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span>
</span><span id="__span-0-492"><a id="__codelineno-0-492" name="__codelineno-0-492"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_single_turn_ascore</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">sample</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">group_cm</span><span class="p">)</span>
</span><span id="__span-0-493"><a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="p">)</span>
</span><span id="__span-0-494"><a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-495"><a id="__codelineno-0-495" name="__codelineno-0-495"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-496"><a id="__codelineno-0-496" name="__codelineno-0-496"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-497"><a id="__codelineno-0-497" name="__codelineno-0-497"></a>        <span class="k">raise</span> <span class="n">e</span>
</span><span id="__span-0-498"><a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-499"><a id="__codelineno-0-499" name="__codelineno-0-499"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-500"><a id="__codelineno-0-500" name="__codelineno-0-500"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_end</span><span class="p">({</span><span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">})</span>
</span><span id="__span-0-501"><a id="__codelineno-0-501" name="__codelineno-0-501"></a>
</span><span id="__span-0-502"><a id="__codelineno-0-502" name="__codelineno-0-502"></a>    <span class="c1"># track the evaluation event</span>
</span><span id="__span-0-503"><a id="__codelineno-0-503" name="__codelineno-0-503"></a>    <span class="n">_analytics_batcher</span><span class="o">.</span><span class="n">add_evaluation</span><span class="p">(</span>
</span><span id="__span-0-504"><a id="__codelineno-0-504" name="__codelineno-0-504"></a>        <span class="n">EvaluationEvent</span><span class="p">(</span>
</span><span id="__span-0-505"><a id="__codelineno-0-505" name="__codelineno-0-505"></a>            <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="__span-0-506"><a id="__codelineno-0-506" name="__codelineno-0-506"></a>            <span class="n">num_rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-507"><a id="__codelineno-0-507" name="__codelineno-0-507"></a>            <span class="n">evaluation_type</span><span class="o">=</span><span class="n">MetricType</span><span class="o">.</span><span class="n">SINGLE_TURN</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-508"><a id="__codelineno-0-508" name="__codelineno-0-508"></a>            <span class="n">language</span><span class="o">=</span><span class="n">get_metric_language</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
</span><span id="__span-0-509"><a id="__codelineno-0-509" name="__codelineno-0-509"></a>        <span class="p">)</span>
</span><span id="__span-0-510"><a id="__codelineno-0-510" name="__codelineno-0-510"></a>    <span class="p">)</span>
</span><span id="__span-0-511"><a id="__codelineno-0-511" name="__codelineno-0-511"></a>    <span class="k">return</span> <span class="n">score</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="zibly.metrics.SingleTurnMetric.single_turn_ascore" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">single_turn_ascore</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="index.html#__codelineno-0-1"></a><span class="nf">single_turn_ascore</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" href="../evaluation_schema/index.html#zibly.dataset_schema.SingleTurnSample">SingleTurnSample</a></span><span class="p">,</span> <span class="n">callbacks</span><span class="p">:</span> <span class="n"><span title="langchain_core.callbacks.Callbacks">Callbacks</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="n"><span title="typing.Optional">Optional</span></span><span class="p">[</span><span class="n"><span title="float">float</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="float">float</span></span>
</span></code></pre></div>

    <div class="doc doc-contents ">

        <p>Asynchronously score a single-turn sample with an optional timeout.</p>
<p>May raise asyncio.TimeoutError if the scoring process exceeds the specified timeout.</p>


            <details class="quote">
              <summary>Source code in <code>src/zibly/metrics/base.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="index.html#__codelineno-0-513">513</a></span>
<span class="normal"><a href="index.html#__codelineno-0-514">514</a></span>
<span class="normal"><a href="index.html#__codelineno-0-515">515</a></span>
<span class="normal"><a href="index.html#__codelineno-0-516">516</a></span>
<span class="normal"><a href="index.html#__codelineno-0-517">517</a></span>
<span class="normal"><a href="index.html#__codelineno-0-518">518</a></span>
<span class="normal"><a href="index.html#__codelineno-0-519">519</a></span>
<span class="normal"><a href="index.html#__codelineno-0-520">520</a></span>
<span class="normal"><a href="index.html#__codelineno-0-521">521</a></span>
<span class="normal"><a href="index.html#__codelineno-0-522">522</a></span>
<span class="normal"><a href="index.html#__codelineno-0-523">523</a></span>
<span class="normal"><a href="index.html#__codelineno-0-524">524</a></span>
<span class="normal"><a href="index.html#__codelineno-0-525">525</a></span>
<span class="normal"><a href="index.html#__codelineno-0-526">526</a></span>
<span class="normal"><a href="index.html#__codelineno-0-527">527</a></span>
<span class="normal"><a href="index.html#__codelineno-0-528">528</a></span>
<span class="normal"><a href="index.html#__codelineno-0-529">529</a></span>
<span class="normal"><a href="index.html#__codelineno-0-530">530</a></span>
<span class="normal"><a href="index.html#__codelineno-0-531">531</a></span>
<span class="normal"><a href="index.html#__codelineno-0-532">532</a></span>
<span class="normal"><a href="index.html#__codelineno-0-533">533</a></span>
<span class="normal"><a href="index.html#__codelineno-0-534">534</a></span>
<span class="normal"><a href="index.html#__codelineno-0-535">535</a></span>
<span class="normal"><a href="index.html#__codelineno-0-536">536</a></span>
<span class="normal"><a href="index.html#__codelineno-0-537">537</a></span>
<span class="normal"><a href="index.html#__codelineno-0-538">538</a></span>
<span class="normal"><a href="index.html#__codelineno-0-539">539</a></span>
<span class="normal"><a href="index.html#__codelineno-0-540">540</a></span>
<span class="normal"><a href="index.html#__codelineno-0-541">541</a></span>
<span class="normal"><a href="index.html#__codelineno-0-542">542</a></span>
<span class="normal"><a href="index.html#__codelineno-0-543">543</a></span>
<span class="normal"><a href="index.html#__codelineno-0-544">544</a></span>
<span class="normal"><a href="index.html#__codelineno-0-545">545</a></span>
<span class="normal"><a href="index.html#__codelineno-0-546">546</a></span>
<span class="normal"><a href="index.html#__codelineno-0-547">547</a></span>
<span class="normal"><a href="index.html#__codelineno-0-548">548</a></span>
<span class="normal"><a href="index.html#__codelineno-0-549">549</a></span>
<span class="normal"><a href="index.html#__codelineno-0-550">550</a></span>
<span class="normal"><a href="index.html#__codelineno-0-551">551</a></span>
<span class="normal"><a href="index.html#__codelineno-0-552">552</a></span>
<span class="normal"><a href="index.html#__codelineno-0-553">553</a></span>
<span class="normal"><a href="index.html#__codelineno-0-554">554</a></span>
<span class="normal"><a href="index.html#__codelineno-0-555">555</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-513"><a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">single_turn_ascore</span><span class="p">(</span>
</span><span id="__span-0-514"><a id="__codelineno-0-514" name="__codelineno-0-514"></a>    <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-0-515"><a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="n">sample</span><span class="p">:</span> <span class="n">SingleTurnSample</span><span class="p">,</span>
</span><span id="__span-0-516"><a id="__codelineno-0-516" name="__codelineno-0-516"></a>    <span class="n">callbacks</span><span class="p">:</span> <span class="n">Callbacks</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-517"><a id="__codelineno-0-517" name="__codelineno-0-517"></a>    <span class="n">timeout</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-0-518"><a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-0-519"><a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-520"><a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">    Asynchronously score a single-turn sample with an optional timeout.</span>
</span><span id="__span-0-521"><a id="__codelineno-0-521" name="__codelineno-0-521"></a>
</span><span id="__span-0-522"><a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">    May raise asyncio.TimeoutError if the scoring process exceeds the specified timeout.</span>
</span><span id="__span-0-523"><a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-524"><a id="__codelineno-0-524" name="__codelineno-0-524"></a>    <span class="n">callbacks</span> <span class="o">=</span> <span class="n">callbacks</span> <span class="ow">or</span> <span class="p">[]</span>
</span><span id="__span-0-525"><a id="__codelineno-0-525" name="__codelineno-0-525"></a>    <span class="c1"># only get the required columns</span>
</span><span id="__span-0-526"><a id="__codelineno-0-526" name="__codelineno-0-526"></a>    <span class="n">sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_only_required_columns_single_turn</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</span><span id="__span-0-527"><a id="__codelineno-0-527" name="__codelineno-0-527"></a>    <span class="n">rm</span><span class="p">,</span> <span class="n">group_cm</span> <span class="o">=</span> <span class="n">new_group</span><span class="p">(</span>
</span><span id="__span-0-528"><a id="__codelineno-0-528" name="__codelineno-0-528"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-529"><a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="n">inputs</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span>
</span><span id="__span-0-530"><a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks</span><span class="p">,</span>
</span><span id="__span-0-531"><a id="__codelineno-0-531" name="__codelineno-0-531"></a>        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">ChainType</span><span class="o">.</span><span class="n">METRIC</span><span class="p">},</span>
</span><span id="__span-0-532"><a id="__codelineno-0-532" name="__codelineno-0-532"></a>    <span class="p">)</span>
</span><span id="__span-0-533"><a id="__codelineno-0-533" name="__codelineno-0-533"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-0-534"><a id="__codelineno-0-534" name="__codelineno-0-534"></a>        <span class="n">score</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span>
</span><span id="__span-0-535"><a id="__codelineno-0-535" name="__codelineno-0-535"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_single_turn_ascore</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">sample</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">group_cm</span><span class="p">),</span>
</span><span id="__span-0-536"><a id="__codelineno-0-536" name="__codelineno-0-536"></a>            <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
</span><span id="__span-0-537"><a id="__codelineno-0-537" name="__codelineno-0-537"></a>        <span class="p">)</span>
</span><span id="__span-0-538"><a id="__codelineno-0-538" name="__codelineno-0-538"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-0-539"><a id="__codelineno-0-539" name="__codelineno-0-539"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-540"><a id="__codelineno-0-540" name="__codelineno-0-540"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-0-541"><a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="k">raise</span> <span class="n">e</span>
</span><span id="__span-0-542"><a id="__codelineno-0-542" name="__codelineno-0-542"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-543"><a id="__codelineno-0-543" name="__codelineno-0-543"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">group_cm</span><span class="o">.</span><span class="n">ended</span><span class="p">:</span>
</span><span id="__span-0-544"><a id="__codelineno-0-544" name="__codelineno-0-544"></a>            <span class="n">rm</span><span class="o">.</span><span class="n">on_chain_end</span><span class="p">({</span><span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">})</span>
</span><span id="__span-0-545"><a id="__codelineno-0-545" name="__codelineno-0-545"></a>
</span><span id="__span-0-546"><a id="__codelineno-0-546" name="__codelineno-0-546"></a>    <span class="c1"># track the evaluation event</span>
</span><span id="__span-0-547"><a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="n">_analytics_batcher</span><span class="o">.</span><span class="n">add_evaluation</span><span class="p">(</span>
</span><span id="__span-0-548"><a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="n">EvaluationEvent</span><span class="p">(</span>
</span><span id="__span-0-549"><a id="__codelineno-0-549" name="__codelineno-0-549"></a>            <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">],</span>
</span><span id="__span-0-550"><a id="__codelineno-0-550" name="__codelineno-0-550"></a>            <span class="n">num_rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-0-551"><a id="__codelineno-0-551" name="__codelineno-0-551"></a>            <span class="n">evaluation_type</span><span class="o">=</span><span class="n">MetricType</span><span class="o">.</span><span class="n">SINGLE_TURN</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span id="__span-0-552"><a id="__codelineno-0-552" name="__codelineno-0-552"></a>            <span class="n">language</span><span class="o">=</span><span class="n">get_metric_language</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
</span><span id="__span-0-553"><a id="__codelineno-0-553" name="__codelineno-0-553"></a>        <span class="p">)</span>
</span><span id="__span-0-554"><a id="__codelineno-0-554" name="__codelineno-0-554"></a>    <span class="p">)</span>
</span><span id="__span-0-555"><a id="__codelineno-0-555" name="__codelineno-0-555"></a>    <span class="k">return</span> <span class="n">score</span>
</span></code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="January 23, 2025 20:06:24">January 23, 2025</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="January 23, 2025 20:06:24">January 23, 2025</span>
  </span>

    
    
    
  </aside>


  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../evaluation_schema/index.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Schemas">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Schemas
              </div>
            </div>
          </a>
        
        
          
          <a href="../evaluate/index.html" class="md-footer__link md-footer__link--next" aria-label="Next: evaluate()">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                evaluate()
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["announce.dismiss", "content.tabs.link", "content.code.annotate", "content.code.copy", "announce.dismiss", "navigation.tabs", "navigation.path", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.preview", "navigation.sections", "navigation.top", "navigation.tracking", "navigation.indexes", "navigation.footer", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.c7c1ca2c.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f807c082.min.js"></script>
      
        <script src="../../static/js/mathjax.js"></script>
      
        <script src="../../static/js/header_border.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../static/js/toggle.js"></script>
      
        <script src="https://cdn.octolane.com/tag.js?pk=c7c9b2b863bf7eaf4e2a"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>